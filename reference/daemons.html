<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Set &amp;#8216;daemons&amp;#8217; or persistent background processes to receive
    mirai requests. Specify &amp;#8216;n&amp;#8217; to create daemons on the
    local machine. Specify &amp;#8216;url&amp;#8217; for receiving connections from remote
    daemons (for distributed computing across the network). Specify
    &amp;#8216;remote&amp;#8217; to optionally launch remote daemons via a remote
    configuration. By default, dispatcher ensures optimal scheduling."><title>Daemons (Set Persistent Processes) — daemons • mirai</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Daemons (Set Persistent Processes) — daemons"><meta property="og:description" content="Set &amp;#8216;daemons&amp;#8217; or persistent background processes to receive
    mirai requests. Specify &amp;#8216;n&amp;#8217; to create daemons on the
    local machine. Specify &amp;#8216;url&amp;#8217; for receiving connections from remote
    daemons (for distributed computing across the network). Specify
    &amp;#8216;remote&amp;#8217; to optionally launch remote daemons via a remote
    configuration. By default, dispatcher ensures optimal scheduling."><meta property="og:image" content="https://shikokuchuo.net/mirai/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mirai</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mirai.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/databases.html">mirai - Databases and Arrow</a>
    <a class="dropdown-item" href="../articles/parallel.html">mirai - Parallel Integration</a>
    <a class="dropdown-item" href="../articles/plumber.html">mirai - Plumber Integration</a>
    <a class="dropdown-item" href="../articles/promises.html">mirai - Promises Integration</a>
    <a class="dropdown-item" href="../articles/shiny.html">mirai - Shiny Integration</a>
    <a class="dropdown-item" href="../articles/torch.html">mirai - Torch Integration</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/shikokuchuo/mirai/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://shikokuchuo.net/">
    <span class="fa fa-cube"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Daemons (Set Persistent Processes)</h1>
      <small class="dont-index">Source: <a href="https://github.com/shikokuchuo/mirai/blob/HEAD/R/daemons.R" class="external-link"><code>R/daemons.R</code></a></small>
      <div class="d-none name"><code>daemons.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Set ‘daemons’ or persistent background processes to receive
    <code><a href="mirai.html">mirai</a></code> requests. Specify ‘n’ to create daemons on the
    local machine. Specify ‘url’ for receiving connections from remote
    daemons (for distributed computing across the network). Specify
    ‘remote’ to optionally launch remote daemons via a remote
    configuration. By default, dispatcher ensures optimal scheduling.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">daemons</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  url <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  remote <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dispatcher <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tls <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pass <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .compute <span class="op">=</span> <span class="st">"default"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>n</dt>
<dd><p>integer number of daemons to set.</p></dd>


<dt>url</dt>
<dd><p>[default NULL] if specified, the character URL or vector of URLs
on the host for remote daemons to dial into, including a port accepting
incoming connections (and optionally for websockets, a path), e.g.
'tcp://hostname:5555' or 'ws://10.75.32.70:5555/path'. Specify a URL
starting 'tls+tcp://' or 'wss://' to use secure TLS connections.
Auxiliary function <code><a href="host_url.html">host_url</a></code> may be used to construct a
valid host URL.</p></dd>


<dt>remote</dt>
<dd><p>[default NULL] required only for launching remote daemons, a
configuration generated by <code><a href="remote_config.html">remote_config</a></code> or
<code><a href="remote_config.html">ssh_config</a></code>.</p></dd>


<dt>dispatcher</dt>
<dd><p>[default TRUE] logical value whether to use dispatcher.
Dispatcher is a local background process that connects to daemons on
behalf of the host and ensures FIFO scheduling (see Dispatcher section
below).</p></dd>


<dt>...</dt>
<dd><p>(optional) additional arguments passed through to
<code><a href="dispatcher.html">dispatcher</a></code> if using dispatcher and/or <code><a href="daemon.html">daemon</a></code>
if launching daemons. These include ‘retry’ and ‘token’ at
dispatcher and ‘autoexit’, ‘cleanup’, ‘output’,
‘maxtasks’, ‘idletime’, ‘walltime’ and
‘timerstart’ at daemon.</p></dd>


<dt>seed</dt>
<dd><p>[default NULL] (optional) supply a random seed (single value,
interpreted as an integer). This is used to inititalise the L'Ecuyer-CMRG
RNG streams sent to each daemon. Note that reproducible results can be
expected only for <code>dispatcher = FALSE</code>, as the unpredictable timing
of task completions would otherwise influence the tasks sent to each
daemon. Even for <code>dispatcher = FALSE</code>, reproducibility is not
guaranteed if the order in which tasks are sent is not deterministic.</p></dd>


<dt>tls</dt>
<dd><p>[default NULL] (optional for secure TLS connections) if not
supplied, zero-configuration single-use keys and certificates are
automatically generated. If supplied, <strong>either</strong> the character path
to a file containing the PEM-encoded TLS certificate and associated
private key (may contain additional certificates leading to a validation
chain, with the TLS certificate first), <strong>or</strong> a length 2 character
vector comprising [i] the TLS certificate (optionally certificate chain)
and [ii] the associated private key.</p></dd>


<dt>pass</dt>
<dd><p>[default NULL] (required only if the private key supplied to
‘tls’ is encrypted with a password) For security, should be
provided through a function that returns this value, rather than directly.</p></dd>


<dt>.compute</dt>
<dd><p>[default 'default'] character value for the compute profile
to use (each compute profile has its own independent set of daemons).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Depending on the arguments supplied:</p>
<p></p>
<ul><li><p>using dispatcher: integer number of daemons set.</p></li>
<li><p>or else launching local daemons: integer number of daemons launched.</p></li>
<li><p>otherwise: the character host URL.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Use <code>daemons(0)</code> to reset daemon connections:</p><ul><li><p>All connected daemons and/or dispatchers exit automatically.</p></li>
<li><p><span class="pkg">mirai</span> reverts to the default behaviour of creating a new
    background process for each request.</p></li>
<li><p>Any unresolved ‘mirai’ will return an ‘errorValue’ 19
    (Connection reset) after a reset.</p></li>
<li><p>Calling <code>daemons</code> with revised (or even the same) settings for
    the same compute profile implicitly resets daemons before applying the
    new settings.</p></li>
</ul><p>If the host session ends, all connected dispatcher and daemon processes
    automatically exit as soon as their connections are dropped (unless
    the daemons were started with <code>autoexit = FALSE</code>). If a daemon is
    processing a task, it will exit as soon as the task is complete.</p>
<p>To reset persistent daemons started with <code>autoexit = FALSE</code>, use
    <code>daemons(NULL)</code> instead, which also sends exit instructions to all
    connected daemons prior to resetting.</p>
<p>For historical reasons, <code>daemons()</code> with no arguments returns the
    value of <code><a href="status.html">status</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="local-daemons">Local Daemons<a class="anchor" aria-label="anchor" href="#local-daemons"></a></h2>
    


<p>Daemons provide a potentially more efficient solution for asynchronous
    operations as new processes no longer need to be created on an <em>ad
    hoc</em> basis.</p>
<p>Supply the argument ‘n’ to set the number of daemons. New
    background <code><a href="daemon.html">daemon</a></code> processes are automatically created on
    the local machine connecting back to the host process, either directly or
    via dispatcher.</p>
    </div>
    <div class="section level2">
    <h2 id="dispatcher">Dispatcher<a class="anchor" aria-label="anchor" href="#dispatcher"></a></h2>
    


<p>By default <code>dispatcher = TRUE</code>. This launches a background process
    running <code><a href="dispatcher.html">dispatcher</a></code>. Dispatcher connects to daemons on
    behalf of the host and ensures FIFO scheduling of tasks. Dispatcher uses
    synchronisation primitives from <span class="pkg">nanonext</span>, waiting rather than
    polling for tasks, which is both efficient (no resource usage) and fully
    event-driven (having no latency).</p>
<p>By specifying <code>dispatcher = FALSE</code>, daemons connect to the host
    directly rather than through dispatcher. The host sends tasks to
    connected daemons immediately in a round-robin fashion. Optimal
    scheduling is not guaranteed as the duration of tasks cannot be known
    <em>a priori</em>, hence tasks can be queued at one daemon while other
    daemons remain idle. However, this provides a resource-light approach
    suited to working with similar-length tasks, or where concurrent tasks
    typically do not exceed available daemons.</p>
    </div>
    <div class="section level2">
    <h2 id="distributed-computing">Distributed Computing<a class="anchor" aria-label="anchor" href="#distributed-computing"></a></h2>
    


<p>Specifying ‘url’ allows tasks to be distributed across the network.
    This should be a character string such as ‘tcp://10.75.32.70:5555’
    at which daemon processes should connect to. Switching the URL scheme to
    ‘tls+tcp://’ or ‘wss://’ automatically upgrades the
    connection to use TLS. The auxiliary function <code><a href="host_url.html">host_url</a></code> may
    be used to automatically construct a valid host URL based on the
    computer's hostname.</p>
<p>Specify ‘remote’ with a call to <code><a href="remote_config.html">remote_config</a></code> or
    <code><a href="remote_config.html">ssh_config</a></code> to launch daemons on remote machines. Otherwise,
    <code><a href="launch_local.html">launch_remote</a></code> may be used to generate the shell commands to
    deploy daemons manually on remote resources.</p>
<p>IPv6 addresses are also supported and must be enclosed in square brackets
    [ ] to avoid confusion with the final colon separating the port. For
    example, port 5555 on the IPv6 loopback address ::1 would be specified
    as ‘tcp://[::1]:5555’.</p>
<p>Specifying the wildcard value zero for the port number e.g.
    ‘tcp://[::1]:0’ or ‘ws://[::1]:0’ will automatically assign
    a free ephemeral port. Use <code><a href="status.html">status</a></code> to inspect the actual
    assigned port at any time.</p>
<p><strong>With Dispatcher</strong></p>
<p>When using dispatcher, it is recommended to use a websocket URL rather
    than TCP, as this requires only one port to connect to all daemons: a
    websocket URL supports a path after the port number, which can be made
    unique for each daemon.</p>
<p>Specifying a single host URL such as ‘ws://10.75.32.70:5555’ with
    <code>n = 6</code> will automatically append a sequence to the path, listening
    to the URLs ‘ws://10.75.32.70:5555/1’ through
    ‘ws://110.75.32.70:5555/6’.</p>
<p>Alternatively, specify a vector of URLs to listen to arbitrary port
    numbers / paths. In this case it is optional to supply ‘n’ as this
    can be inferred by the length of vector supplied.</p>
<p>Individual daemons then dial in to each of these host URLs. At most one
    daemon can be dialled into each URL at any given time.</p>
<p>Dispatcher automatically adjusts to the number of daemons actually
    connected. Hence it is possible to dynamically scale up or down the
    number of daemons as required, subject to the maximum number initially
    specified.</p>
<p>Alternatively, supplying a single TCP URL will listen at a block of URLs
    with ports starting from the supplied port number and incrementing by one
    for ‘n’ specified e.g. the host URL
    ‘tcp://10.75.32.70:5555’ with <code>n = 6</code> listens to the
    contiguous block of ports 5555 through 5560.</p>
<p><strong>Without Dispatcher</strong></p>
<p>A TCP URL may be used in this case as the host listens at only one
    address, utilising a single port.</p>
<p>The network topology is such that daemons (started with
    <code><a href="daemon.html">daemon</a></code>) or indeed dispatchers (started with
    <code><a href="dispatcher.html">dispatcher</a></code>) dial into the same host URL.</p>
<p>‘n’ is not required in this case, and disregarded if supplied, as
    network resources may be added or removed at any time. The host
    automatically distributes tasks to all connected daemons and dispatchers
    in a round-robin fashion.</p>
    </div>
    <div class="section level2">
    <h2 id="compute-profiles">Compute Profiles<a class="anchor" aria-label="anchor" href="#compute-profiles"></a></h2>
    


<p>By default, the ‘default’ compute profile is used. Providing a
    character value for ‘.compute’ creates a new compute profile with
    the name specified. Each compute profile retains its own daemons
    settings, and may be operated independently of each other. Some usage
    examples follow:</p>
<p><strong>local / remote</strong> daemons may be set with a host URL and specifying
    ‘.compute’ as ‘remote’, which creates a new compute
    profile. Subsequent <code><a href="mirai.html">mirai</a></code> calls may then be sent for local
    computation by not specifying the ‘.compute’ argument, or for
    remote computation to connected daemons by specifying the
    ‘.compute’ argument as ‘remote’.</p>
<p><strong>cpu / gpu</strong> some tasks may require access to different types of
    daemon, such as those with GPUs. In this case, <code>daemons()</code> may be
    called twice to set up host URLs for CPU-only daemons and for those
    with GPUs, specifying the ‘.compute’ argument as ‘cpu’ and
    ‘gpu’ respectively. By supplying the ‘.compute’ argument to
    subsequent <code><a href="mirai.html">mirai</a></code> calls, tasks may be sent to either
    ‘cpu’ or ‘gpu’ daemons as appropriate.</p>
<p>Note: further actions such as resetting daemons via <code>daemons(0)</code>
    should be carried out with the desired ‘.compute’ argument
    specified.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Only run examples in interactive R sessions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create 2 local daemons (using dispatcher)</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="status.html">status</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Reset to zero</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create 2 local daemons (not using dispatcher)</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span><span class="fl">2</span>, dispatcher <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="status.html">status</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Reset to zero</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2 remote daemons via dispatcher using WebSockets</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span><span class="fl">2</span>, url <span class="op">=</span> <span class="fu"><a href="host_url.html">host_url</a></span><span class="op">(</span>ws <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="status.html">status</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Reset to zero</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set host URL for remote daemons to dial into</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span>url <span class="op">=</span> <span class="fu"><a href="host_url.html">host_url</a></span><span class="op">(</span><span class="op">)</span>, dispatcher <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="status.html">status</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Reset to zero</span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use with() to evaluate with daemons for the duration of the expression</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">daemons</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirai.html">mirai</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html" class="external-link">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirai.html">mirai</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html" class="external-link">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="call_mirai.html">call_mirai</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">$</span><span class="va">data</span>, <span class="fu"><a href="call_mirai.html">call_mirai</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">$</span><span class="va">data</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Launch 2 daemons on remotes 'nodeone' and 'nodetwo' using SSH</span></span></span>
<span class="r-in"><span><span class="co"># connecting back directly to the host URL over a TLS connection:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span>url <span class="op">=</span> <span class="fu"><a href="host_url.html">host_url</a></span><span class="op">(</span>tls <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        remote <span class="op">=</span> <span class="fu"><a href="remote_config.html">ssh_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ssh://nodeone'</span>, <span class="st">'ssh://nodetwo'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        dispatcher <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Launch 4 daemons on the remote machine 10.75.32.90 using SSH tunnelling</span></span></span>
<span class="r-in"><span><span class="co"># over port 5555 ('url' hostname must be 'localhost' or '127.0.0.1'):</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">daemons</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>        url <span class="op">=</span> <span class="st">'ws://localhost:5555'</span>,</span></span>
<span class="r-in"><span>        remote <span class="op">=</span> <span class="fu"><a href="remote_config.html">ssh_config</a></span><span class="op">(</span><span class="st">'ssh://10.75.32.90'</span>, tunnel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlie Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

