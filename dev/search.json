[{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"CLAUDE.md","text":"mirai minimalist async evaluation framework R provides asynchronous, parallel distributed computing. ’s built nanonext NNG (Nanomsg-Next-Generation), implementing message-passing paradigm daemons (persistent background processes) execute tasks sent host process.","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"core-components","dir":"","previous_headings":"Key Architecture","what":"Core Components","title":"CLAUDE.md","text":"mirai(): Creates asynchronous evaluation returns immediately ‘mirai’ object daemons(): Sets persistent background daemon processes receive mirai requests daemon(): daemon instance runs background processes execute tasks dispatcher(): Optional scheduler process ensures optimal FIFO scheduling enables features like cancellation custom serialization mirai_map(): Asynchronous parallel map lists/vectors progress bars early stopping everywhere(): Evaluates expressions connected daemons (loading packages/exporting data)","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"message-passing-topology","dir":"","previous_headings":"Key Architecture","what":"Message-Passing Topology","title":"CLAUDE.md","text":"network topology daemons dial host/dispatcher (vice versa). host/dispatcher listens URL, allowing dynamic addition/removal compute resources. inverted topology design enables: - Local daemons via IPC (Unix sockets Linux/macOS, named pipes Windows) - Remote daemons via TCP/TLS (including automatic zero-config TLS certificate generation) - Distributed computing across networks - True dynamic scaling","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"dispatcher-vs-direct-connection","dir":"","previous_headings":"Key Architecture","what":"Dispatcher vs. Direct Connection","title":"CLAUDE.md","text":"Dispatcher (default): dispatcher = TRUE - Optimal FIFO scheduling - tasks queued sent next available daemon - Enables mirai cancellation via stop_mirai() - Enables timeout cancellation (just timeout detection) - Required custom serialization configurations - Slight additional overhead Direct Connection: dispatcher = FALSE - Round-robin distribution - tasks sent directly daemons - Lower overhead, resource-efficient - Best similar-length tasks concurrent tasks < available daemons - cancellation custom serialization support","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"evaluation-model","dir":"","previous_headings":"Key Architecture","what":"Evaluation Model","title":"CLAUDE.md","text":"Expressions evaluate clean environment (global), containing objects supplied via .args. Objects passed ... assigned global environment daemon process. clean-room approach requires explicit passing dependencies prevent surprises hidden state.","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"compute-profiles","dir":"","previous_headings":"Key Architecture","what":"Compute Profiles","title":"CLAUDE.md","text":"Multiple named compute profiles can coexist, daemons configuration. Use .compute parameter functions like mirai(), daemons(), launch_local(), etc. specify profile use. Default profile “default”.","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"random-number-generation","dir":"","previous_headings":"Key Architecture","what":"Random Number Generation","title":"CLAUDE.md","text":"Uses L’Ecuyer-CMRG RNG streams statistical independence across parallel processes, following base R’s parallel package conventions. Default (seed = NULL): New stream per daemon (statistically sound, non-reproducible across runs) Reproducible (seed = integer): New stream per mirai call (deterministic, reproducible results)","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"testing","dir":"","previous_headings":"Development Commands","what":"Testing","title":"CLAUDE.md","text":"","code":"# Run all tests (uses custom minitest framework) source(\"tests/tests.R\")  # Tests are in tests/tests.R - a single file using minitest, not testthat"},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"building-and-checking","dir":"","previous_headings":"Development Commands","what":"Building and Checking","title":"CLAUDE.md","text":"","code":"# Build package R CMD build .  # Check package (as done in CI) R CMD check --no-manual --compact-vignettes=gs+qpdf mirai_*.tar.gz # Generate documentation (from R) devtools::document()"},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"code-formatting","dir":"","previous_headings":"Development Commands","what":"Code Formatting","title":"CLAUDE.md","text":"","code":"# Format R code using Air (defined in air.toml) # Line width: 100, indent: 2 spaces"},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"documentation","dir":"","previous_headings":"Development Commands","what":"Documentation","title":"CLAUDE.md","text":"","code":"# Build README from README.Rmd rmarkdown::render(\"README.Rmd\")  # Build vignettes (uses litedown, not knitr) # Vignettes are in dev/vignettes/*.Rmd and pre-compiled to vignettes/*.Rmd"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"r-directory-structure","dir":"","previous_headings":"Code Organization","what":"R/ Directory Structure","title":"CLAUDE.md","text":"mirai.R: Core mirai() function, unresolved(), call_mirai(), stop_mirai(), everywhere(), race_mirai() daemons.R: Setup functions daemon infrastructure including daemons(), remote configurations, compute profiles, with_daemons(), local_daemons() daemon.R: daemon instance implementation runs background processes dispatcher.R: Dispatcher process optimal FIFO scheduling map.R: mirai_map() parallel map operations collection options (.flat, .progress, .stop) launchers.R: launch_local() launch_remote() deploying daemons; remote_config(), ssh_config(), cluster_config() parallel.R: Integration R’s parallel package via make_cluster() - first official alternative communications backend R promises.R: Integration promises package async workflows Shiny ExtendedTask support next.R: Developer interface utilities (nextstream(), nextget()) packages extending mirai otel.R: OpenTelemetry integration distributed tracing","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"dependencies","dir":"","previous_headings":"Code Organization","what":"Dependencies","title":"CLAUDE.md","text":"nanonext: Core dependency providing NNG bindings IPC/TCP/TLS communication cli (suggested): progress bars mirai_map promises (enhanced): async promise integration parallel (enhanced): MIRAI cluster type otel, otelsdk (suggested): OpenTelemetry integration","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"testing-framework","dir":"","previous_headings":"","what":"Testing Framework","title":"CLAUDE.md","text":"package uses minitest, minimal custom testing framework defined top tests/tests.R. provides: - test_true(), test_false(), test_null(), test_notnull(), test_zero() - test_type(), test_class(), test_equal(), test_identical() - test_error() expecting errors optional message matching - test_print() verifying printability Tests run sequentially single file rather using testthat’s directory structure.","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"serialization-system","dir":"","previous_headings":"","what":"Serialization System","title":"CLAUDE.md","text":"mirai supports custom serialization non-exportable reference objects (torch tensors, Arrow tables, Polars objects). configured via: - serial_config() per-daemon configuration (requires dispatcher) - register_serial() global registration - Serialization functions applied message passing host daemons - Enables cross-language data formats zero-copy transfers","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"opentelemetry-integration","dir":"","previous_headings":"","what":"OpenTelemetry Integration","title":"CLAUDE.md","text":"Optional distributed tracing support via otel package. enabled, mirai creates spans : - “mirai” spans (client-side) - “daemon eval” spans (server-side) - “mirai_map” spans - Links spans preserve distributed context across processes","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"cicd","dir":"","previous_headings":"","what":"CI/CD","title":"CLAUDE.md","text":"GitHub Actions workflows .github/workflows/: - R-CMD-check.yaml: Comprehensive checks across multiple R versions (oldrel-1, release, devel) platforms (Ubuntu, macOS, Windows) - test-coverage.yaml: Code coverage via codecov - pkgdown.yaml: Documentation site generation - shiny-coreci.yaml: Shiny core CI integration - rhub.yaml: Additional platform testing","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"ssh-direct-connection","dir":"","previous_headings":"Remote Daemon Deployment","what":"SSH Direct Connection","title":"CLAUDE.md","text":"Requires SSH key-based authentication Host port must open inbound connections remotes Daemons dial back host URL directly Use ssh_config(remotes, tunnel = FALSE)","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"ssh-tunnelling","dir":"","previous_headings":"Remote Daemon Deployment","what":"SSH Tunnelling","title":"CLAUDE.md","text":"Use firewall blocks inbound connections host Creates reverse SSH tunnel: remote port -> host port Host URL must tcp://127.0.0.1:port (use local_url(tcp = TRUE)) Daemons dial localhost, traffic tunnels SSH Use ssh_config(remotes, tunnel = TRUE)","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"hpc-cluster-managers","dir":"","previous_headings":"Remote Daemon Deployment","what":"HPC Cluster Managers","title":"CLAUDE.md","text":"Supported via cluster_config(): - Slurm: sbatch (batch), srun (interactive) - SGE: qsub - Torque/PBS: qsub - LSF: bsub Configuration includes job options (memory, output files, etc.) optional module loading commands.","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"manual-deployment","dir":"","previous_headings":"Remote Daemon Deployment","what":"Manual Deployment","title":"CLAUDE.md","text":"Use remote_config() empty arguments generate shell commands manual copy/paste remote machines.","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"url-constructors","dir":"","previous_headings":"Helper Functions","what":"URL Constructors","title":"CLAUDE.md","text":"host_url(tls, port): Constructs host URL based detected IP address local_url(tcp, port): Generates IPC URL localhost TCP URL","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"scope-management","dir":"","previous_headings":"Helper Functions","what":"Scope Management","title":"CLAUDE.md","text":"with_daemons(.compute, expr): Temporarily use specific compute profile local_daemons(.compute, frame): Set profile current scope","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"status-and-monitoring","dir":"","previous_headings":"Helper Functions","what":"Status and Monitoring","title":"CLAUDE.md","text":"status(.compute): Detailed status (connections, URL, mirai counts) info(.compute): Concise statistics vector daemons_set(.compute): Check daemons exist require_daemons(.compute): Error daemons set","code":""},{"path":"https://mirai.r-lib.org/dev/CLAUDE.html","id":"package-conventions","dir":"","previous_headings":"","what":"Package Conventions","title":"CLAUDE.md","text":"Uses roxygen2 documentation markdown support NAMESPACE auto-generated via roxygen2 Version follows R package conventions: major.minor.patch.dev (e.g., 2.5.2.9000 development) MIT license Part r-lib GitHub organization Maintained Posit Software, PBC","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement codeofconduct@posit.co. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://mirai.r-lib.org/dev/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.0, available https://www.contributor-covenant.org/version/2/0/code_of_conduct.html. Community Impact Guidelines inspired Mozilla’s code conduct enforcement ladder. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://mirai.r-lib.org/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 mirai authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"core-concepts","dir":"Articles","previous_headings":"","what":"Core Concepts","title":"mirai - Quick Reference","text":"mirai = future Japanese. Async evaluation framework R built NNG/nanonext. Architecture: daemons dial host, topology facilitates dynamic scaling. cheatsheet. Refer mirai reference manual detailed introduction.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"key-takeaways","dir":"Articles","previous_headings":"","what":"Key Takeaways","title":"mirai - Quick Reference","text":"mirai() returns immediately, access result via m[] m$data daemons() sets persistent background processes Dispatcher enabled default optimal scheduling SSH tunnelling: Use local_url(tcp=TRUE) + tunnel=TRUE ports blocked HPC clusters: Use cluster_config() appropriate scheduler Compute profiles: Multiple independent daemon sets .compute parameter mirai_map(): Parallel map progress bars, early stopping, flatmap","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"create-and-access-results","dir":"Articles","previous_headings":"1. Basic mirai Usage","what":"Create and Access Results","title":"mirai - Quick Reference","text":"","code":"library(mirai)  # Create a mirai (returns immediately) m <- mirai(   {     Sys.sleep(1)     rnorm(5, mean)   },   mean = 10 )  # Direct access (non-blocking) unresolved(m)              # Check if resolved (TRUE if still running) m$data                     # Returns value (NA if unresolved)  # Access result (blocks until ready) m[]                        # Wait and return value collect_mirai(m)           # Wait and return value call_mirai(m)              # Wait and return mirai object"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"passing-data","dir":"Articles","previous_headings":"1. Basic mirai Usage","what":"Passing Data","title":"mirai - Quick Reference","text":"","code":"# Via ... (assigned to daemon global env) m <- mirai(func(x), func = my_func, x = data)  # Via .args (local to evaluation env) m <- mirai(func(x), .args = list(func = my_func, x = data))  # Pass entire environment write_async <- function(x, file) {   mirai(write.csv(x, file), .args = environment()) }"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"basic-setup","dir":"Articles","previous_headings":"2. Local Daemons","what":"Basic Setup","title":"mirai - Quick Reference","text":"","code":"# Set 4 local daemons (with dispatcher - default) daemons(4)  # Without dispatcher (round-robin distribution) daemons(4, dispatcher = FALSE)  # Reset daemons daemons(0)  # Check connection / statistics info()"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"daemon-configuration","dir":"Articles","previous_headings":"2. Local Daemons","what":"Daemon Configuration","title":"mirai - Quick Reference","text":"","code":"daemons(   n = 4,   dispatcher = TRUE,          # Use dispatcher for optimal FIFO scheduling   cleanup = TRUE,             # Clean env between tasks   output = FALSE,             # Capture stdout/stderr   maxtasks = Inf,             # Task limit per daemon   idletime = Inf,             # Max idle time (ms) before exit   walltime = Inf              # Time limit (ms) before exit )"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"synchronous-mode-testingdebugging","dir":"Articles","previous_headings":"2. Local Daemons","what":"Synchronous Mode (Testing/Debugging)","title":"mirai - Quick Reference","text":"","code":"daemons(sync = TRUE)          # Run in current process m <- mirai(Sys.getpid()) daemons(0)"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"setup-host-to-accept-remote-connections","dir":"Articles","previous_headings":"3. Remote Daemons - SSH Direct","what":"Setup Host to Accept Remote Connections","title":"mirai - Quick Reference","text":"","code":"# Listen at host URL with TLS daemons(   url = host_url(tls = TRUE),   remote = ssh_config(c(\"ssh://10.75.32.90\", \"ssh://node2:22\")) )  # Or without automatic launching daemons(url = host_url(tls = TRUE)) launch_remote(2, remote = ssh_config(\"ssh://10.75.32.90\"))"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"url-constructors","dir":"Articles","previous_headings":"3. Remote Daemons - SSH Direct","what":"URL Constructors","title":"mirai - Quick Reference","text":"","code":"host_url()                    # Auto-detect IP, tcp://x.x.x.x:0 host_url(tls = TRUE)          # TLS connection host_url(tls = TRUE, port = 5555)  # Specific port  local_url()                   # IPC (Unix sockets/named pipes) local_url(tcp = TRUE)         # tcp://127.0.0.1:0 local_url(tcp = TRUE, port = 5555) # tcp://127.0.0.1:5555"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"ssh-configuration","dir":"Articles","previous_headings":"3. Remote Daemons - SSH Direct","what":"SSH Configuration","title":"mirai - Quick Reference","text":"Requirements SSH Direct: SSH key-based authentication place Host port open inbound connections remote Remotes dial back host URL directly","code":"ssh_config(   remotes = c(\"ssh://node1:22\", \"ssh://node2:22\"),   tunnel = FALSE,             # Direct connection   timeout = 10,               # Connection timeout (seconds)   command = \"ssh\",            # SSH executable   rscript = \"Rscript\"         # R executable on remote )"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"when-to-use-tunnelling","dir":"Articles","previous_headings":"4. Remote Daemons - SSH Tunnelling","what":"When to Use Tunnelling","title":"mirai - Quick Reference","text":"Firewall blocks inbound connections host Security policies prevent opening ports Connecting cloud/external machines","code":""},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"setup","dir":"Articles","previous_headings":"4. Remote Daemons - SSH Tunnelling","what":"Setup","title":"mirai - Quick Reference","text":"Tunnelling Works: Host listens 127.0.0.1:port SSH creates reverse tunnel: remote port -> host port Remote daemons dial 127.0.0.1:port Traffic tunnels back SSH connection","code":"# Host uses localhost URL daemons(   n = 4,   url = local_url(tcp = TRUE),              # tcp://127.0.0.1:0   remote = ssh_config(\"ssh://10.75.32.90\", tunnel = TRUE) )  # Or with specific port daemons(   n = 2,   url = local_url(tcp = TRUE, port = 5555), # tcp://127.0.0.1:5555   remote = ssh_config(\"ssh://remote-server\", tunnel = TRUE) )"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"general-pattern","dir":"Articles","previous_headings":"5. HPC Cluster Configurations","what":"General Pattern","title":"mirai - Quick Reference","text":"","code":"daemons(   n = 4,   url = host_url(),   remote = cluster_config(     command = \"sbatch\",  # Scheduler command: \"sbatch\", \"qsub\", \"bsub\", etc.     options = \"#SBATCH --job-name=mirai                #SBATCH --mem=16G                #SBATCH --cpus-per-task=1                #SBATCH --output=mirai_%j.out                #SBATCH --error=mirai_%j.err                module load R/4.5.0\",     rscript = file.path(R.home(\"bin\"), \"Rscript\")   ) )"},{"path":[]},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"generate-launch-commands","dir":"Articles","previous_headings":"6. Manual Daemon Deployment","what":"Generate Launch Commands","title":"mirai - Quick Reference","text":"","code":"# Set daemons to listen daemons(url = host_url(tls = TRUE))  # Get launch commands (doesn't execute) cmds <- launch_remote(   n = 2,   remote = remote_config()  # Empty config returns commands )  # Copy/paste commands to run on remote machines # E.g. Rscript -e \"mirai::daemon('tcp://10.75.32.70:5555')\" print(cmds)"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"multiple-independent-profiles","dir":"Articles","previous_headings":"7. Compute Profiles","what":"Multiple Independent Profiles","title":"mirai - Quick Reference","text":"","code":"# Create CPU profile daemons(4, .compute = \"cpu\")  # Create GPU profile daemons(2, .compute = \"gpu\")  # Direct tasks to specific profile m_cpu <- mirai(heavy_compute(), .compute = \"cpu\") m_gpu <- mirai(gpu_task(), .compute = \"gpu\")  # Reset specific profile daemons(0, .compute = \"cpu\")"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"scoped-profiles","dir":"Articles","previous_headings":"7. Compute Profiles","what":"Scoped Profiles","title":"mirai - Quick Reference","text":"","code":"# Temporarily use profile with_daemons(\"gpu\", {   model <- mirai(train_model()) })  # Set profile for scope local_daemons(\"cpu\") m <- mirai(task())  # Uses \"cpu\" profile"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"temporary-daemons","dir":"Articles","previous_headings":"8. Common Patterns","what":"Temporary Daemons","title":"mirai - Quick Reference","text":"","code":"with(daemons(4), {   m1 <- mirai(task1())   m2 <- mirai(task2())   c(m1[], m2[]) }) # Daemons auto-reset on exit"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"mixed-localremote-resources","dir":"Articles","previous_headings":"8. Common Patterns","what":"Mixed Local/Remote Resources","title":"mirai - Quick Reference","text":"","code":"daemons(url = host_url()) launch_local(2)             # 2 local daemons launch_remote(4, ssh_config(\"ssh://remote\"))  # 4 remote"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"dynamic-scaling","dir":"Articles","previous_headings":"8. Common Patterns","what":"Dynamic Scaling","title":"mirai - Quick Reference","text":"","code":"daemons(url = host_url())   # Start listening launch_local(2)   # Add 2 daemons # Later... # Add 2 more (automatically exit after idle for 60 secs) launch_local(2, idletime = 60000)"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"basic-usage","dir":"Articles","previous_headings":"9. mirai_map - Parallel Map","what":"Basic Usage","title":"mirai - Quick Reference","text":"","code":"daemons(4)  # Simple map results <- mirai_map(1:10, sqrt)[]  # With additional arguments results <- mirai_map(   1:10,   rnorm,   .args = list(mean = 5, sd = 2) )[]  # With helper functions results <- mirai_map(   1:100,   function(x) transform(x, helper),   helper = my_helper_func )[]"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"collection-options","dir":"Articles","previous_headings":"9. mirai_map - Parallel Map","what":"Collection Options","title":"mirai - Quick Reference","text":"","code":"# Flatten to vector results <- mirai_map(1:10, rnorm, .args = list(n = 1))[.flat]  # Progress bar results <- mirai_map(1:100, slow_func)[.progress]  # Early stopping on error results <- mirai_map(data_list, process)[.stop]  # Combine options results <- mirai_map(1:100, task)[.stop, .progress]"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"multiple-map-over-dataframematrix","dir":"Articles","previous_headings":"9. mirai_map - Parallel Map","what":"Multiple Map (over DataFrame/Matrix)","title":"mirai - Quick Reference","text":"","code":"# Map over dataframe rows df <- data.frame(x = 1:10, y = 11:20) mirai_map(df, function(x, y) x + y)[.flat]  # Map over matrix rows mat <- matrix(1:6, nrow = 3, dimnames = list(c(\"a\",\"b\",\"c\"), c(\"x\",\"y\"))) mirai_map(mat, function(x, y) x * y)[]"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"error-handling","dir":"Articles","previous_headings":"","what":"10. Error Handling","title":"mirai - Quick Reference","text":"","code":"m <- mirai(stop(\"error\")) m[]  # Test error types is_mirai_error(m$data)      # Execution error is_mirai_interrupt(m$data)  # User interrupt is_error_value(m$data)      # Any error (catch-all)  # Access error details m$data$stack.trace          # Full stack trace m$data$condition.class      # Original error classes m$data$message              # Error message"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"monitoring-and-status","dir":"Articles","previous_headings":"","what":"11. Monitoring and Status","title":"mirai - Quick Reference","text":"","code":"status()                    # Detailed status info()                      # Concise statistics  daemons_set()               # Check if daemons exist require_daemons()           # Error if not set"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"timeouts","dir":"Articles","previous_headings":"12. Advanced Features","what":"Timeouts","title":"mirai - Quick Reference","text":"","code":"# Per-mirai timeout (requires dispatcher for auto-cancellation) m <- mirai(Sys.sleep(10), .timeout = 1000)  # 1 second m[]  # Returns errorValue 5 (timed out)"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"cancellation","dir":"Articles","previous_headings":"12. Advanced Features","what":"Cancellation","title":"mirai - Quick Reference","text":"","code":"# Cancel mirai (requires dispatcher) m <- mirai(Sys.sleep(100)) stop_mirai(m)  # Attempts cancellation m$data         # errorValue 20 (canceled)"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"evaluation-everywhere","dir":"Articles","previous_headings":"12. Advanced Features","what":"Evaluation Everywhere","title":"mirai - Quick Reference","text":"","code":"# Load package on all daemons everywhere(library(data.table))  # Export variables to all daemons everywhere(config <<- list(threads = 4))  # Export variables to all daemons everywhere({}, db_conn = my_conn, api_key = key)"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"random-seeds-reproducible","dir":"Articles","previous_headings":"12. Advanced Features","what":"Random Seeds (Reproducible)","title":"mirai - Quick Reference","text":"","code":"# Statistically-sound but non-reproducible (default) daemons(4, seed = NULL)  # Reproducible RNG (seed per mirai call) daemons(4, seed = 123)"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"custom-serialization","dir":"Articles","previous_headings":"12. Advanced Features","what":"Custom Serialization","title":"mirai - Quick Reference","text":"","code":"# For torch tensors, Arrow tables, Polars objects daemons(   4,   serial = serial_config(     \"torch_tensor\",     sfunc = torch::torch_serialize,     ufunc = torch::torch_load   ) )  # Global registration register_serial(\"torch_tensor\", torch::torch_serialize, torch::torch_load) daemons(4)  # Auto-applies registered configs"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"tls-configuration","dir":"Articles","previous_headings":"12. Advanced Features","what":"TLS Configuration","title":"mirai - Quick Reference","text":"","code":"# Auto TLS (zero-config certificates) daemons(url = host_url(tls = TRUE))  # Custom certificate daemons(   url = host_url(tls = TRUE),   tls = \"/path/to/cert.pem\",   pass = function() askpass::askpass() )"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"quick-decision-tree","dir":"Articles","previous_headings":"","what":"14. Quick Decision Tree","title":"mirai - Quick Reference","text":"","code":"┌─ Need async in R? │ ├─ Single task → mirai() │  └─ No daemons set? → ephemeral (auto-creates process) │ ├─ Map operation → mirai_map() │  └─ Requires daemons() to be set first │ └─ Multiple tasks → Set up daemons    │    ├─ Local only    │  └─ daemons(n)    │    ├─ Remote with open ports    │  └─ daemons(url = host_url(), remote = ssh_config(..., tunnel = FALSE))    │    ├─ Remote with firewall/blocked ports    │  └─ daemons(url = local_url(tcp = TRUE), remote = ssh_config(..., tunnel = TRUE))    │    └─ HPC cluster (Slurm/SGE/PBS/LSF)       └─ daemons(url = host_url(), remote = cluster_config(...))"},{"path":"https://mirai.r-lib.org/dev/articles/mirai.html","id":"common-gotchas","dir":"Articles","previous_headings":"","what":"15. Common Gotchas","title":"mirai - Quick Reference","text":"","code":"# Expression Evaluation mirai(pkg::func(x), x = data) # Namespace functions OR library() inside expression mirai(func(x), func = my_func, x = data) # Pass dependencies explicitly via ... or .args  # Dispatcher Required For stop_mirai(m)                           # Cancellation mirai(task(), .timeout = 1000)          # Timeout cancellation daemons(4, serial = serial_config(...)) # Custom serialization  # SSH Tunnelling daemons(url = local_url(tcp = TRUE), remote = ssh_config(..., tunnel = TRUE)) # Must use 127.0.0.1 (not external IP) + tunnel = TRUE  # TLS host_url(tls = TRUE)                    # Auto TLS (zero-config, just works) # Custom certs: provide cert path + optional passphrase function  # Remote Prerequisites # - SSH key-based auth configured beforehand # - SSH direct: host port open to inbound connections # - HPC: correct module load commands and scheduler directives"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"introduction","dir":"Articles","previous_headings":"","what":"1. Introduction","title":"mirai - Reference Manual","text":"mirai (Japanese ‘future’) implements concept futures R. Futures represent results code complete later. Code executes separate R process (daemon) returns results main process (host).","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"mirai","dir":"Articles","previous_headings":"1. Introduction","what":"mirai","title":"mirai - Reference Manual","text":"mirai() creates mirai object expression. returns immediately without blocking. expression evaluates daemon, host process continues working. Expressions must self-contained: Package functions must namespaced :: loaded via library() within expression. Pass required functions, data, objects explicitly via ... .args. explicit design perfectly matches message-passing parallelism - attempting infer global variables introduces unreliability, compromise . example mimics expensive calculation: mirai unresolved result received, resolved. Use unresolved() check state. Access results via m$data resolved. return value, ‘errorValue’ expression errored, crashed, timed (see Error Handling). Use m[] efficiently wait collect value instead repeatedly checking unresolved(m). may also wait efficiently mirai (lists mirai) resolve using: call_mirai() returns mirai passed resolved. race_mirai() returns first mirai passed resolved.","code":"library(mirai)  m <- mirai(   {     Sys.sleep(time)     rnorm(5L, mean)   },   time = 2L,   mean = 4.5 )  m #> < mirai [] > m$data #> 'unresolved' logi NA unresolved(m) #> [1] TRUE  # Do work whilst unresolved  m[] #> [1] 6.218842 3.650785 3.958701 4.108253 4.619849 m$data #> [1] 6.218842 3.650785 3.958701 4.108253 4.619849"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"mirai-advanced","dir":"Articles","previous_headings":"1. Introduction","what":"mirai (advanced)","title":"mirai - Reference Manual","text":"programmatic use, ‘.expr’ accepts pre-constructed language object ‘.args’ accepts named list arguments. following equivalent: example performs asynchronous write operation. Passing environment() ‘.args’ conveniently provides objects calling environment (like x file):","code":"expr <- quote({Sys.sleep(time); rnorm(5L, mean)}) args <- list(time = 2L, mean = 4)  m1 <- mirai(.expr = expr, .args = args) m1[] #> [1] 3.901930 3.121547 3.593815 2.947067 4.729572 write.csv.async <- function(x, file) {   mirai(write.csv(x, file), .args = environment()) }  m <- write.csv.async(x = rnorm(1e6), file = tempfile())  while (unresolved(m)) {   cat(\"Writing file...\\n\")   Sys.sleep(0.5) # or do other work } #> Writing file... #> Writing file... cat(\"Write complete:\", is.null(m$data)) #> Write complete: TRUE"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"daemons","dir":"Articles","previous_headings":"1. Introduction","what":"daemons","title":"mirai - Reference Manual","text":"writing mirai() call, don’t worry executes. End-users declare available resources using daemons(). Without daemons configured, mirai() call creates new local background process (ephemeral daemon). daemons() sets persistent daemons evaluate mirai expressions: Eliminates process startup overhead limits concurrent processes. Cleanup evaluations ensures mirai remains self-contained. See local daemons setup instructions.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"error-handling","dir":"Articles","previous_headings":"","what":"2. Error Handling","title":"mirai - Reference Manual","text":"Errors return character string classes ‘miraiError’ ‘errorValue’. Use is_mirai_error() test errors: Error objects include $stack.trace full stack traces $condition.class original condition classes: Original error condition elements rlang::abort() metadata preserved: User interrupts resolve class ‘miraiInterrupt’ ‘errorValue’. Use is_mirai_interrupt() test interrupts: Timeouts (via ‘.timeout’) resolve ‘errorValue’ 5L, guarding hanging processes: is_error_value() tests mirai execution errors, user interrupts timeouts.","code":"m1 <- mirai(stop(\"occurred with a custom message\", call. = FALSE)) m1[] #> 'miraiError' chr Error: occurred with a custom message  m2 <- mirai(mirai::mirai()) m2[] #> 'miraiError' chr Error in mirai::mirai(): missing expression, perhaps wrap in {}?  is_mirai_error(m2$data) #> [1] TRUE is_error_value(m2$data) #> [1] TRUE f <- function(x) if (x > 0) stop(\"positive\")  m3 <- mirai({f(-1); f(1)}, f = f) m3[] #> 'miraiError' chr Error in f(1): positive  m3$data$stack.trace #> [[1]] #> stop(\"positive\") #>  #> [[2]] #> f(1) m3$data$condition.class #> [1] \"simpleError\" \"error\"       \"condition\" f <- function(x) if (x > 0) stop(\"positive\")  m4 <- mirai(rlang::abort(\"aborted\", meta_uid = \"UID001\")) m4[] #> 'miraiError' chr Error: aborted  m4$data$meta_uid #> [1] \"UID001\" m4 <- mirai(rlang::interrupt()) # simulates a user interrupt is_mirai_interrupt(m4[]) #> [1] TRUE m5 <- mirai(nanonext::msleep(1000), .timeout = 500) m5[] #> 'errorValue' int 5 | Timed out  is_mirai_error(m5$data) #> [1] FALSE is_mirai_interrupt(m5$data) #> [1] FALSE is_error_value(m5$data) #> [1] TRUE"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"local-daemons","dir":"Articles","previous_headings":"","what":"3. Local Daemons","title":"mirai - Reference Manual","text":"Daemons persistent background processes receive mirai() requests. Daemons inherit system configuration (‘.Renviron’, ‘.Rprofile’) load default packages. load base package (cutting startup time half), set R_SCRIPT_DEFAULT_PACKAGES=NULL launching. Specify number daemons launch: Set n one less available cores optimal performance. Consider cores reserved purposes.","code":"daemons(6)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"with-dispatcher-default","dir":"Articles","previous_headings":"3. Local Daemons","what":"With Dispatcher (default)","title":"mirai - Reference Manual","text":"default dispatcher = TRUE creates background dispatcher process manages daemon connections. Tasks dispatch efficiently FIFO order, queueing dispatcher sending daemons become available. event-driven approach consumes resources waiting stays synchronized events. info() provides current statistics integer vector: connections: currently active daemons cumulative: total daemons ever connected awaiting: tasks queued dispatcher executing: tasks currently evaluating completed: tasks completed cancelled status() provides detail: connections: active connections daemons: connection URL mirai: task summary Set daemons zero reset. reverts creating new background process per request.","code":"info() #> connections  cumulative    awaiting   executing   completed  #>           6           6           0           0           0 status() #> $connections #> [1] 6 #>  #> $daemons #> [1] \"ipc:///tmp/43df2d10f7016fe4c9bdc344\" #>  #> $mirai #>  awaiting executing completed  #>         0         0         0 daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"without-dispatcher","dir":"Articles","previous_headings":"3. Local Daemons","what":"Without Dispatcher","title":"mirai - Reference Manual","text":"dispatcher = FALSE, daemons connect directly host process: Tasks send immediately round-robin fashion, ensuring even distribution. However, scheduling isn’t optimal since task duration unknown beforehand. Tasks may queue behind long-running tasks daemons sit idle. resource-light approach suits similar-length tasks concurrent tasks don’t exceed available daemons. Status now shows 6 connections host URL:","code":"daemons(6, dispatcher = FALSE) status() #> $connections #> [1] 6 #>  #> $daemons #> [1] \"ipc:///tmp/f7d6e9c065c1e179c922f75a\""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"everywhere","dir":"Articles","previous_headings":"3. Local Daemons","what":"everywhere()","title":"mirai - Reference Manual","text":"everywhere() evaluates expressions daemons persists state regardless cleanup settings: keeps DBI package loaded. can also set common resources like database connections: Super-assignment makes ‘con’ available globally daemons: Disconnect everywhere: evaluate global environment daemon (since mirai evaluations occur environment inheriting global), use evalq(envir = globalenv()). Example box::use():","code":"everywhere(library(DBI)) everywhere(con <<- dbConnect(RSQLite::SQLite(), file), file = tempfile()) mirai(exists(\"con\"))[] #> [1] TRUE everywhere(dbDisconnect(con)) everywhere(   evalq(     box::use(dplyr[select], mirai[...]),     envir = globalenv()   ) )  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"mirai_map","dir":"Articles","previous_headings":"","what":"4. mirai_map","title":"mirai - Reference Manual","text":"mirai_map() performs asynchronous parallel mapping lists vectors. Requires daemons() set (avoids launching many ephemeral daemons).","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"basic-usage","dir":"Articles","previous_headings":"4. mirai_map","what":"Basic Usage","title":"mirai - Reference Manual","text":"Returns immediately. Collect results x[]: Use .args constant arguments .f, ... objects referenced .f:","code":"with(daemons(3, seed = 1234L), mirai_map(1:3, rnorm, .args = list(mean = 20, sd = 2))[]) #> [[1]] #> [1] 19.86409 #>  #> [[2]] #> [1] 19.55834 22.30159 #>  #> [[3]] #> [1] 20.62193 23.06144 19.61896 daemons(4, seed = 2345L) fn <- function(x, range) runif(x, x, x + range) ml <- mirai_map(c(a = 1, b = 2, c = 3), \\(x) fn(x, x * 2), fn = fn) ml #> < mirai map [0/3] > ml[] #> $a #> [1] 2.637793 #>  #> $b #> [1] 2.328183 5.649959 #>  #> $c #> [1] 5.302906 3.531788 6.389231"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"collecting-options","dir":"Articles","previous_headings":"4. mirai_map","what":"Collecting Options","title":"mirai - Reference Manual","text":"x[.flat] flattens results (checks types avoid coercion) x[.progress] shows progress bar (via cli) text indicator x[.stop] applies early stopping, cancelling remaining tasks first failure","code":"mirai_map(list(a = 1, b = \"a\", c = 3), function(x) exp(x))[.stop] #> Error in `mirai_map()`: #> ℹ In index: 2. #> ℹ With name: b. #> Caused by error in `exp()`: #> ! non-numeric argument to mathematical function  mirai_map(c(0.1, 0.2, 0.3), Sys.sleep)[.progress, .flat] #> NULL"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"multiple-map","dir":"Articles","previous_headings":"4. mirai_map","what":"Multiple Map","title":"mirai - Reference Manual","text":"Dataframes matrices map rows. .f must accept many arguments columns: Matrices also map rows: map columns instead, use .list() dataframes t() matrices.","code":"fruit <- c(\"melon\", \"grapes\", \"coconut\") df <- data.frame(i = seq_along(fruit), fruit = fruit)  mirai_map(df, sprintf, .args = list(fmt = \"%d. %s\"))[.flat] #> [1] \"1. melon\"   \"2. grapes\"  \"3. coconut\" mat <- matrix(1:4, nrow = 2L, dimnames = list(c(\"a\", \"b\"), c(\"y\", \"z\"))) mirai_map(mat, function(x = 10, y = 0, z = 0) x + y + z)[.flat] #>  a  b  #> 14 16  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"nested-maps","dir":"Articles","previous_headings":"4. mirai_map","what":"Nested Maps","title":"mirai - Reference Manual","text":"nested mapping, don’t launch local daemons within mirai_map(). Instead:","code":"daemons(url = local_url()) launch_local(n)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"remote-infrastructure","dir":"Articles","previous_headings":"","what":"5. Remote Infrastructure","title":"mirai - Reference Manual","text":"section covers setting remote daemons, launching remote machines, securing connections TLS.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"remote-daemons-overview","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"Remote Daemons Overview","title":"mirai - Reference Manual","text":"Remote daemons run network machines process tasks remotely. Call daemons() ‘url’ (e.g., ‘tcp://10.75.32.70:5555’) use host_url() construct one automatically. host listens single port daemons connect. IPv6 addresses also supported must enclosed square brackets [] avoid confusion final colon separating port. example, port 5555 IPv6 address ::ffff:a6f:50d specified tcp://[::ffff:a6f:50d]:5555. Calling host_url() without port uses ‘0’, automatically assigns free ephemeral port: Query assigned port status(): Dynamically scale number daemons needed. Reset connections: Closing connections exits daemons. dispatcher, exits dispatcher first, connected daemons.","code":"daemons(url = host_url()) status() #> $connections #> [1] 0 #>  #> $daemons #> [1] \"tcp://10.216.62.38:49515\" #>  #> $mirai #>  awaiting executing completed  #>         0         0         0 daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"launching-remote-daemons","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"Launching Remote Daemons","title":"mirai - Reference Manual","text":"Launchers deploy daemons remote machines. deployed, daemons connect back host via TCP TLS. Local launchers run Rscript via local shell. Remote launchers run Rscript remote machines. Supply remote launch configuration ‘remote’ argument daemons() launch_remote(). Three configuration options: ssh_config() SSH access cluster_config() HPC resource managers (Slurm, SGE, Torque/PBS, LSF) remote_config() generic/custom launchers return simple lists can pre-constructed, saved, reused.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"ssh-direct-connection","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"SSH Direct Connection","title":"mirai - Reference Manual","text":"Use internal networks host can accept incoming connections. Remote daemons connect back directly host port. TLS recommended additional security. Launch 4 daemons 10.75.32.90 (SSH port 22 default): Launch one daemon machine using custom SSH port 222:","code":"daemons(   n = 4,   url = host_url(tls = TRUE, port = 5555),   remote = ssh_config(\"ssh://10.75.32.90\") ) daemons(   n = 1,   url = host_url(tls = TRUE, port = 5555),   remote = ssh_config(c(\"ssh://10.75.32.90:222\", \"ssh://10.75.32.91:222\")) )"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"ssh-tunnelling","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"SSH Tunnelling","title":"mirai - Reference Manual","text":"Use SSH tunnelling firewall policies prevent direct connections. Requires SSH key-based authentication setup. SSH tunnelling creates tunnel initial SSH connection, using port host daemon. Supply ‘127.0.0.1’ URL daemons(): local_url(tcp = TRUE) constructs automatically Default wildcard port ‘0’ assigns free ephemeral port Specify whitelisted port ephemeral port might unavailable daemons local_url(tcp = TRUE, port = 5555), host listens 127.0.0.1:5555 daemons dial 127.0.0.1:5555 machines. Launch 2 daemons 10.75.32.90 tunnelling:","code":"daemons(   n = 2,   url = local_url(tcp = TRUE),   remote = ssh_config(\"ssh://10.75.32.90\", tunnel = TRUE) )"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"hpc-cluster-resource-managers","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"HPC Cluster Resource Managers","title":"mirai - Reference Manual","text":"cluster_config() deploys daemons via cluster resource managers. Specify command: - \"sbatch\" Slurm - \"qsub\" SGE/Torque/PBS - \"bsub\" LSF options argument accepts scheduler options (lines typically preceded #): Pass multi-line string (whitespace auto-handled) use \\n newlines Include shell commands (e.g., cd working directory) Omit shebang lines (e.g., #!/bin/bash) Load environment modules needed: specific R version: rscript argument defaults \"Rscript\" (assumes R PATH). Specify full path needed: file.path(R.home(\"bin\"), \"Rscript\").","code":"Slurm: \"#SBATCH --job-name=mirai           #SBATCH --mem=10G           #SBATCH --output=job.out\"   SGE: \"#$ -N mirai         #$ -l mem_free=10G         #$ -o job.out\"   Torque/PBS: \"#PBS -N mirai                #PBS -l mem=10gb                #PBS -o job.out\"   LSF: \"#BSUB -J mirai         #BSUB -M 10000         #BSUB -o job.out\" module load R module load R/4.5.0"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"job-arrays","dir":"Articles","previous_headings":"5. Remote Infrastructure > HPC Cluster Resource Managers","what":"Job Arrays","title":"mirai - Reference Manual","text":"many daemons, use job arrays instead individual jobs. Instead : rather use:","code":"daemons(n = 100, url = host_url(), remote = cluster_config()) daemons(   n = 1,   url = host_url(),   remote = cluster_config(options = \"#SBATCH --array=1-100\") )"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"generic-remote-configuration","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"Generic Remote Configuration","title":"mirai - Reference Manual","text":"remote_config() provides generic framework custom deployment commands. args argument must contain \".\", replaced daemon launch command. cluster_config() easier HPC, remote_config() offers flexibility. Slurm example:","code":"daemons(   n = 2,   url = host_url(),   remote = remote_config(     command = \"sbatch\",     args = c(\"--mem 512\", \"-n 1\", \"--wrap\", \".\"),     rscript = file.path(R.home(\"bin\"), \"Rscript\"),     quote = TRUE   ) )"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"manual-deployment","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"Manual Deployment","title":"mirai - Reference Manual","text":"Call launch_remote() without ‘remote’ get shell commands manual deployment:","code":"daemons(url = host_url()) launch_remote() #> [1] #> Rscript -e 'mirai::daemon(\"tcp://10.216.62.38:49516\")' daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"tls-secure-connections","dir":"Articles","previous_headings":"5. Remote Infrastructure","what":"TLS Secure Connections","title":"mirai - Reference Manual","text":"TLS secures communications host remote daemons.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"automatic-zero-configuration-default","dir":"Articles","previous_headings":"5. Remote Infrastructure > TLS Secure Connections","what":"Automatic Zero-configuration Default","title":"mirai - Reference Manual","text":"Use tls+tcp:// scheme host_url(tls = TRUE): Keys certificates generate automatically. Private keys remain host. Self-signed certificates included launch_remote() commands:","code":"daemons(url = host_url(tls = TRUE)) launch_remote(1) #> [1] #> Rscript -e 'mirai::daemon(\"tls+tcp://10.216.62.38:49517\",tlscert=c(\"-----BEGIN CERTIFICATE----- #> MIIFPzCCAyegAwIBAgIBATANBgkqhkiG9w0BAQsFADA3MRUwEwYDVQQDDAwxMC4y #> MTYuNjIuMzgxETAPBgNVBAoMCE5hbm9uZXh0MQswCQYDVQQGEwJKUDAeFw0wMTAx #> MDEwMDAwMDBaFw0zMDEyMzEyMzU5NTlaMDcxFTATBgNVBAMMDDEwLjIxNi42Mi4z #> ODERMA8GA1UECgwITmFub25leHQxCzAJBgNVBAYTAkpQMIICIjANBgkqhkiG9w0B #> AQEFAAOCAg8AMIICCgKCAgEAydxZw07AviS9yZjnYP9PL+x/TA5RGEbm+G0Iobct #> ML2a/t8pk+cJ/hwpB8HA0i7eoc52Km8TCz2hturtGe3BS0mvvnzipcs9k2pxga6o #> 3sqbLXvI19sC/CMu5gUWOU9dcFh6BYavVLpUW4j0xjjcXAr4PBBIjF+/Lt5FNWuZ #> srPKC7Q6/ay7b8bFANEcYwZWkoXlWqhY/8EmOqECA97cdCybkfXcIFRU2SFMTQtx #> NbpHqXWvtGKRQxwvYcfnlkLyQwJZr3CsB10gdPCeoXVPKCJf+ZoPQDGA2BH1jdHx #> sxUVMIg9skMdciGHWM/zu+7urXn7HFMoMmXfSnsQSgJ46EnJSEqFQ5W2ZIstfnQE #> tIZFmJqyIr3D6NOvwdk54lK7CkfWr17tcvWlTUhxRsJzR3/rWnQKAIx/R+eMsPfK #> fP8ajpxhFXsfnyZF0U3onvU2L6qjKSUyj3NS4lpb85T5LN56Kp7OauZiqXNBV7b5 #> PCdgSMJljRSXYolMjk7B7KA1LbMigMJwLN5KfnvwUswS6B24XI4F2NmUJXe2nec7 #> Cy7iCiUYI2O1v2MKn0xWUHuJW21EJtPXoNBOBFA6Bpz93/Wf0m6MbSjUH7rf8Xgo #> accxoffGXlE3oKwO/BMbbNwtHMupsdu5MMyv8TGD8F2NqE7b1eT57oDVkfzjGjwR #> b1sCAwEAAaNWMFQwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQU7J2cGBmo #> ZcqDzBVYVQLcQUCQ5ccwHwYDVR0jBBgwFoAU7J2cGBmoZcqDzBVYVQLcQUCQ5ccw #> DQYJKoZIhvcNAQELBQADggIBAHhjNztuQAaPsKKZWweaIY06jak24YsSG64zJBGj #> dbMta7s4r4Sj8DaidEQMcVl4FeVO/3ZLtC9xDpq+QWQkj44Zi1gbOloEkbIy2TK7 #> cmfsPCP3sgjGt9+TAI2Fib5eBXHGH5eITCf99PBUC/rEHhd9LsBqih0gD0iRVZw8 #> PD7KiVUK6R5f0dpGfVvl4l0HEpOFNnq23w6JGZeyMmHbknW6o62VTh+7FtBEci6E #> wwBoUK6lTujzDK3jTLdAPVipTad6yIBK1wgQBfWuGB8/U4Sbr9ji/+sQ5Yp9rUP6 #> aQis8f+KOmj2mxqsEj/NYwm22BmwufAy/5RmXg3S9gdfg2Lf3g73cJZOppd5B/AH #> dL4G2Iym1c8PcT1UkkKDIIzfTHxV4vvyUsqoNX5aJcbmp/Qla7aXkO69ilkDzIjT #> AypracLmZzve8NYtws196/bc1Lk93ezaER+AWODxCoquUDWjl2ybFrfnWhqJ1Z96 #> nK8w4u0LvA6D4JG1lG15XykY/CIj91rRpIaijg3qi0pAoU340YgiT5cKn6tOmBNe #> EdPlZKBazZ3TXTST5NwiMEslLKyKj9htOEIfO0gDKwvb82bazG7SEn1bjxyvGCMb #> DLZFvTcRrv+OT6sFYe8ii1umnwuI+PuRAboyU4ltTSoUaIV0kEvkFTzQBZf5mvrY #> b8kO #> -----END CERTIFICATE----- #> \",\"\"))' daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"ca-signed-certificates","dir":"Articles","previous_headings":"5. Remote Infrastructure > TLS Secure Connections","what":"CA Signed Certificates","title":"mirai - Reference Manual","text":"Alternatively, generate certificates via Certificate Signing Request (CSR) Certificate Authority (public internal). Generate private key CSR: using Mbed TLS: https://mbed-tls.readthedocs.io/en/latest/kb/-/generate--certificate-request-csr/ using OpenSSL: https://www.feistyduck.com/library/openssl-cookbook/online/ (Chapter 1.2 Key Certificate Management) Provide generated CSR CA sign new TLS certificate. common name (CN) certificate must identical hostname IP address actually used connection. verified, fail . received certificate comprise block cipher text markers -----BEGIN CERTIFICATE----- -----END CERTIFICATE-----. Make sure request certificate PEM format. available formats, TLS library used usually provide conversion utilities. Check also private key block cipher text markers -----BEGIN PRIVATE KEY----- -----END PRIVATE KEY-----. setting daemons, TLS certificate private key provided ‘tls’ argument daemons(). certificate private key imported character strings cert key respectively, ‘tls’ argument may specified character vector c(cert, key). Alternatively, certificate may copied new text file, private key appended, case path/filename file may provided ‘tls’ argument. certificate chain CA supplied ‘tlscert’ argument daemons(). certificate chain comprise multiple certificates, -----BEGIN CERTIFICATE----- -----END CERTIFICATE----- markers. first one newly-generated TLS certificate, supplied daemons(), final one CA root certificate. certificates required certificate signed directly CA. , intermediate certificates included certificate chain starts TLS certificate ends certificate CA. concatenated together single character string certchain, character vector comprising empty character string c(certchain, \"\") may supplied ‘tlscert’. Alternatively, written file (file replicated remote machines), ‘tlscert’ argument may also specified path/filename (assuming machine).","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"compute-profiles","dir":"Articles","previous_headings":"","what":"6. Compute Profiles","title":"mirai - Reference Manual","text":".compute argument daemons() creates separate, independent daemon sets (compute profiles) heterogeneous compute requirements: Target daemons specific specs (CPUs, memory, GPU, accelerators) Split local remote computation Pass character string .compute profile name (NULL defaults ‘default’). Settings save name. Specify .compute mirai() use profile (NULL uses ‘default’). functions (status(), launch_local(), launch_remote()) also accept .compute.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"with_daemons-and-local_daemons","dir":"Articles","previous_headings":"6. Compute Profiles","what":"with_daemons() and local_daemons()","title":"mirai - Reference Manual","text":"with_daemons() local_daemons() profile name sets default functions within scope:","code":"daemons(1, .compute = \"cpu\") daemons(1, .compute = \"gpu\")  with_daemons(\"cpu\", {   s1 <- status()   m1 <- mirai(Sys.getpid()) })  with_daemons(\"gpu\", {   s2 <- status()   m2 <- mirai(Sys.getpid())   m3 <- mirai(Sys.getpid(), .compute = \"cpu\")   local_daemons(\"cpu\")   m4 <- mirai(Sys.getpid()) })  s1$daemons #> [1] \"ipc:///tmp/79b5fc7a162b5413cdd1b0e6\" m1[] #> [1] 12700  s2$daemons #> [1] \"ipc:///tmp/5710972c9d0d836a64e8c45a\" m2[] # different to m1 #> [1] 12726  m3[] # same as m1 #> [1] 12700 m4[] # same as m1 #> [1] 12700  with_daemons(\"cpu\", daemons(0)) with_daemons(\"gpu\", daemons(0))"},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"with-method","dir":"Articles","previous_headings":"6. Compute Profiles","what":"With Method","title":"mirai - Reference Manual","text":"() method creates daemons expression’s duration, automatically resets . Functions within scope use daemons’ compute profile. Designed running Shiny apps specific daemon counts: Note: app must already created. Don’t wrap shiny::shinyApp() since runApp() called printed, () returns. Shiny apps execute mirai calls returning (blocking). expressions, collect mirai values ensure completion daemon reset.","code":"with(daemons(4), shiny::runApp(app)) # Or: with(daemons(4, .compute = \"shiny\"), shiny::runApp(app))"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"random-number-generation","dir":"Articles","previous_headings":"7. Advanced Topics","what":"Random Number Generation","title":"mirai - Reference Manual","text":"mirai uses L’Ecuyer-CMRG streams (like base R’s parallel package) statistically-sound parallel RNG. Streams divide RNG sequence far-apart intervals don’t overlap, ensuring valid parallel results. Default (seed = NULL): New stream per daemon (like base R): Statistically sound numerically reproducible across runs Different daemon counts send tasks different daemons Dispatcher sends tasks dynamically (guaranteed daemon run) Reproducible (seed = integer): New stream per mirai() call (per daemon): Deterministic, reproducible results Regardless daemon count Negligible performance impact","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v01-reference.html","id":"synchronous-mode","dir":"Articles","previous_headings":"7. Advanced Topics","what":"Synchronous Mode","title":"mirai - Reference Manual","text":"daemons(sync = TRUE) enables synchronous mode. Mirai evaluate immediately without async operation, useful testing debugging browser(). Restrict specific profile specifying .compute. seed affects behavior sync = TRUE. Example usage:","code":"# run everything in sync: daemons(sync = TRUE) mp <- mirai_map(1:2, \\(x) Sys.getpid()) daemons(0) mp[] #> [[1]] #> [1] 4978 #>  #> [[2]] #> [1] 4978   # Use sync with the 'sync' compute profile: daemons(sync = TRUE, .compute = \"sync\") with_daemons(\"sync\", {   mp <- mirai_map(1:2, \\(x) Sys.getpid()) }) daemons(0, .compute = \"sync\") mp[] #> [[1]] #> [1] 4978 #>  #> [[2]] #> [1] 4978"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"event-driven-promises","dir":"Articles","previous_headings":"","what":"1. Event-driven promises","title":"mirai - Promises (Shiny and Plumber)","text":"mirai provides .promise() method conversion promises package promises. See promises articles comprehensive guide. Use mirai directly : - Promise pipe %...>% (implicitly calls .promise()) - Promise-aware functions (promises::(), shiny::ExtendedTask) explicitly convert .promise() access $(), $finally() methods. Promises register actions triggered mirai resolves. happens automatically R idle within loops/functions calling later::run_now() (e.g., Shiny). Mirai promises pass return values onFulfilled (success) errorValue onRejected (error). Event-driven advantages: Actions trigger immediately resolution (time-polling) Data already received background (transfer delay) High responsiveness (zero latency) massive scalability (thousands/millions concurrent promises) outputs “hello” one second: Access mirai values $data using promises side effects (assigning environment): returning top level prompt: mirai_map also .promise() method. resolves entire map completes mirai rejected.","code":"library(mirai) library(promises)  p <- mirai({Sys.sleep(1); \"hello\"}) %...>% cat() p #> <Promise [pending]> env <- new.env()  m <- mirai({   Sys.sleep(1)   \"hello\" })  promises::then(m, function(x) env$res <- x)  m[] #> [1] \"hello\" env$res #> [1] \"hello\""},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"shiny-extendedtask-introduction","dir":"Articles","previous_headings":"","what":"2. Shiny ExtendedTask: Introduction","title":"mirai - Promises (Shiny and Plumber)","text":"mirai primary async backend scaling Shiny applications. Use daemons() distribute tasks across local parallel processes network resources. Shiny ExtendedTask creates scalable apps responsive intra-session (per user) inter-session (multiple concurrent users). example, clock continues ticking expensive computation runs asynchronously. button disables plot greys completion. Call daemons() top level. Use onStop() automatically shut daemons app exits. Thanks Joe Cheng providing examples based. Key ExtendedTask components: UI: Use bslib::input_task_button() (disables computation): Server: Create ExtendedTask ExtendedTask$new(), passing ... mirai(), bind button: Server: Observe button input, invoke ExtendedTask named arguments: Server: Render output consuming ExtendedTask result:","code":"library(shiny) library(bslib) library(mirai)  ui <- page_fluid(   p(\"The time is \", textOutput(\"current_time\", inline = TRUE)),   hr(),   numericInput(\"n\", \"Sample size (n)\", 100),   numericInput(\"delay\", \"Seconds to take for plot\", 5),   input_task_button(\"btn\", \"Plot uniform distribution\"),   plotOutput(\"plot\") )  server <- function(input, output, session) {   output$current_time <- renderText({     invalidateLater(1000)     format(Sys.time(), \"%H:%M:%S %p\")   })    task <- ExtendedTask$new(     function(...) mirai({Sys.sleep(y); runif(x)}, ...)   ) |> bind_task_button(\"btn\")    observeEvent(input$btn, task$invoke(x = input$n, y = input$delay))    output$plot <- renderPlot(hist(task$result()))  }  # run app using 1 local daemon daemons(1)  # automatically shutdown daemons when app exits onStop(function() daemons(0))  shinyApp(ui = ui, server = server) input_task_button(\"btn\", \"Plot uniform distribution\") task <- ExtendedTask$new(   function(...) mirai({Sys.sleep(y); runif(x)}, ...) ) |> bind_task_button(\"btn\") observeEvent(input$btn, task$invoke(x = input$n, y = input$delay)) output$plot <- renderPlot(hist(task$result()))"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"shiny-extendedtask-cancellation","dir":"Articles","previous_headings":"","what":"3. Shiny ExtendedTask: Cancellation","title":"mirai - Promises (Shiny and Plumber)","text":"demonstrates cancellation, works identically local remote tasks. adds infinite sleep button blocks execution (using one daemon). New tasks queue behind . cancel button stops blocking task, resuming queued plots. Assign mirai reference ExtendedTask$new(), pass stop_mirai(): Thanks Joe Cheng providing examples based.","code":"library(shiny) library(bslib) library(mirai)  ui <- page_fluid(   p(\"The time is \", textOutput(\"current_time\", inline = TRUE)),   hr(),   numericInput(\"n\", \"Sample size (n)\", 100),   numericInput(\"delay\", \"Seconds to take for plot\", 5),   input_task_button(\"btn\", \"Plot uniform distribution\"),   hr(),   p(\"Click 'block' to suspend execution, and 'cancel' to resume\"),   input_task_button(\"block\", \"Block\"),   actionButton(\"cancel\", \"Cancel block\"),   hr(),   plotOutput(\"plot\") )  server <- function(input, output, session) {   output$current_time <- renderText({     invalidateLater(1000)     format(Sys.time(), \"%H:%M:%S %p\")   })    task <- ExtendedTask$new(     function(...) mirai({Sys.sleep(y); runif(x)}, ...)   ) |> bind_task_button(\"btn\")    m <- NULL   block <- ExtendedTask$new(     function() m <<- mirai(Sys.sleep(Inf))   ) |> bind_task_button(\"block\")    observeEvent(input$btn, task$invoke(x = input$n, y = input$delay))   observeEvent(input$block, block$invoke())   observeEvent(input$cancel, stop_mirai(m))   observe({     updateActionButton(session, \"cancel\", disabled = block$status() != \"running\")   })    output$plot <- renderPlot(hist(task$result()))  }  # run app using 1 local daemon daemons(1)  # automatically shutdown daemons when app exits onStop(function() daemons(0))  shinyApp(ui = ui, server = server)"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"shiny-extendedtask-generative-art","dir":"Articles","previous_headings":"","what":"4. Shiny ExtendedTask: Generative Art","title":"mirai - Promises (Shiny and Plumber)","text":"app generates spiral patterns asynchronously. Users add multiple plots via Shiny modules, different calculation times. Daemon limits become visible: 3 daemons 4 plots, 4th waits another finish. Wrapping runApp() (daemons(...), ...) sets daemons app’s duration, exiting automatically stop. example builds original code Joe Cheng, Daniel Woodie William Landau. uses environment() instead ... pass calling environment variables mirai. Key components: UI: Use bslib::input_task_button(): Server: Create ExtendedTask named arguments passed environment(): Server: Observe button, invoke ExtendedTask arguments: Server: Render output consuming result:","code":"library(shiny) library(mirai) library(bslib) library(ggplot2) library(aRtsy)  # function definitions  run_task <- function(calc_time) {   Sys.sleep(calc_time)   list(     colors = aRtsy::colorPalette(name = \"random\", n = 3),     angle = runif(n = 1, min = - 2 * pi, max = 2 * pi),     size = 1,     p = 1   ) }  plot_result <- function(result) {   do.call(what = canvas_phyllotaxis, args = result) }  # modules for individual plots  plotUI <- function(id, calc_time) {   ns <- NS(id)   card(     strong(paste0(\"Plot (calc time = \", calc_time, \" secs)\")),     input_task_button(ns(\"resample\"), \"Resample\"),     plotOutput(ns(\"plot\"), height=\"400px\", width=\"400px\")   ) }  plotServer <- function(id, calc_time) {   force(id)   force(calc_time)   moduleServer(     id,     function(input, output, session) {        task <- ExtendedTask$new(         function(time, run) mirai(run(time), environment())       ) |> bind_task_button(\"resample\")        observeEvent(input$resample, task$invoke(calc_time, run_task))        output$plot <- renderPlot(plot_result(task$result()))      }   ) }  # ui and server  ui <- page_sidebar(fillable = FALSE,   sidebar = sidebar(     numericInput(\"calc_time\", \"Calculation time (secs)\", 5),     actionButton(\"add\", \"Add\", class=\"btn-primary\"),   ),   layout_column_wrap(id = \"results\", width = \"400px\", fillable = FALSE) )  server <- function(input, output, session) {    observeEvent(input$add, {     id <- nanonext::random(4)     insertUI(\"#results\", where = \"beforeEnd\", ui = plotUI(id, input$calc_time))     plotServer(id, input$calc_time)   }) }  app <- shinyApp(ui, server)  # run app using 3 local daemons with(daemons(3), runApp(app)) input_task_button(ns(\"resample\"), \"Resample\") task <- ExtendedTask$new(   function(time, run) mirai(run(time), environment()) ) |> bind_task_button(\"resample\") observeEvent(input$resample, task$invoke(calc_time, run_task)) output$plot <- renderPlot(plot_result(task$result()))"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"shiny-extendedtask-mirai-map","dir":"Articles","previous_headings":"","what":"5. Shiny ExtendedTask: mirai map","title":"mirai - Promises (Shiny and Plumber)","text":"mirai_map .promise() method direct use ExtendedTask. Resolves entire map completes mirai rejected. performs multiple simultaneous calculations across daemons, returning results asynchronously:","code":"library(shiny) library(bslib) library(mirai)  ui <- page_fluid(   titlePanel(\"ExtendedTask Map Demo\"),   hr(),   p(\"The time is \", textOutput(\"current_time\", inline = TRUE)),   p(\"Perform 4 calculations that each take between 1 and 4 secs to complete:\"),   input_task_button(\"calculate\", \"Calculate\"),   p(textOutput(\"result\")),   tags$style(type=\"text/css\", \"#result {white-space: pre-wrap;}\") )  server <- function(input, output) {   task <- ExtendedTask$new(function() {     mirai_map(1:4, function(i) {       # simulated long calculation       Sys.sleep(i)       sprintf(         \"Calc %d | PID %d | Finished at %s.\", i, Sys.getpid(), format(Sys.time())       )     })   }) |> bind_task_button(\"calculate\")      observeEvent(input$calculate, {     task$invoke()   })      output$result <- renderText({     # result of mirai_map() is a list     as.character(task$result())   }, sep = \"\\n\")      output$current_time <- renderText({     invalidateLater(1000)     format(Sys.time(), \"%H:%M:%S %p\")   }) }  app <- shinyApp(ui, server) with(daemons(4), runApp(app))"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"shiny-async-coin-flips","dir":"Articles","previous_headings":"","what":"6. Shiny Async: Coin Flips","title":"mirai - Promises (Shiny and Plumber)","text":"integrates mirai_map() Shiny observer without ExtendedTask. ‘.promise’ argument registers promise actions mapped operation, updating reactive values interacting app: adaptation original example provided Landau use crew Shiny. Please see https://wlandau.github.io/crew/articles/shiny.html.","code":"library(shiny) library(mirai)  flip_coin <- function(...) {   Sys.sleep(0.1)   rbinom(n = 1, size = 1, prob = 0.501) }  ui <- fluidPage(   div(\"Is the coin fair?\"),   actionButton(\"task\", \"Flip 1000 coins\"),   textOutput(\"status\"),   textOutput(\"outcomes\") )  server <- function(input, output, session) {    # Keep running totals of heads, tails, and task errors   flips <- reactiveValues(heads = 0, tails = 0, flips = 0)    # Button to submit a batch of coin flips   observeEvent(input$task, {     mirai_map(       1:1000,       flip_coin,       .promise = \\(x) {         if (x) flips$heads <- flips$heads + 1 else flips$tails <- flips$tails + 1       }     )     # Ensure there is something after mirai_map() in the observer, as it is     # convertible to a promise, and will otherwise be waited for before returning     flips$flips <- flips$flips + 1000   })    # Print time and task status   output$status <- renderText({     invalidateLater(millis = 1000)     time <- format(Sys.time(), \"%H:%M:%S\")     sprintf(\"%s | %s flips submitted\", time, flips$flips)   })    # Print number of heads and tails   output$outcomes <- renderText(     sprintf(\"%s heads %s tails\", flips$heads, flips$tails)   )  }  app <- shinyApp(ui = ui, server = server)  # run app using 8 local non-dispatcher daemons (tasks are the same length) with(daemons(8, dispatcher = FALSE), {   # pre-load flip_coin function on all daemons for efficiency   everywhere({}, flip_coin = flip_coin)   runApp(app) })"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"shiny-async-progress-bar","dir":"Articles","previous_headings":"","what":"7. Shiny Async: Progress Bar","title":"mirai - Promises (Shiny and Plumber)","text":"uses mirai_map() update Shiny progress bar custom messages reactive value upon completion (asynchronously): example adapts contribution Davide Magno.","code":"library(shiny) library(mirai) library(promises)  slow_squared <- function(x) {   Sys.sleep(runif(1))   x^2 }  ui <- fluidPage(   titlePanel(\"Asynchronous Squares Calculator\"),   p(\"The time is \", textOutput(\"current_time\", inline = TRUE)),   hr(),   actionButton(\"start\", \"Start Calculation\"),   br(), br(),   uiOutput(\"progress_ui\"),   verbatimTextOutput(\"result\") )  server <- function(input, output, session) {   x <- 1:100   y <- reactiveVal()      observeEvent(input$start, {          progress <- Progress$new(session, min = 0, max = length(x))     progress$set(message = \"Parallel calculation in progress\", detail = \"Starting...\")     completed <- reactiveVal(0)     mirai_map(       x,       slow_squared,       slow_squared = slow_squared,       .promise = function(result) {         new_val <- completed() + 1         completed(new_val)  # Increment completed counter         progress$inc(1, detail = paste(\"Completed\", new_val))  # Update progress       }     ) %...>% {       y(unlist(.))       progress$close()     }     # Ensure there is something after mirai_map() in the observer, as otherwise     # the created promise will be waited for before returning     y(0)   })   output$current_time <- renderText({     invalidateLater(1000)     format(Sys.time(), \"%H:%M:%S %p\")   })   output$result <- renderPrint({     cat(\"Sum of squares calculated: \", sum(y()), \"\\n\")   }) }  app <- shinyApp(ui, server) with(daemons(8), runApp(app))"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"plumber-get-endpoint","dir":"Articles","previous_headings":"","what":"8. Plumber GET Endpoint","title":"mirai - Promises (Shiny and Plumber)","text":"mirai serves async backend plumber pipelines. runs plumber router daemon process avoid blocking (useful interactive sessions; otherwise use code within outer mirai() call directly). /echo endpoint accepts GET requests, sleeps 1 second (simulating expensive computation), returns ‘msg’ header timestamp process ID: Query API using async HTTP client like nanonext::ncurl_aio(). 8 requests submit , responses differing timestamps (4 process simultaneously due daemon limit):","code":"library(mirai)  daemons(1L, dispatcher = FALSE)  m <- mirai({   library(plumber)   library(promises) # to provide the promise pipe   library(mirai)    # more efficient not to use dispatcher if all requests are similar length   daemons(4L, dispatcher = FALSE) # handles 4 requests simultaneously    pr() |>     pr_get(       \"/echo\",       function(req, res) {         mirai(           {             Sys.sleep(1L)             list(               status = 200L,               body = list(                 time = format(Sys.time()), msg = msg, pid = Sys.getpid()               )             )           },           msg = req$HEADERS$msg         ) %...>% (function(x) {           res$status <- x$status           res$body <- x$body         })       }     ) |>     pr_run(host = \"127.0.0.1\", port = 8985) }) library(nanonext) res <- lapply(   1:8,   function(i) ncurl_aio(     \"http://127.0.0.1:8985/echo\",     headers = c(msg = as.character(i))   ) ) collect_aio(res) #> [[1]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\" #>  #> [[2]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\" #>  #> [[3]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\" #>  #> [[4]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\" #>  #> [[5]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\" #>  #> [[6]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\" #>  #> [[7]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\" #>  #> [[8]] #> [1] \"{\\\"error\\\":\\\"500 - Internal server error\\\"}\"  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v02-promises.html","id":"plumber-post-endpoint","dir":"Articles","previous_headings":"","what":"9. Plumber POST Endpoint","title":"mirai - Promises (Shiny and Plumber)","text":"uses POST endpoint accepting JSON request data. Always access req$postBody router process pass mirai argument (uses non-serializable connection): Querying produces output previous example:","code":"library(mirai)  daemons(1L, dispatcher = FALSE)  m <- mirai({   library(plumber)   library(promises) # to provide the promise pipe   library(mirai)    # uses dispatcher - suitable when requests take differing times to complete   daemons(4L) # handles 4 requests simultaneously    pr() |>     pr_post(       \"/echo\",       function(req, res) {         mirai(           {             Sys.sleep(1L) # simulate expensive computation             list(               status = 200L,               body = list(                 time = format(Sys.time()),                 msg = jsonlite::parse_json(data)$msg,                 pid = Sys.getpid()               )             )           },           data = req$postBody         ) %...>% (function(x) {           res$status <- x$status           res$body <- x$body         })       }     ) |>     pr_run(host = \"127.0.0.1\", port = 8986) }) library(nanonext) res <- lapply(   1:8,   function(i) ncurl_aio(     \"http://127.0.0.1:8986/echo\",     method = \"POST\",     data = sprintf('{\"msg\":\"%d\"}', i)   ) ) collect_aio(res) #> [[1]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:11\\\"],\\\"msg\\\":[\\\"1\\\"],\\\"pid\\\":[71207]}\" #>  #> [[2]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:12\\\"],\\\"msg\\\":[\\\"2\\\"],\\\"pid\\\":[71207]}\" #>  #> [[3]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:11\\\"],\\\"msg\\\":[\\\"3\\\"],\\\"pid\\\":[71217]}\" #>  #> [[4]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:11\\\"],\\\"msg\\\":[\\\"4\\\"],\\\"pid\\\":[71205]}\" #>  #> [[5]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:12\\\"],\\\"msg\\\":[\\\"5\\\"],\\\"pid\\\":[71217]}\" #>  #> [[6]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:12\\\"],\\\"msg\\\":[\\\"6\\\"],\\\"pid\\\":[71223]}\" #>  #> [[7]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:12\\\"],\\\"msg\\\":[\\\"7\\\"],\\\"pid\\\":[71205]}\" #>  #> [[8]] #> [1] \"{\\\"time\\\":[\\\"2025-11-26 00:03:11\\\"],\\\"msg\\\":[\\\"8\\\"],\\\"pid\\\":[71223]}\"  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v03-serialization.html","id":"serialization-arrow-polars-and-beyond","dir":"Articles","previous_headings":"","what":"1. Serialization: Arrow, polars and beyond","title":"mirai - Serialization (Arrow, ADBC, polars, torch)","text":"Native R serialization transfers data host daemons. Objects accessed via external pointers serialized normally error mirai operations. Using arrow example: serial_config() creates custom serialization configurations functions hook R’s native serialization mechanism reference objects (‘refhooks’). Pass configuration ‘serial’ argument daemons(): arrow table now handles seamlessly, even deeply nested lists structures. Register multiple serialization functions different object classes. example combines Arrow polars, Rust dataframe library (requires polars >= 1.0.0):","code":"library(mirai) library(arrow, warn.conflicts = FALSE) daemons(1) everywhere(library(arrow))  x <- as_arrow_table(iris)  m <- mirai(list(a = head(x), b = \"some text\"), x = x) m[] #> 'miraiError' chr Error: Invalid <Table>, external pointer to null  daemons(0) cfg <- serial_config(   \"ArrowTabular\",   arrow::write_to_raw,   function(x) arrow::read_ipc_stream(x, as_data_frame = FALSE) )  daemons(1, serial = cfg)  everywhere(library(arrow))  m <- mirai(list(a = head(x), b = \"some text\"), x = x) m[] #> $a #> Table #> 6 rows x 5 columns #> $Sepal.Length <double> #> $Sepal.Width <double> #> $Petal.Length <double> #> $Petal.Width <double> #> $Species <dictionary<values=string, indices=int8>> #>  #> See $metadata for additional Schema metadata #>  #> $b #> [1] \"some text\"  daemons(0) daemons(   n = 1,   serial = serial_config(     c(\"ArrowTabular\", \"polars_data_frame\"),     list(arrow::write_to_raw, \\(x) x$serialize()),     list(function(x) arrow::read_ipc_stream(x, as_data_frame = FALSE), polars::pl$deserialize_df)   ) )  x <- polars::as_polars_df(iris)  m <- mirai(list(a = head(x), b = \"some text\"), x = x) m[] #> $a #> shape: (6, 5) #> ┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐ #> │ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │ #> │ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │ #> │ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │ #> ╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡ #> │ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa  │ #> │ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         ┆ setosa  │ #> │ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         ┆ setosa  │ #> │ 4.6          ┆ 3.1         ┆ 1.5          ┆ 0.2         ┆ setosa  │ #> │ 5.0          ┆ 3.6         ┆ 1.4          ┆ 0.2         ┆ setosa  │ #> │ 5.4          ┆ 3.9         ┆ 1.7          ┆ 0.4         ┆ setosa  │ #> └──────────────┴─────────────┴──────────────┴─────────────┴─────────┘ #>  #> $b #> [1] \"some text\"  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v03-serialization.html","id":"serialization-torch","dir":"Articles","previous_headings":"","what":"2. Serialization: Torch","title":"mirai - Serialization (Arrow, ADBC, polars, torch)","text":"torch tensors work seamlessly mirai computations. Setup: Create serialization configuration ‘class’ ‘torch_tensor’ Set daemons, supplying configuration ‘serial’ (Optional) Use everywhere() load torch daemons Example Usage: creates convolutional neural network torch::nn_module(), specifies parameters, initializes parallel process: returned model contains many tensor elements: Pass model parameters optimizer, also initialized parallel process: Tensors complex objects containing tensors pass seamlessly host daemons like R object. Custom serialization leverages R’s native ‘refhook’ mechanism transparent usage. Fast efficient, minimizes data copies uses official torch serialization methods directly.","code":"library(mirai) library(torch)  cfg <- serial_config(   class = \"torch_tensor\",   sfunc = torch::torch_serialize,   ufunc = torch::torch_load )  daemons(1, serial = cfg)  everywhere(library(torch)) model <- nn_module(   initialize = function(in_size, out_size) {     self$conv1 <- nn_conv2d(in_size, out_size, 5)     self$conv2 <- nn_conv2d(in_size, out_size, 5)   },   forward = function(x) {     x <- self$conv1(x)     x <- nnf_relu(x)     x <- self$conv2(x)     x <- nnf_relu(x)     x   } )  params <- list(in_size = 1, out_size = 20)  m <- mirai(do.call(model, params), model = model, params = params)  m[] #> An `nn_module` containing 1,040 parameters. #>  #> ── Modules ───────────────────────────────────────────────────────────────────────────────── #> • conv1: <nn_conv2d> #520 parameters #> • conv2: <nn_conv2d> #520 parameters m$data$parameters$conv1.weight #> torch_tensor #> (1,1,.,.) =  #>  -0.1218  0.1835 -0.1114 -0.1365 -0.1824 #>   0.1107 -0.0498 -0.1219 -0.0938 -0.1570 #>  -0.1944  0.0355  0.1750 -0.1612 -0.1590 #>  -0.0806 -0.1906 -0.0272 -0.1732 -0.0491 #>  -0.0079 -0.0874 -0.1256  0.1276  0.0664 #>  #> (2,1,.,.) =  #>  -0.1450 -0.0371  0.0601 -0.1578  0.0918 #>   0.1118 -0.0800  0.0359  0.0452  0.1182 #>   0.0516  0.0109  0.0186  0.1399 -0.1431 #>   0.1720 -0.0919  0.0616  0.0937  0.1511 #>  -0.0270  0.0936  0.1510  0.1995  0.1934 #>  #> (3,1,.,.) =  #>   0.1055  0.0056  0.0491 -0.0096  0.0655 #>   0.1950  0.0676  0.0254  0.0834 -0.0401 #>   0.1658  0.1767 -0.0338  0.1644  0.1806 #>  -0.0346 -0.1521  0.0490  0.1153  0.0755 #>  -0.0832  0.0074 -0.0607  0.1704  0.1454 #>  #> (4,1,.,.) =  #>   0.1091  0.1982  0.1185  0.1655  0.1716 #>   0.1987 -0.0517 -0.0115 -0.0641  0.0294 #>   0.0078 -0.0942 -0.1629 -0.1114 -0.0833 #>   0.0395 -0.0101  0.0837  0.1523  0.0673 #>  -0.0984  0.0988 -0.1154  0.0453 -0.1577 #>  #> (5,1,.,.) =  #>   0.0630 -0.0820 -0.1399  0.0528 -0.0896 #> ... [the output was truncated (use n=-1 to disable)] #> [ CPUFloatType{20,1,5,5} ][ requires_grad = TRUE ] optim <- mirai(optim_rmsprop(params = params), params = m$data$parameters)  optim[] #> <optim_rmsprop> #>   Inherits from: <torch_optimizer> #>   Public: #>     add_param_group: function (param_group)  #>     clone: function (deep = FALSE)  #>     defaults: list #>     initialize: function (params, lr = 0.01, alpha = 0.99, eps = 1e-08, weight_decay = 0,  #>     load_state_dict: function (state_dict, ..., .refer_to_state_dict = FALSE)  #>     param_groups: list #>     state: State, R6 #>     state_dict: function ()  #>     step: function (closure = NULL)  #>     zero_grad: function (set_to_none = FALSE)  #>   Private: #>     deep_clone: function (name, value)  #>     step_helper: function (closure, loop_fun)  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v03-serialization.html","id":"database-hosting-using-arrow-database-connectivity","dir":"Articles","previous_headings":"","what":"3. Database Hosting using Arrow Database Connectivity","title":"mirai - Serialization (Arrow, ADBC, polars, torch)","text":"Use DBI access manipulate Apache Arrow data efficiently ADBC (Arrow Database Connectivity). creates -memory SQLite connection using adbcsqlite backend. Serialization uses arrow functions daemons() call. class ‘nanoarrow_array_stream’ since nanoarrow backs DBI db*Arrow() queries: Use mirai() write query database Arrow format: Tight integration R’s ‘refhook’ system allows returning complex nested objects multiple Arrow queries: Use everywhere() cleanly tear databases resetting daemons:","code":"library(mirai)  cfg <- serial_config(   class = \"nanoarrow_array_stream\",   sfunc = arrow::write_to_raw,   ufunc = function(x) arrow::read_ipc_stream(x, as_data_frame = FALSE) )  daemons(1, serial = cfg)  everywhere(   {     library(DBI) # `adbi` and `adbcsqlite` packages must also be installed     con <<- dbConnect(adbi::adbi(\"adbcsqlite\"), uri = \":memory:\")   } ) m <- mirai(dbWriteTableArrow(con, \"iris\", iris)) m[] #> [1] TRUE m <- mirai(dbReadTableArrow(con, \"iris\")) m[] #> Table #> 150 rows x 5 columns #> $Sepal.Length <double> #> $Sepal.Width <double> #> $Petal.Length <double> #> $Petal.Width <double> #> $Species <string> m <- mirai(dbGetQueryArrow(con, 'SELECT * FROM iris WHERE \"Sepal.Length\" < 4.6')) m[] #> Table #> 5 rows x 5 columns #> $Sepal.Length <double> #> $Sepal.Width <double> #> $Petal.Length <double> #> $Petal.Width <double> #> $Species <string> m <- mirai({   a <- dbGetQueryArrow(con, 'SELECT * FROM iris WHERE \"Sepal.Length\" < 4.6')   b <- dbGetQueryArrow(con, 'SELECT * FROM iris WHERE \"Sepal.Width\" < 2.6')   x <- dbGetQueryArrow(con, 'SELECT * FROM iris WHERE \"Petal.Length\" < 1.5')   y <- dbGetQueryArrow(con, 'SELECT * FROM iris WHERE \"Petal.Width\" < 0.2')   list(sepal = list(length = a, width = b), petal = list(length = x, width = y)) }) m[] #> $sepal #> $sepal$length #> Table #> 5 rows x 5 columns #> $Sepal.Length <double> #> $Sepal.Width <double> #> $Petal.Length <double> #> $Petal.Width <double> #> $Species <string> #>  #> $sepal$width #> Table #> 19 rows x 5 columns #> $Sepal.Length <double> #> $Sepal.Width <double> #> $Petal.Length <double> #> $Petal.Width <double> #> $Species <string> #>  #>  #> $petal #> $petal$length #> Table #> 24 rows x 5 columns #> $Sepal.Length <double> #> $Sepal.Width <double> #> $Petal.Length <double> #> $Petal.Width <double> #> $Species <string> #>  #> $petal$width #> Table #> 5 rows x 5 columns #> $Sepal.Length <double> #> $Sepal.Width <double> #> $Petal.Length <double> #> $Petal.Width <double> #> $Species <string> everywhere(dbDisconnect(con)) daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v03-serialization.html","id":"shiny-mirai-dbi-adbc-integrated-example","dir":"Articles","previous_headings":"","what":"4. Shiny / mirai / DBI / ADBC Integrated Example","title":"mirai - Serialization (Arrow, ADBC, polars, torch)","text":"demonstrates database connections hosted mirai daemons powering Shiny app. One-time serialization() setup ensures seamless Arrow data transport global environment outside server(). Shiny session creates new database connection new daemon process, freeing resources session ends. logic lives server(). unique ID identifies session specifies daemons ‘compute profile’. Non-dispatcher daemons work since scheduling isn’t needed (queries take similar time, session uses one daemon). Shiny ExtendedTask performs queries via mirai() using session-specific compute profile:","code":"library(mirai) library(secretbase) library(shiny) library(bslib)  # create an Arrow serialization configuration cfg <- serial_config(   class = \"nanoarrow_array_stream\",   sfunc = arrow::write_to_raw,   ufunc = nanoarrow::read_nanoarrow )  # write 'iris' dataset to temp database file (for this demonstration) file <- tempfile() con <- DBI::dbConnect(adbi::adbi(\"adbcsqlite\"), uri = file) DBI::dbWriteTableArrow(con, \"iris\", iris) DBI::dbDisconnect(con)  # common input parameters slmin <- min(iris$Sepal.Length) slmax <- max(iris$Sepal.Length)  ui <- page_fluid(   p(\"The time is \", textOutput(\"current_time\", inline = TRUE)),   hr(),   h3(\"Shiny / mirai / DBI / ADBC demonstration\"),   p(\"New daemon-hosted database connection is created for every Shiny session\"),   sliderInput(     \"sl\", \"Query iris dataset based on Sepal Length\", min = slmin, max = slmax,     value = c(slmin, slmax), width = \"75%\"   ),   input_task_button(\"btn\", \"Return query\"),   tableOutput(\"table\") )  # uses Shiny ExtendedTask with mirai server <- function(input, output, session) {    # create unique session id by hashing current time with a random key   id <- secretbase::siphash13(Sys.time(), key = nanonext::random(4L))    # create new daemon for each session   daemons(1L, serial = cfg, .compute = id)    # tear down daemon when session ends   session$onEnded(function() daemons(0L, .compute = id))    # everywhere() loads DBI and creates ADBC connection in each daemon   # and sets up serialization   everywhere(     {       library(DBI) # `adbi` and `adbcsqlite` packages must also be installed       con <<- dbConnect(adbi::adbi(\"adbcsqlite\"), uri = file)     },     file = file,     .compute = id   )    output$current_time <- renderText({     invalidateLater(1000)     format(Sys.time(), \"%H:%M:%S %p\")   })    task <- ExtendedTask$new(     function(...) mirai(       dbGetQueryArrow(         con,         sprintf(           \"SELECT * FROM iris WHERE \\\"Sepal.Length\\\" BETWEEN %.2f AND %.2f\",           sl[1L],           sl[2L]         )       ),       ...,       .compute = id     )   ) |> bind_task_button(\"btn\")    observeEvent(input$btn, task$invoke(sl = input$sl))    output$table <- renderTable(task$result())  }  # run Shiny app shinyApp(ui = ui, server = server)  # deletes temp database file (for this demonstration) unlink(file)"},{"path":"https://mirai.r-lib.org/dev/articles/v04-parallel.html","id":"mirai-parallel-clusters","dir":"Articles","previous_headings":"","what":"1. Mirai Parallel Clusters","title":"mirai - Communications Backend for R","text":"mirai provides alternative communications backend R, developed fulfill R Core request R Project Sprint 2023. ‘miraiCluster’ official cluster type R 4.5, created via parallel::makeCluster(type = \"MIRAI\"). calls make_cluster(), can also create ‘miraiCluster’ directly. Specify ‘n’ launch local nodes Specify ‘url’ receive remote node connections Optionally specify ‘remote’ launch remote daemons using configurations ssh_config(), cluster_config() remote_config() Use clusters parallel package function (clusterApply(), parLapply(), parLapplyLB(), etc.): Call status() ‘miraiCluster’ query connected nodes: Specifying ‘url’ without ‘remote’ prints shell commands manual node deployment:","code":"library(parallel) library(mirai)  cl <- makeCluster(6, type = \"MIRAI\") cl #> < miraiCluster | ID: `6` nodes: 6 active: TRUE > parLapply(cl, iris, mean) #> $Sepal.Length #> [1] 5.843333 #>  #> $Sepal.Width #> [1] 3.057333 #>  #> $Petal.Length #> [1] 3.758 #>  #> $Petal.Width #> [1] 1.199333 #>  #> $Species #> [1] NA status(cl) #> $connections #> [1] 6 #>  #> $daemons #> [1] \"abstract://5a335f57a7147dfa61e2a2e1\" stopCluster(cl) cl <- make_cluster(n = 2, url = host_url()) #> Shell commands for deployment on nodes: #>  #> [1] #> Rscript -e 'mirai::daemon(\"tcp://192.168.1.71:32813\",dispatcher=FALSE,cleanup=FALSE,rs=c(10407,-2017547658,214728319,548191924,-1363682779,426938530,-1028125765))' #>  #> [2] #> Rscript -e 'mirai::daemon(\"tcp://192.168.1.71:32813\",dispatcher=FALSE,cleanup=FALSE,rs=c(10407,-1867685510,-159147708,-691588212,540247216,961983403,-147487023))' stop_cluster(cl)"},{"path":"https://mirai.r-lib.org/dev/articles/v04-parallel.html","id":"foreach-support","dir":"Articles","previous_headings":"","what":"2. Foreach Support","title":"mirai - Communications Backend for R","text":"Register ‘miraiCluster’ doParallel use foreach. Parallel foreach() examples:","code":"library(doParallel) library(foreach)  cl <- makeCluster(6, type = \"MIRAI\") registerDoParallel(cl)  # normalize the rows of a matrix m <- matrix(rnorm(9), 3, 3) foreach(i = 1:nrow(m), .combine = rbind) %dopar%   (m[i, ] / mean(m[i, ])) #>                 [,1]      [,2]        [,3] #> result.1 -46.2302113 70.803471 -21.5732593 #> result.2  -5.8061198  6.682595   2.1235251 #> result.3   0.8150484  1.465484   0.7194677  # simple parallel matrix multiply a <- matrix(1:16, 4, 4) b <- t(a) foreach(b = iterators::iter(b, by='col'), .combine = cbind) %dopar%   (a %*% b) #>      [,1] [,2] [,3] [,4] #> [1,]  276  304  332  360 #> [2,]  304  336  368  400 #> [3,]  332  368  404  440 #> [4,]  360  400  440  480  stopCluster(cl)"},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"introduction","dir":"Articles","previous_headings":"","what":"1. Introduction","title":"mirai - OpenTelemetry","text":"mirai provides comprehensive OpenTelemetry (otel) tracing observing async operations distributed computation. otel otelsdk installed tracing enabled, mirai automatically creates spans tracking daemon management, async operations, task execution lifecycles. Detailed monitoring : Task submission completion times Daemon lifecycle performance Error tracking debugging Distributed tracing across network boundaries","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"automatic-tracing-setup","dir":"Articles","previous_headings":"","what":"2. Automatic Tracing Setup","title":"mirai - OpenTelemetry","text":"Tracing enables automatically : otel otelsdk packages installed OpenTelemetry tracing configured enabled (see https://otelsdk.r-lib.org/reference/collecting.html) additional action needed - mirai automatically detects OpenTelemetry begins tracing.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"span-types-and-hierarchy","dir":"Articles","previous_headings":"","what":"3. Span Types and Hierarchy","title":"mirai - OpenTelemetry","text":"mirai creates several span types representing different operations.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"core-span-types","dir":"Articles","previous_headings":"3. Span Types and Hierarchy","what":"3.1 Core Span Types","title":"mirai - OpenTelemetry","text":"daemons set / daemons reset Root span compute profile, created daemons set/reset. Span name includes URL easy identification. Kind: internal server.address (e.g. ‘127.0.0.1’ ‘hostname’) server.port (applicable) network.transport (e.g. ‘tcp’ ‘ipc’) mirai.dispatcher (true/false) mirai.compute (profile name) daemon connect / daemon disconnect Daemon process span, created daemon connects/disconnects. Span name includes URL easy identification. Kind: internal server.address (e.g. ‘127.0.0.1’ ‘hostname’) server.port (applicable) network.transport (e.g. ‘tcp’ ‘ipc’) mirai_map Parallel map operation span encompassing entire map operation across multiple mirai tasks. Kind: internal mirai Client-side async task span. Created mirai() called, ends returns. Kind: client Attributes: mirai.id (unique task identifier) daemon eval Server-side task evaluation span. Tracks actual mirai evaluation duration daemon. Kind: server","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"span-relationships-and-context-propagation","dir":"Articles","previous_headings":"3. Span Types and Hierarchy","what":"3.2 Span Relationships and Context Propagation","title":"mirai - OpenTelemetry","text":"Spans form distributed structure tracing complete async operation lifecycle: Context Propagation: Context automatically packaged mirai() call extracted daemon side, enabling proper parent-child relationships across process boundaries. Span Links: Tasks link compute profile’s daemons set span (client-side) daemon connect span (server-side), showing exactly evaluation occurred. daemons reset disconnect, new spans record events linking back originals.","code":"daemons set (compute profile - top level) daemon connect (daemon process 1 - top level) ... daemon connect (daemon process N - top level)  mirai_map (top level) ──link→ daemons set ├── mirai (task 1) ──link→ daemons set │   └── daemon eval ──link→ daemon connect ├── mirai (task 2) ──link→ daemons set │   └── daemon eval ──link→ daemon connect └── mirai (task N) ──link→ daemons set     └── daemon eval ──link→ daemon connect      mirai (top level) ──link→ daemons set └── daemon eval ──link→ daemon connect  daemons reset ──link→ daemons set daemon disconnect (daemon process 1) ──link→ daemon connect ... daemon disconnect (daemon process N) ──link→ daemon connect"},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"status-and-error-tracking","dir":"Articles","previous_headings":"","what":"4. Status and Error Tracking","title":"mirai - OpenTelemetry","text":"daemon eval spans automatically track operation success failure. Status Values: 'ok' 'unset' - successful completion 'error' description 'miraiError' - error failure 'error' description 'miraiInterrupt' - interrupted","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"monitoring-and-observability","dir":"Articles","previous_headings":"","what":"5. Monitoring and Observability","title":"mirai - OpenTelemetry","text":"OpenTelemetry spans provide rich observability mirai operations. Performance Monitoring: Track task execution times (submission completion) Monitor daemon utilization load balancing Identify distributed computation bottlenecks Error Analysis: Correlate errors specific tasks daemons Track error rates across operation types Debug distributed environment issues Distributed Tracing: Follow task execution across network boundaries Understand complete async operation lifecycles Correlate client-side requests server-side execution","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v05-opentelemetry.html","id":"integration-with-observability-platforms","dir":"Articles","previous_headings":"","what":"6. Integration with Observability Platforms","title":"mirai - OpenTelemetry","text":"mirai’s OpenTelemetry implementation works seamlessly compatible observability platform: Grafana Pydantic Logfire Jaeger listed https://otelsdk.r-lib.org/reference/collecting.html tracer name org.r-lib.mirai enables easy filtering identification mirai-related traces.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v06-packages.html","id":"developer-interfaces","dir":"Articles","previous_headings":"","what":"1. Developer Interfaces","title":"mirai - For Package Authors","text":"mirai provides functions package authors: require_daemons() - errors prompts users set daemons already set (clickable function link cli package available) daemons_set() - detects daemons set on_daemon() - detects code runs daemon (within mirai() call) register_serial() - registers custom serialization functions, automatically available subsequent daemons() calls nextget() - queries compute profile values like ‘url’ (see function documentation). Note: specifically-documented values supported interfaces.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v06-packages.html","id":"guidance","dir":"Articles","previous_headings":"","what":"2. Guidance","title":"mirai - For Package Authors","text":"mirai supports transparent, inter-operable package use. relying global options environment variables minimizes conflicts packages. Important points: Leave daemons() settings end-users. package author, assume mirai run whatever resources users available. Don’t anticipate whether users run code locally, distributed, mixed. Point mirai::daemons() documentation re-export daemons() convenience Exception: Can provide synchronous fallback users haven’t set daemons: Exceptional case: Use daemons(n = 1, dispatcher = FALSE, .compute = ...) single dedicated daemon unique .compute value. Example: logger::appender_async() logger’s ‘namespace’ maps mirai’s ‘compute profile’. Don’t use status() programmatically. interface may change. Use info() instead. status()$daemons, use nextget(\"url\") Use info() programmatically name, position. Index element name (e.g., info()[[\"cumulative\"]]) position (e.g., info()[[2]]) case values added later. Use official test functions mirai state. Use unresolved(), is_error_value(), is_mirai_error(), is_mirai_interrupt(). Don’t rely implementation characteristics (e.g., logical NA ‘unresolvedValue’) may change CRAN package rules: Use one daemon dispatcher = FALSE (stays within 2-core limit) Always reset daemons(0) end examples/test files, sleep least 1 second ensure proper process exit Never modify asyncdial autoexit defaults daemon() (functions passing arguments like daemons()). ensures processes exit host process.","code":"with(if (!daemons_set()) daemons(sync = TRUE), {   mirai_map(...) })"},{"path":"https://mirai.r-lib.org/dev/articles/v07-questions.html","id":"migration-from-future_promise","dir":"Articles","previous_headings":"","what":"1. Migration from future_promise()","title":"mirai - Community FAQs","text":"Translating Shiny ExtendedTask async code promises::future_promise() mirai straightforward. future_promise() exists future(...) alone isn’t always async - blocks parallel processes run . mirai() built async framework, use directly place future_promise(). Globals: future_promise() default infers required global variables. code depended , pass variables explicitly via ... mirai(). mirai requires self-contained expressions variables helper functions explicitly supplied. code used globals argument, pass directly .args mirai() (’s named list). Always pass globals explicitly. matches behaviour multi-process parallelism suited programmatic use. Automatic globals detection creates imperfect abstraction leading unpredictable edge cases slower operation sending unnecessary data daemons. Explicitly passing variables ensures reliable, transparent behaviour. Capture globals using environment(): mirai() accepts environment passed ... .args. useful Shiny ExtendedTask invoked arguments. Using mirai::mirai({...}, environment()) automatically captures variables provided invoke method. See Shiny vignette examples. Special Case: ...: Shiny app may used future_promise() code similar following within server component: equivalent mirai() achieved : Note environment() captures ... ’s used within mirai expression.","code":"func <- function(x, y){   Sys.sleep(y)   runif(x) }  task <- ExtendedTask$new(   function(...) future_promise(func(...)) ) |> bind_task_button(\"btn\")  observeEvent(input$btn, task$invoke(input$n, input$delay)) task <- ExtendedTask$new(   function(...) mirai(func(...), func = func, .args = environment()) ) |> bind_task_button(\"btn\")"},{"path":"https://mirai.r-lib.org/dev/articles/v07-questions.html","id":"setting-the-random-seed","dir":"Articles","previous_headings":"","what":"2. Setting the random seed","title":"mirai - Community FAQs","text":"example may seem counter-intuitive: default ‘cleanup’ settings daemon ensure global environment variables don’t carry subsequent runs. can assumed include .Random.seed. Random seed changes persist mirai uses L’Ecuyer CMRG streams parallel-safe random numbers. Streams entry points pseudo-random number line, far apart ensure independent random results across daemons. random seed isn’t reset mirai call - ensures random draws continue along stream, maintaining desired statistical properties regardless many draws occur per call. Set random seed host process creating daemons, daemon. numerical reproducibility, set seed argument daemons() (see Random Number Generation reference vignette).","code":"library(mirai) daemons(4)  vec <- 1:3 vec2 <- 4:6  # Returns different values: good mirai_map(list(vec, vec2), \\(x) rnorm(x))[] #> [[1]] #> [1]  0.001644678 -1.187782046 -0.297140635 #>  #> [[2]] #> [1] -0.7211057 -0.8825230 -0.9686437  # Set the seed in the function mirai_map(list(vec, vec2), \\(x) {   set.seed(123)   rnorm(x) })[] #> [[1]] #> [1] -0.9685927  0.7061091  1.4890213 #>  #> [[2]] #> [1] -0.9685927  0.7061091  1.4890213  # Do not set the seed in the function: still identical results? mirai_map(list(vec, vec2), \\(x) rnorm(x))[] #> [[1]] #> [1] -1.8150926  0.3304096 -1.1421557 #>  #> [[2]] #> [1] -1.8150926  0.3304096 -1.1421557  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/articles/v07-questions.html","id":"accessing-package-functions-during-development","dir":"Articles","previous_headings":"","what":"3. Accessing package functions during development","title":"mirai - Community FAQs","text":"mirai call usually requires package-namespaced functions. However, development packages often loaded dynamically devtools::load_all() pkgload::load_all() quick iteration. Use everywhere() call devtools::load_all() (local) daemons. ’ll access functions host session subsequent mirai() calls.","code":""},{"path":"https://mirai.r-lib.org/dev/articles/v07-questions.html","id":"why-does-mirai-take-time-when-its-meant-to-return-immediately","dir":"Articles","previous_headings":"","what":"4. Why does mirai() take time when it’s meant to return immediately?","title":"mirai - Community FAQs","text":"mirai() call returns almost instantaneously, Shiny ExtendedTask. reason takes time passing large objects requiring serialization parallel process. careful passing functions environments mirai() via ... .args. Functions include closure (enclosing environment), environments include parent environments. may passing intended. Use lobstr::obj_size() lobstr package check actual object size (accurate base R’s object.size). Mitigation large objects: Functions: Use carrier::crate() carrier package (used purrr). ensures necessary components ‘crated’ function. crate existing function, use anonymous function (supplying anything required fn via ...): Environments: Consider parent.env(e) <- emptyenv(). required R6 classes (already isolated default). Environments R6 classes may contain unnecessary items parallel process - consider passing individual members (env$x, env$y) rather entire object (env).","code":"func <- carrier::crate(\\(x) fn(x), fn = fn)"},{"path":"https://mirai.r-lib.org/dev/articles/v07-questions.html","id":"creating-daemons-on-demand-or-shutting-down-idle-daemons","dir":"Articles","previous_headings":"","what":"5. Creating daemons on-demand or shutting down idle daemons","title":"mirai - Community FAQs","text":"Setting daemons separate launching (deploying) . set daemons local use: local /remote machines: creates ‘base station’ listening incoming daemon connections. launch (deploy) daemon: flexible scaling , specify one arguments ... launch_local() launch_remote(). Supply initial daemons() call apply default launches: maxtasks: Integer number tasks perform exiting idletime: Milliseconds idle time exiting walltime: Milliseconds soft wall time exiting (least amount, possibly - forcible timeout mid-task) launch daemon one task : enables -demand HPC cluster jobs via cluster_config() without persistent daemons. Note: incur latency costs job launch time.","code":"daemons(url = local_url()) daemons(url = host_url()) launch_local() launch_remote(remote = ssh_config(\"ssh://servername\")) # or cluster_config() launch_remote(remote = ssh_config(\"ssh://servername\"), maxtasks = 1L)"},{"path":"https://mirai.r-lib.org/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Charlie Gao. Author, maintainer. Joe Cheng. Contributor. . Copyright holder, funder. Hibiki AI Limited. Copyright holder.","code":""},{"path":"https://mirai.r-lib.org/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gao C (2025). mirai: Minimalist Async Evaluation Framework R. R package version 2.5.2.9000, https://doi.org/10.5281/zenodo.7912722.","code":"@Manual{,   title = {mirai: Minimalist Async Evaluation Framework for R},   author = {Charlie Gao},   year = {2025},   note = {R package version 2.5.2.9000},   url = {https://doi.org/10.5281/zenodo.7912722}, }"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/index.html","id":"ミライ","dir":"","previous_headings":"","what":"ミライ","title":"Minimalist Async Evaluation Framework for R","text":"みらい 未来  Minimalist Async Evaluation Framework R → Run R code parallel keeping session free → Scale seamlessly laptop cloud servers HPC clusters → Automate actions soon tasks complete","code":""},{"path":"https://mirai.r-lib.org/dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Minimalist Async Evaluation Framework for R","text":"","code":"install.packages(\"mirai\")"},{"path":"https://mirai.r-lib.org/dev/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Minimalist Async Evaluation Framework for R","text":"mirai() evaluates R expression asynchronously parallel process. daemons() sets persistent background processes parallel computations.","code":"library(mirai) daemons(5)  m <- mirai({   Sys.sleep(1)   100 + 42 })  mp <- mirai_map(1:9, \\(x) {   Sys.sleep(1)   x^2 })  m #> < mirai [] > m[] #> [1] 142  mp #> < mirai map [4/9] > mp[.flat] #> [1]  1  4  9 16 25 36 49 64 81  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/index.html","id":"design-philosophy","dir":"","previous_headings":"","what":"Design Philosophy","title":"Minimalist Async Evaluation Framework for R","text":"→ Dynamic Architecture Inverted topology, daemons connect host, enables true dynamic scaling Optimal load balancing efficient FIFO dispatcher scheduling Event-driven promises complete zero latency (polling overhead) → Modern Foundation Built NNG via nanonext, scales reliably millions tasks / thousands processes High performance, round-trip times measured microseconds, milliseconds Native support IPC, TCP, zero-config TLS automatic certificate generation → Production First Clear evaluation model explicit dependencies prevents surprises hidden state Serialization support cross-language data formats (torch tensors, Arrow tables) OpenTelemetry integration observability across distributed processes → Deploy Everywhere Local, network / cloud (via SSH, SSH tunnelling) HPC (via Slurm, SGE, PBS, LSF) Modular compute profiles direct tasks suitable resources Combine local, remote, HPC resources single compute profile","code":""},{"path":"https://mirai.r-lib.org/dev/index.html","id":"powers-the-r-ecosystem","dir":"","previous_headings":"","what":"Powers the R Ecosystem","title":"Minimalist Async Evaluation Framework for R","text":"mirai serves foundation asynchronous, parallel distributed computing R ecosystem.   first official alternative communications backend R, ‘MIRAI’ parallel cluster, feature request R-Core.   Powers parallel map purrr, core tidyverse package.   Primary async backend Shiny full ExtendedTask support.   Built-async evaluator enabling @async tag plumber2.   Core parallel processing infrastructure provider tidymodels.   Seamless use torch tensors, models optimizers across parallel processes.   Query databases ADBC connections natively Arrow data format.   R Polars leverages mirai’s serialization registration mechanism transparent use Polars objects.   Targets uses crew default high-performance computing backend. Crew distributed worker launcher extending mirai different computing platforms.","code":""},{"path":"https://mirai.r-lib.org/dev/index.html","id":"acknowledgements","dir":"","previous_headings":"","what":"Acknowledgements","title":"Minimalist Async Evaluation Framework for R","text":"Landau instrumental shaping development package, initiating original request persistent daemons, orchestrating robustness testing high performance computing requirements crew targets. Joe Cheng integrating ‘promises’ method work seamlessly within Shiny, prototyping event-driven promises. Luke Tierney R Core, discussion L’Ecuyer-CMRG streams ensure statistical independence parallel processing, reviewing mirai’s implementation first ‘alternative communications backend R’. Travers Ching novel idea extending original custom serialization support package. Hadley Wickham, Henrik Bengtsson, Daniel Falbel, Kirill Müller many deep insights discussions.","code":""},{"path":"https://mirai.r-lib.org/dev/index.html","id":"links","dir":"","previous_headings":"","what":"Links","title":"Minimalist Async Evaluation Framework for R","text":"mirai | nanonext | CRAN HPC Task View – Please note project released Contributor Code Conduct. participating project agree abide terms.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai.html","id":null,"dir":"Reference","previous_headings":"","what":"Make mirai Promise — as.promise.mirai","title":"Make mirai Promise — as.promise.mirai","text":"Creates 'promise' 'mirai'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make mirai Promise — as.promise.mirai","text":"","code":"# S3 method for class 'mirai' as.promise(x)"},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make mirai Promise — as.promise.mirai","text":"x object class 'mirai'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make mirai Promise — as.promise.mirai","text":"'promise' object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make mirai Promise — as.promise.mirai","text":"function S3 method generic .promise() class 'mirai'. Requires promises package. Allows 'mirai' used promise pipe %...>%, schedules function run upon resolution 'mirai'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make mirai Promise — as.promise.mirai","text":"","code":"if (FALSE) { # interactive() && requireNamespace(\"promises\", quietly = TRUE) library(promises)  p <- as.promise(mirai(\"example\")) print(p) is.promise(p)  p2 <- mirai(\"completed\") %...>% identity() p2$then(cat) is.promise(p2) }"},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Make mirai_map Promise — as.promise.mirai_map","title":"Make mirai_map Promise — as.promise.mirai_map","text":"Creates 'promise' 'mirai_map'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make mirai_map Promise — as.promise.mirai_map","text":"","code":"# S3 method for class 'mirai_map' as.promise(x)"},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make mirai_map Promise — as.promise.mirai_map","text":"x object class 'mirai_map'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make mirai_map Promise — as.promise.mirai_map","text":"'promise' object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai_map.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make mirai_map Promise — as.promise.mirai_map","text":"function S3 method generic .promise() class 'mirai_map'. Requires promises package. Allows 'mirai_map' used promise pipe %...>%, schedules function run upon resolution entire 'mirai_map'. implementation internally uses promises::promise_all(). promises successful, returned promise resolve list promise values; promise fails, first error encountered used reject returned promise.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/as.promise.mirai_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make mirai_map Promise — as.promise.mirai_map","text":"","code":"if (FALSE) { # interactive() && requireNamespace(\"promises\", quietly = TRUE) library(promises)  with(daemons(1), {   mp <- mirai_map(1:3, function(x) { Sys.sleep(1); x })   p <- as.promise(mp)   print(p)   p %...>% print   mp[.flat] }) }"},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai (Call Value) — call_mirai","title":"mirai (Call Value) — call_mirai","text":"Waits 'mirai' resolve still progress, stores value $data, returns 'mirai' object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mirai (Call Value) — call_mirai","text":"","code":"call_mirai(x)"},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mirai (Call Value) — call_mirai","text":"x 'mirai' object, list 'mirai' objects.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mirai (Call Value) — call_mirai","text":"passed object (invisibly). 'mirai', retrieved value stored $data.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mirai (Call Value) — call_mirai","text":"Accepts list 'mirai' objects, returned mirai_map(), well individual 'mirai'. Waits asynchronous operation(s) complete still progress, blocking user-interruptible. x[] may also used wait return value mirai x, equivalent call_mirai(x)$data.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":"alternatively","dir":"Reference","previous_headings":"","what":"Alternatively","title":"mirai (Call Value) — call_mirai","text":"value 'mirai' may accessed time $data, yet resolve, 'unresolved' logical NA returned instead. Using unresolved() 'mirai' returns TRUE yet resolve FALSE otherwise. suitable use control flow statements .","code":""},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":"errors","dir":"Reference","previous_headings":"","what":"Errors","title":"mirai (Call Value) — call_mirai","text":"error occurs evaluation, error message returned character string class 'miraiError' 'errorValue'. is_mirai_error() may used test . elements original condition accessible via $ error object. stack trace comprising list calls also available $stack.trace, original condition classes $condition.class. daemon crashes terminates unexpectedly evaluation, 'errorValue' 19 (Connection reset) returned. is_error_value() tests error conditions including 'mirai' errors, interrupts, timeouts.","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/call_mirai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"mirai (Call Value) — call_mirai","text":"","code":"if (FALSE) { # interactive() # using call_mirai() df1 <- data.frame(a = 1, b = 2) df2 <- data.frame(a = 3, b = 1) m <- mirai(as.matrix(rbind(df1, df2)), df1 = df1, df2 = df2, .timeout = 1000) call_mirai(m)$data  # using unresolved() m <- mirai(   {     res <- rnorm(n)     res / rev(res)   },   n = 1e6 ) while (unresolved(m)) {   cat(\"unresolved\\n\")   Sys.sleep(0.1) } str(m$data) }"},{"path":"https://mirai.r-lib.org/dev/reference/cluster_config.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster Remote Launch Configuration — cluster_config","title":"Cluster Remote Launch Configuration — cluster_config","text":"Generates remote configuration launching daemons using HPC cluster resource manager Slurm sbatch, SGE Torque/PBS qsub LSF bsub.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/cluster_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster Remote Launch Configuration — cluster_config","text":"","code":"cluster_config(command = \"sbatch\", options = \"\", rscript = \"Rscript\")"},{"path":"https://mirai.r-lib.org/dev/reference/cluster_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster Remote Launch Configuration — cluster_config","text":"command filename executable e.g. \"sbatch\" Slurm. Replace \"qsub\" SGE / Torque / PBS, \"bsub\" LSF. See examples . options options supplied inside script file passed command, e.g. \"#SBATCH –mem=16G\", separated new line. See examples .  shell commands e.g. change working directory may also included.  certain setups, \"module load R\" final line required, example \"module load R/4.5.0\" specific R version.  avoidance doubt, initial shebang line \"#!/bin/bash\" required. rscript filename R executable. Use full path Rscript executable remote machine necessary. launching Windows, \"Rscript\" replaced \"Rscript.exe\".","code":""},{"path":"https://mirai.r-lib.org/dev/reference/cluster_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster Remote Launch Configuration — cluster_config","text":"list required format supplied remote argument daemons() launch_remote().","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/cluster_config.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cluster Remote Launch Configuration — cluster_config","text":"","code":"# Slurm Config: cluster_config(   command = \"sbatch\",   options = \"#SBATCH --job-name=mirai              #SBATCH --mem=16G              #SBATCH --output=job.out              module load R/4.5.0\",   rscript = file.path(R.home(\"bin\"), \"Rscript\") ) #> $command #> [1] \"/bin/sh\" #>  #> $args #> [1] \"sbatch<<'EOF'\\n#!/bin/sh\\n#SBATCH --job-name=mirai\\n#SBATCH --mem=16G\\n#SBATCH --output=job.out\\nmodule load R/4.5.0\\n\" #> [2] \".\"                                                                                                                      #> [3] \"\\nEOF\"                                                                                                                  #>  #> $rscript #> [1] \"/opt/R/4.5.2/lib/R/bin/Rscript\" #>  #> $quote #> NULL #>   # SGE Config: cluster_config(   command = \"qsub\",   options = \"#$ -N mirai              #$ -l mem_free=16G              #$ -o job.out              module load R/4.5.0\",   rscript = file.path(R.home(\"bin\"), \"Rscript\") ) #> $command #> [1] \"/bin/sh\" #>  #> $args #> [1] \"qsub<<'EOF'\\n#!/bin/sh\\n#$ -N mirai\\n#$ -l mem_free=16G\\n#$ -o job.out\\nmodule load R/4.5.0\\n\" #> [2] \".\"                                                                                             #> [3] \"\\nEOF\"                                                                                         #>  #> $rscript #> [1] \"/opt/R/4.5.2/lib/R/bin/Rscript\" #>  #> $quote #> NULL #>   # Torque/PBS Config: cluster_config(   command = \"qsub\",   options = \"#PBS -N mirai              #PBS -l mem=16gb              #PBS -o job.out              module load R/4.5.0\",   rscript = file.path(R.home(\"bin\"), \"Rscript\") ) #> $command #> [1] \"/bin/sh\" #>  #> $args #> [1] \"qsub<<'EOF'\\n#!/bin/sh\\n#PBS -N mirai\\n#PBS -l mem=16gb\\n#PBS -o job.out\\nmodule load R/4.5.0\\n\" #> [2] \".\"                                                                                               #> [3] \"\\nEOF\"                                                                                           #>  #> $rscript #> [1] \"/opt/R/4.5.2/lib/R/bin/Rscript\" #>  #> $quote #> NULL #>   # LSF Config: cluster_config(   command = \"bsub\",   options = \"#BSUB -J mirai              #BSUB -M 16000              #BSUB -o job.out              module load R/4.5.0\",   rscript = file.path(R.home(\"bin\"), \"Rscript\") ) #> $command #> [1] \"/bin/sh\" #>  #> $args #> [1] \"bsub<<'EOF'\\n#!/bin/sh\\n#BSUB -J mirai\\n#BSUB -M 16000\\n#BSUB -o job.out\\nmodule load R/4.5.0\\n\" #> [2] \".\"                                                                                               #> [3] \"\\nEOF\"                                                                                           #>  #> $rscript #> [1] \"/opt/R/4.5.2/lib/R/bin/Rscript\" #>  #> $quote #> NULL #>   if (FALSE) { # \\dontrun{  # Launch 2 daemons using the Slurm sbatch defaults: daemons(n = 2, url = host_url(), remote = cluster_config()) } # }"},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai (Collect Value) — collect_mirai","title":"mirai (Collect Value) — collect_mirai","text":"Waits 'mirai' resolve still progress, returns value directly. efficient version equivalent call_mirai(x)$data.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mirai (Collect Value) — collect_mirai","text":"","code":"collect_mirai(x, options = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mirai (Collect Value) — collect_mirai","text":"x 'mirai' object, list 'mirai' objects. options (x list mirai) character vector comprising combination collection options mirai_map(), \".flat\" c(\".progress\", \".stop\").","code":""},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mirai (Collect Value) — collect_mirai","text":"object (return value 'mirai'), list objects (length x, preserving names).","code":""},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mirai (Collect Value) — collect_mirai","text":"function wait asynchronous operation(s) complete still progress, blocking interruptible. x[] equivalent way wait return value mirai x.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"options","dir":"Reference","previous_headings":"","what":"Options","title":"mirai (Collect Value) — collect_mirai","text":"alternative character vector, list names collection options also accepted. value .progress passed cli progress bar - character value name, list named parameters cli::cli_progress_bar. Examples: c(.stop = TRUE, .progress = \"bar name\") list(.stop = TRUE, .progress = list(name = \"bar\", type = \"tasks\"))","code":""},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"alternatively","dir":"Reference","previous_headings":"","what":"Alternatively","title":"mirai (Collect Value) — collect_mirai","text":"value 'mirai' may accessed time $data, yet resolve, 'unresolved' logical NA returned instead. Using unresolved() 'mirai' returns TRUE yet resolve FALSE otherwise. suitable use control flow statements .","code":""},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"errors","dir":"Reference","previous_headings":"","what":"Errors","title":"mirai (Collect Value) — collect_mirai","text":"error occurs evaluation, error message returned character string class 'miraiError' 'errorValue'. is_mirai_error() may used test . elements original condition accessible via $ error object. stack trace comprising list calls also available $stack.trace, original condition classes $condition.class. daemon crashes terminates unexpectedly evaluation, 'errorValue' 19 (Connection reset) returned. is_error_value() tests error conditions including 'mirai' errors, interrupts, timeouts.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/collect_mirai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"mirai (Collect Value) — collect_mirai","text":"","code":"if (FALSE) { # interactive() # using collect_mirai() df1 <- data.frame(a = 1, b = 2) df2 <- data.frame(a = 3, b = 1) m <- mirai(as.matrix(rbind(df1, df2)), df1 = df1, df2 = df2, .timeout = 1000) collect_mirai(m)  # using x[] m[]  # mirai_map with collection options daemons(1, dispatcher = FALSE) m <- mirai_map(1:3, rnorm) collect_mirai(m, c(\".flat\", \".progress\")) daemons(0) }"},{"path":"https://mirai.r-lib.org/dev/reference/daemon.html","id":null,"dir":"Reference","previous_headings":"","what":"Daemon Instance — daemon","title":"Daemon Instance — daemon","text":"Starts execution daemon receive mirai() requests. Awaits data, evaluates expression environment containing supplied data, returns value host caller. Daemon settings may controlled daemons() function need invoked directly, unless deploying manually remote resources.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Daemon Instance — daemon","text":"","code":"daemon(   url,   dispatcher = TRUE,   ...,   asyncdial = FALSE,   autoexit = TRUE,   cleanup = TRUE,   output = FALSE,   idletime = Inf,   walltime = Inf,   maxtasks = Inf,   tlscert = NULL,   rs = NULL )"},{"path":"https://mirai.r-lib.org/dev/reference/daemon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Daemon Instance — daemon","text":"url character host dispatcher URL dial , including port connect , e.g. 'tcp://hostname:5555' 'tls+tcp://10.75.32.70:5555'. dispatcher logical value, set TRUE using dispatcher FALSE otherwise. ... reserved, currently used. asyncdial whether perform dials asynchronously. default FALSE error connection immediately possible (instance daemons() yet called host, specified port open etc.). Specifying TRUE continues retrying (indefinitely) immediately successful, resilient can mask potential connection issues. autoexit logical value, whether daemon exit automatically socket connection ends. default, process ends immediately host process ends. Supply NA daemon complete tasks progress exiting (see 'Persistence' section ). cleanup logical value, whether perform cleanup global environment restore attached packages options initial state evaluation. output logical value, output generated stdout / stderr TRUE, else discard FALSE. Specify TRUE ... argument daemons() launch_local() provide redirection output host process (applicable local daemons). idletime integer milliseconds maximum time wait task (idle time) exiting. walltime integer milliseconds soft walltime (time limit) .e. minimum amount real time elapsed exiting. maxtasks integer maximum number tasks execute (task limit) exiting. tlscert required secure TLS connections 'tls+tcp://'. Either character path file containing X.509 certificate(s) PEM format, comprising certificate authority certificate chain starting TLS certificate ending CA certificate, length 2 character vector comprising () certificate authority certificate chain (ii) empty string \"\". rs initial value .Random.seed. set automatically using L'Ecuyer-CMRG RNG streams generated host process applicable, independently supplied.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Daemon Instance — daemon","text":"Invisibly, integer exit code: 0L normal termination, positive value self-imposed limit reached: 1L (idletime), 2L (walltime), 3L (maxtasks).","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemon.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Daemon Instance — daemon","text":"network topology daemons dial host dispatcher, listens url address. way, network resources may added removed dynamically host dispatcher automatically distributes tasks available daemons.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemon.html","id":"persistence","dir":"Reference","previous_headings":"","what":"Persistence","title":"Daemon Instance — daemon","text":"autoexit argument governs persistence settings daemon. default TRUE ensures exits soon socket connection host process drops. 200ms grace period allows daemon process exit normally, forcefully terminated. Supplying NA ensures daemon always exits cleanly socket connection host drops. means can temporarily outlive connection, complete task currently progress. can useful daemon performing side effect writing files disk, result required back host process. Setting FALSE allows daemon persist indefinitely even longer socket connection. allows host session end new session connect URL daemon dialed . Daemons must terminated daemons(NULL) case instead daemons(0). sends explicit exit signals connected daemons.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":null,"dir":"Reference","previous_headings":"","what":"Daemons (Set Persistent Processes) — daemons","title":"Daemons (Set Persistent Processes) — daemons","text":"Set daemons, persistent background processes, receive mirai() requests. Specify n create daemons local machine. Specify url receive connections remote daemons (distributed computing across network). Specify remote optionally launch remote daemons via remote configuration. Dispatcher (enabled default) ensures optimal scheduling.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Daemons (Set Persistent Processes) — daemons","text":"","code":"daemons(   n,   url = NULL,   remote = NULL,   dispatcher = TRUE,   ...,   sync = FALSE,   seed = NULL,   serial = NULL,   tls = NULL,   pass = NULL,   .compute = NULL )"},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Daemons (Set Persistent Processes) — daemons","text":"n integer number daemons launch. url specified, character string comprising URL listen remote daemons, including port accepting incoming connections, e.g. 'tcp://hostname:5555' 'tcp://10.75.32.70:5555'. Specify URL scheme 'tls+tcp://' use secure TLS connections (details see Distributed Computing section ). Auxiliary function host_url() may used construct valid host URL. remote (required launching remote daemons) configuration generated ssh_config(), cluster_config(), remote_config(). dispatcher logical value, whether use dispatcher. Dispatcher runs separate process ensure optimal scheduling, normally kept (details see Dispatcher section ). ... (optional) additional arguments passed daemon() launching daemons. include asyncdial, autoexit, cleanup, output, maxtasks, idletime, walltime tlscert. sync logical value, whether evaluate mirai synchronously current process. Setting TRUE substantially changes behaviour mirai causing evaluated immediately creation. facilitates testing debugging, e.g. via interactive browser(). case, arguments seed .compute disregarded. seed (optional) default NULL initializes L'Ecuyer-CMRG RNG streams daemon, base R's parallel package. Results statistically-sound, although generally non-reproducible, tasks sent daemons may non-deterministic, also depends number daemons.  (experimental) supply integer value instead initialize L'Ecuyer-CMRG RNG stream compute profile. advanced mirai evaluation, hence allowing reproducible results, random seed always associated given mirai, independently evaluated. serial (optional, requires dispatcher) configuration created serial_config() register serialization unserialization functions normally non-exportable reference objects, Arrow Tables torch tensors. NULL, configurations registered register_serial() automatically applied. tls (optional secure TLS connections) supplied, zero-configuration single-use keys certificates automatically generated required. supplied, either character path file containing PEM-encoded TLS certificate associated private key (may contain additional certificates leading validation chain, TLS certificate first), length 2 character vector comprising () TLS certificate (optionally certificate chain) (ii) associated private key. pass (required private key supplied tls encrypted password) security, provided function returns value, rather directly. .compute character value compute profile use (independent set daemons), NULL use 'default' profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Daemons (Set Persistent Processes) — daemons","text":"Invisibly, logical TRUE creating daemons FALSE resetting.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Daemons (Set Persistent Processes) — daemons","text":"Use daemons(0) reset daemon connections: connected daemons /dispatchers exit automatically. yet unresolved 'mirai' return 'errorValue' 19 (Connection reset). mirai() reverts default behaviour creating new background process request. host session ends, connected dispatcher daemon processes automatically exit soon connections dropped. Calling daemons() implicitly resets existing daemons compute profile daemons(0). Instead, launch_local() launch_remote() may used add daemons time without resetting daemons.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"local-daemons","dir":"Reference","previous_headings":"","what":"Local Daemons","title":"Daemons (Set Persistent Processes) — daemons","text":"Setting daemons, persistent background processes, typically efficient removes need , overhead , creating new processes mirai evaluation. also provides control total number processes one time. Supply argument n set number daemons. New background daemon() processes automatically launched local machine connecting back host process, either directly via dispatcher.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"dispatcher","dir":"Reference","previous_headings":"","what":"Dispatcher","title":"Daemons (Set Persistent Processes) — daemons","text":"default dispatcher = TRUE launches background process running dispatcher(). Dispatcher connects daemons behalf host, queues tasks, ensures optimal FIFO scheduling. Dispatcher also enables () mirai cancellation using stop_mirai() using .timeout argument mirai(), (ii) use custom serialization configurations. Specifying dispatcher = FALSE, daemons connect directly host tasks distributed round-robin fashion, tasks queued daemon. Optimal scheduling guaranteed , depending duration tasks, can queued one daemon others remain idle. However, solution resource-light, suited similar-length tasks, concurrent tasks typically exceed available daemons.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"distributed-computing","dir":"Reference","previous_headings":"","what":"Distributed Computing","title":"Daemons (Set Persistent Processes) — daemons","text":"Specify url character string allow tasks distributed across network (n required case also providing launch configuration remote). host / dispatcher listens URL, utilising single port, daemon() processes dial URL. Host / dispatcher automatically adjusts number daemons actually connected, allowing dynamic upscaling / downscaling. URL 'tcp://' scheme, 'tcp://10.75.32.70:5555'. Switching URL scheme 'tls+tcp://' automatically upgrades connection use TLS. auxiliary function host_url() may used construct valid host URL based computer's IP address. IPv6 addresses also supported must enclosed square brackets [] avoid confusion final colon separating port. example, port 5555 IPv6 loopback address ::1 specified 'tcp://[::1]:5555'. Specifying wildcard value zero port number e.g. 'tcp://[::1]:0' automatically assign free ephemeral port. Use status() inspect actual assigned port time. Specify remote call ssh_config(), cluster_config() remote_config() launch (programatically deploy) daemons remote machines, dial back url. launching daemons, launch_remote() may used generate shell commands manual deployment.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"compute-profiles","dir":"Reference","previous_headings":"","what":"Compute Profiles","title":"Daemons (Set Persistent Processes) — daemons","text":"NULL, \"default\" compute profile used. Providing character value .compute creates new compute profile name specified. compute profile retains daemons settings, may operated independently . usage examples follow: local / remote daemons may set host URL specifying .compute \"remote\", creates new compute profile. Subsequent mirai() calls may sent local computation specifying .compute argument, remote computation connected daemons specifying .compute argument \"remote\". cpu / gpu tasks may require access different types daemon, GPUs. case, daemons() may called set host URLs CPU-daemons GPUs, specifying .compute argument \"cpu\" \"gpu\" respectively. supplying .compute argument subsequent mirai() calls, tasks may sent either cpu gpu daemons appropriate. Note: actions resetting daemons via daemons(0) carried desired .compute argument specified.","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/daemons.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Daemons (Set Persistent Processes) — daemons","text":"","code":"if (FALSE) { # interactive() # Create 2 local daemons (using dispatcher) daemons(2) status() # Reset to zero daemons(0)  # Create 2 local daemons (not using dispatcher) daemons(2, dispatcher = FALSE) status() # Reset to zero daemons(0)  # Set up dispatcher accepting TLS over TCP connections daemons(url = host_url(tls = TRUE)) status() # Reset to zero daemons(0)  # Set host URL for remote daemons to dial into daemons(url = host_url(), dispatcher = FALSE) status() # Reset to zero daemons(0)  # Use with() to evaluate with daemons for the duration of the expression with(   daemons(2),   {     m1 <- mirai(Sys.getpid())     m2 <- mirai(Sys.getpid())     cat(m1[], m2[], \"\\n\")   } )  if (FALSE) { # \\dontrun{  # Launch daemons on remotes 'nodeone' and 'nodetwo' using SSH # connecting back directly to the host URL over a TLS connection: daemons(   url = host_url(tls = TRUE),   remote = ssh_config(c('ssh://nodeone', 'ssh://nodetwo')) )  # Launch 4 daemons on the remote machine 10.75.32.90 using SSH tunnelling: daemons(   n = 4,   url = local_url(tcp = TRUE),   remote = ssh_config('ssh://10.75.32.90', tunnel = TRUE) )  } # } } # Synchronous mode # mirai are run in the current process - useful for testing and debugging daemons(sync = TRUE) m <- mirai(Sys.getpid()) daemons(0) m[] #> [1] 6334  # Synchronous mode restricted to a specific compute profile daemons(sync = TRUE, .compute = \"sync\") with_daemons(\"sync\", {   m <- mirai(Sys.getpid()) }) daemons(0, .compute = \"sync\") m[] #> [1] 6334"},{"path":"https://mirai.r-lib.org/dev/reference/daemons_set.html","id":null,"dir":"Reference","previous_headings":"","what":"Query if Daemons are Set — daemons_set","title":"Query if Daemons are Set — daemons_set","text":"Returns logical value, whether daemons set given compute profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons_set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query if Daemons are Set — daemons_set","text":"","code":"daemons_set(.compute = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/daemons_set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Query if Daemons are Set — daemons_set","text":".compute character value compute profile use (independent set daemons), NULL use 'default' profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons_set.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query if Daemons are Set — daemons_set","text":"Logical TRUE FALSE.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/daemons_set.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Query if Daemons are Set — daemons_set","text":"","code":"daemons_set() #> [1] FALSE daemons(sync = TRUE) daemons_set() #> [1] TRUE daemons(0)"},{"path":"https://mirai.r-lib.org/dev/reference/dispatcher.html","id":null,"dir":"Reference","previous_headings":"","what":"Dispatcher — dispatcher","title":"Dispatcher — dispatcher","text":"Dispatches tasks host daemons processing, using FIFO scheduling, queuing tasks required. Daemon / dispatcher settings controlled daemons() function need called directly.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/dispatcher.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dispatcher — dispatcher","text":"","code":"dispatcher(host, url = NULL, n = 0L, ...)"},{"path":"https://mirai.r-lib.org/dev/reference/dispatcher.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dispatcher — dispatcher","text":"host character URL dispatcher dial , typically IPC address. url character URL dispatcher listen (daemons dial ), including port connect e.g. tcp://hostname:5555' 'tcp://10.75.32.70:5555'. Specify 'tls+tcp://' use secure TLS connections. n specified, integer number daemons launched locally host process. ... (optional) additional arguments passed daemon() launching daemons. include asyncdial, autoexit, cleanup, output, maxtasks, idletime, walltime tlscert.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/dispatcher.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dispatcher — dispatcher","text":"Invisible NULL.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/dispatcher.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dispatcher — dispatcher","text":"network topology dispatcher acts gateway host daemons, ensuring tasks received host dispatched FIFO basis processing. Tasks queued dispatcher ensure tasks sent daemons can begin immediate execution task.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/dot-flat.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai Map Options — .flat","title":"mirai Map Options — .flat","text":"Expressions provided [] method 'mirai_map' objects.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/dot-flat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mirai Map Options — .flat","text":"","code":".flat  .progress  .stop"},{"path":"https://mirai.r-lib.org/dev/reference/dot-flat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"mirai Map Options — .flat","text":"object class bytecode length 1. object class bytecode length 1. object class bytecode length 1.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/dot-flat.html","id":"collection-options","dir":"Reference","previous_headings":"","what":"Collection Options","title":"mirai Map Options — .flat","text":"x[] collects results 'mirai_map' x returns list. wait asynchronous operations complete still progress, blocking user-interruptible. x[.flat] collects flattens map results vector, checking type avoid coercion. Note: errors 'errorValue' returned results differing type. x[.progress] collects map results whilst showing progress bar cli package, installed, completion percentage ETA, else simple text progress indicator. Note: map operation completes quickly progress bar may show . x[.stop] collects map results applying early stopping, stops first failure cancels remaining operations. options may combined manner : x[.stop, .progress] applies early stopping together progress indicator.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/everywhere.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate Everywhere — everywhere","title":"Evaluate Everywhere — everywhere","text":"Evaluate expression 'everywhere' connected daemons specified compute profile - must set prior calling function. Performs operations across daemons loading packages exporting common data. Resultant changes global environment, loaded packages options persisted regardless daemon's cleanup setting.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/everywhere.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate Everywhere — everywhere","text":"","code":"everywhere(.expr, ..., .args = list(), .min = 1L, .compute = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/everywhere.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate Everywhere — everywhere","text":".expr expression evaluate asynchronously (arbitrary length, wrapped { } necessary), else pre-constructed language object. ... (optional) either named arguments (name = value pairs) specifying objects referenced, defined, .expr, environment containing objects. See 'evaluation' section . .args (optional) either named list specifying objects referenced, defined, .expr, environment containing objects. objects remain local evaluation environment opposed supplied ... - see 'evaluation' section . .min (applicable using dispatcher) integer minimum number daemons evaluate expression. synchronization point created, can useful remote daemons, may take time connect. .compute character value compute profile use (independent set daemons), NULL use 'default' profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/everywhere.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate Everywhere — everywhere","text":"'mirai_map' (list 'mirai' objects).","code":""},{"path":"https://mirai.r-lib.org/dev/reference/everywhere.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate Everywhere — everywhere","text":"using dispatcher, function forces synchronization point dispatcher, whereby everywhere() call must evaluated daemons prior subsequent mirai evaluations taking place. Calling everywhere() affect RNG stream mirai calls using reproducible seed value daemons(). allows seed associated mirai call , regardless number daemons actually used evaluate code. Note means code evaluated everywhere() call non-reproducible involve random numbers.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/everywhere.html","id":"evaluation","dir":"Reference","previous_headings":"","what":"Evaluation","title":"Evaluate Everywhere — everywhere","text":"expression .expr evaluated separate R process clean environment (global environment), consisting objects supplied .args, objects passed ... assigned global environment process. evaluation occurs clean environment, undefined objects must supplied ... /.args, including self-defined functions. Functions package use namespaced calls mirai::mirai(), else package loaded beforehand part .expr. evaluation occur global environment, supply objects ... rather .args, e.g. non-local variables helper functions required functions, scoping rules may otherwise prevent found.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/everywhere.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate Everywhere — everywhere","text":"","code":"daemons(sync = TRUE)  # export common data by a super-assignment expression: everywhere(y <<- 3) mirai(y)[] #> [1] 3  # '...' variables are assigned to the global environment # '.expr' may be specified as an empty {} in such cases: everywhere({}, a = 1, b = 2) mirai(a + b - y == 0L)[] #> [1] TRUE  # everywhere() returns a mirai_map object: mp <- everywhere(\"just a normal operation\") mp #> < mirai map [1/1] > mp[.flat] #> [1] \"just a normal operation\" mp <- everywhere(stop(\"everywhere\")) collect_mirai(mp) #> [[1]] #> 'miraiError' chr Error: everywhere #>  daemons(0)  # loading a package on all daemons daemons(sync = TRUE) everywhere(library(parallel)) m <- mirai(\"package:parallel\" %in% search()) m[] #> [1] TRUE daemons(0)"},{"path":"https://mirai.r-lib.org/dev/reference/host_url.html","id":null,"dir":"Reference","previous_headings":"","what":"URL Constructors — host_url","title":"URL Constructors — host_url","text":"host_url() constructs valid host URL (daemons may connect) based computer's IP address. may supplied directly url argument daemons(). local_url() constructs URL suitable local daemons, use SSH tunnelling. may supplied directly url argument daemons().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/host_url.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"URL Constructors — host_url","text":"","code":"host_url(tls = FALSE, port = 0)  local_url(tcp = FALSE, port = 0)"},{"path":"https://mirai.r-lib.org/dev/reference/host_url.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"URL Constructors — host_url","text":"tls logical value whether use TLS. TRUE, scheme used 'tls+tcp://'. port numeric port use. 0 wildcard value automatically assigns free ephemeral port. host_url, port open connections network addresses daemons connecting . local_url, taken account tcp = TRUE. tcp logical value whether use TCP connection. must TRUE use SSH tunnelling.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/host_url.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"URL Constructors — host_url","text":"character vector (comprising valid URL URLs), named host_url().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/host_url.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"URL Constructors — host_url","text":"host_url() return vector URLs multiple network adapters use, named interface name (adapter friendly name Windows). entire vector passed url argument functions daemons(), first URL used. suitable IP addresses detected, computer's hostname used fallback. local_url() generates random URL platform's default inter-process communications transport: abstract Unix domain sockets Linux, Unix domain sockets MacOS, Solaris POSIX platforms, named pipes Windows.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/host_url.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"URL Constructors — host_url","text":"","code":"host_url() #>                 eth0              docker0  #> \"tcp://10.1.0.189:0\" \"tcp://172.17.0.1:0\"  host_url(tls = TRUE) #>                     eth0                  docker0  #> \"tls+tcp://10.1.0.189:0\" \"tls+tcp://172.17.0.1:0\"  host_url(tls = TRUE, port = 5555) #>                        eth0                     docker0  #> \"tls+tcp://10.1.0.189:5555\" \"tls+tcp://172.17.0.1:5555\"   local_url() #> [1] \"abstract://b184dd9b47f00ee0ecfc0090\" local_url(tcp = TRUE) #> [1] \"tcp://127.0.0.1:0\" local_url(tcp = TRUE, port = 5555) #> [1] \"tcp://127.0.0.1:5555\""},{"path":"https://mirai.r-lib.org/dev/reference/info.html","id":null,"dir":"Reference","previous_headings":"","what":"Information Statistics — info","title":"Information Statistics — info","text":"Retrieve statistics specified compute profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information Statistics — info","text":"","code":"info(.compute = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Information Statistics — info","text":".compute character value compute profile use (independent set daemons), NULL use 'default' profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Information Statistics — info","text":"Named integer vector else NULL compute profile yet set .","code":""},{"path":"https://mirai.r-lib.org/dev/reference/info.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Information Statistics — info","text":"returned statistics : Connections: active daemon connections. Cumulative: total daemons ever connected. Awaiting: mirai tasks currently queued execution dispatcher. Executing: mirai tasks currently evaluated daemon. Completed: mirai tasks completed cancelled. non-dispatcher daemons: 'connections' available values NA.","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/info.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Information Statistics — info","text":"","code":"info() #> NULL daemons(sync = TRUE) info() #> connections  cumulative    awaiting   executing   completed  #>           0          NA          NA          NA          NA  daemons(0)"},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai.html","id":null,"dir":"Reference","previous_headings":"","what":"Is mirai / mirai_map — is_mirai","title":"Is mirai / mirai_map — is_mirai","text":"object 'mirai' 'mirai_map'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Is mirai / mirai_map — is_mirai","text":"","code":"is_mirai(x)  is_mirai_map(x)"},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Is mirai / mirai_map — is_mirai","text":"x object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Is mirai / mirai_map — is_mirai","text":"Logical TRUE x class 'mirai' 'mirai_map' respectively, FALSE otherwise.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Is mirai / mirai_map — is_mirai","text":"","code":"if (FALSE) { # interactive() daemons(1, dispatcher = FALSE) df <- data.frame() m <- mirai(as.matrix(df), df = df) is_mirai(m) is_mirai(df)  mp <- mirai_map(1:3, runif) is_mirai_map(mp) is_mirai_map(mp[]) daemons(0) }"},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Error Validators — is_mirai_error","title":"Error Validators — is_mirai_error","text":"Validator functions error value types created mirai.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Error Validators — is_mirai_error","text":"","code":"is_mirai_error(x)  is_mirai_interrupt(x)  is_error_value(x)"},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Error Validators — is_mirai_error","text":"x object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Error Validators — is_mirai_error","text":"Logical value TRUE FALSE.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai_error.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Error Validators — is_mirai_error","text":"object 'miraiError'. execution 'mirai' process fails, error message returned character string class 'miraiError' 'errorValue'. elements original condition accessible via $ error object. stack trace also available $stack.trace. object 'miraiInterrupt'. ongoing 'mirai' sent user interrupt, resolve empty character string classed 'miraiInterrupt' 'errorValue'. object 'errorValue', 'mirai' timeout, 'miraiError' 'miraiInterrupt'. catch-condition includes returned error values.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/is_mirai_error.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Error Validators — is_mirai_error","text":"","code":"if (FALSE) { # interactive() m <- mirai(stop()) call_mirai(m) is_mirai_error(m$data) is_mirai_interrupt(m$data) is_error_value(m$data) m$data$stack.trace  m2 <- mirai(Sys.sleep(1L), .timeout = 100) call_mirai(m2) is_mirai_error(m2$data) is_mirai_interrupt(m2$data) is_error_value(m2$data) }"},{"path":"https://mirai.r-lib.org/dev/reference/launch_local.html","id":null,"dir":"Reference","previous_headings":"","what":"Launch Daemon — launch_local","title":"Launch Daemon — launch_local","text":"Launching daemon much akin launching satellite. way deploy daemon (case) desired machine. executes, connects back host process using communications. launch_local deploys daemon local machine new background Rscript process. launch_remote returns shell command deploying daemons character vector. ssh_config(), cluster_config() remote_config() configuration supplied used launch daemon remote machine.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/launch_local.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Launch Daemon — launch_local","text":"","code":"launch_local(n = 1L, ..., .compute = NULL)  launch_remote(n = 1L, remote = remote_config(), ..., .compute = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/launch_local.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Launch Daemon — launch_local","text":"n integer number daemons. launch_remote , 'miraiCluster' 'miraiNode'. ... (optional) arguments passed daemon(). include asycdial, autoexit, cleanup, output, maxtasks, idletime, walltime. supply override arguments originally provided daemons(), otherwise used instead. .compute character value compute profile use (independent set daemons), NULL use 'default' profile. remote required launching remote daemons, configuration generated ssh_config(), cluster_config(), remote_config(). empty remote_config() perform launches returns shell commands deploying manually remote machines.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/launch_local.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Launch Daemon — launch_local","text":"launch_local: Integer number daemons launched. launch_remote: character vector daemon launch commands, classed 'miraiLaunchCmd'. printed output may copy / pasted directly remote machine.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/launch_local.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Launch Daemon — launch_local","text":"Daemons must already set launchers work. functions may used re-launch daemons exited reaching time task limits. non-dispatcher daemons using default seed strategy, generated command contains argument rs specifying length 7 L'Ecuyer-CMRG random seed supplied daemon. values different time function called.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/launch_local.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Launch Daemon — launch_local","text":"","code":"if (FALSE) { # interactive() daemons(url = host_url(), dispatcher = FALSE) status() launch_local(1L, cleanup = FALSE) launch_remote(1L, cleanup = FALSE) Sys.sleep(1) status() daemons(0)  daemons(url = host_url(tls = TRUE)) status() launch_local(2L, output = TRUE) Sys.sleep(1) status() daemons(0) }"},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Make Mirai Cluster — make_cluster","title":"Make Mirai Cluster — make_cluster","text":"make_cluster creates cluster type 'miraiCluster', may used cluster object function parallel base package parallel::clusterApply() parallel::parLapply(). stop_cluster stops cluster created make_cluster.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make Mirai Cluster — make_cluster","text":"","code":"make_cluster(n, url = NULL, remote = NULL, ...)  stop_cluster(cl)"},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make Mirai Cluster — make_cluster","text":"n integer number nodes (automatically launched local machine unless url supplied). url (specify remote nodes) character URL host remote nodes dial , including port accepting incoming connections, e.g. 'tcp://10.75.37.40:5555'. Specify URL scheme 'tls+tcp://' use secure TLS connections. remote (specify launch remote nodes) remote launch configuration generated ssh_config(), cluster_config() remote_config(). supplied, nodes may deployed manually remote resources. ... additional arguments passed daemons(). cl 'miraiCluster'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make Mirai Cluster — make_cluster","text":"make_cluster: object class 'miraiCluster' 'cluster'. 'miraiCluster' automatically assigned ID n nodes class 'miraiNode'. url supplied remote, shell commands deployment nodes remote resources printed console. stop_cluster: invisible NULL.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make Mirai Cluster — make_cluster","text":"R version 4.5 newer, parallel::makeCluster() specifying type = \"MIRAI\" equivalent function.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Make Mirai Cluster — make_cluster","text":"default behaviour clusters created function designed map closely possible clusters created parallel package. However, ... arguments passed onto daemons() additional customisation desired, although resultant behaviour may always supported.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"remote-nodes","dir":"Reference","previous_headings":"","what":"Remote Nodes","title":"Make Mirai Cluster — make_cluster","text":"Specify url n set host connection remote nodes dial . n defaults one specified. Also specify remote launch nodes using configuration generated remote_config() ssh_config(). case, number nodes inferred configuration provided n disregarded. remote supplied, shell commands deploying nodes manually remote resources automatically printed console. launch_remote() may called time 'miraiCluster' return shell commands deployment nodes, 'miraiNode' return command single node.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"status","dir":"Reference","previous_headings":"","what":"Status","title":"Make Mirai Cluster — make_cluster","text":"Call status() 'miraiCluster' check number currently active connections well host URL.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"errors","dir":"Reference","previous_headings":"","what":"Errors","title":"Make Mirai Cluster — make_cluster","text":"Errors thrown parallel package mechanism one nodes failed (quit unexpectedly). resulting 'errorValue' returned 19 (Connection reset). types error, e.g. evaluation, result usual 'miraiError' returned.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/make_cluster.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make Mirai Cluster — make_cluster","text":"","code":"if (FALSE) { # interactive() cl <- make_cluster(2) cl cl[[1L]]  Sys.sleep(0.5) status(cl)  stop_cluster(cl) }"},{"path":"https://mirai.r-lib.org/dev/reference/mirai-package.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai: Minimalist Async Evaluation Framework for R — mirai-package","title":"mirai: Minimalist Async Evaluation Framework for R — mirai-package","text":"Designed simplicity, 'mirai' evaluates R expression asynchronously, locally distributed network. Built 'nanonext' 'NNG' modern networking concurrency, scales efficiently millions tasks thousands parallel processes. Provides optimal scheduling fast 'IPC', TCP, TLS connections, integrating SSH cluster managers. Implements event-driven promises reactive programming, supports custom serialization cross-language data types.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai-package.html","id":"notes","dir":"Reference","previous_headings":"","what":"Notes","title":"mirai: Minimalist Async Evaluation Framework for R — mirai-package","text":"local mirai requests, default transport inter-process communications platform-dependent: abstract Unix domain sockets Linux, Unix domain sockets MacOS, Solaris POSIX platforms, named pipes Windows. may overriden, desired, specifying 'url' daemons() interface launching daemons using launch_local().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai-package.html","id":"opentelemetry","dir":"Reference","previous_headings":"","what":"OpenTelemetry","title":"mirai: Minimalist Async Evaluation Framework for R — mirai-package","text":"mirai provides comprehensive OpenTelemetry tracing support observing asynchronous operations distributed computation. Please refer OpenTelemetry vignette details: vignette(\"v05-opentelemetry\", package = \"mirai\")","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai-package.html","id":"reference-manual","dir":"Reference","previous_headings":"","what":"Reference Manual","title":"mirai: Minimalist Async Evaluation Framework for R — mirai-package","text":"vignette(\"mirai\", package = \"mirai\")","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/mirai-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"mirai: Minimalist Async Evaluation Framework for R — mirai-package","text":"Maintainer: Charlie Gao charlie.gao@posit.co (ORCID) contributors: Joe Cheng joe@posit.co [contributor] Posit Software, PBC (ROR) [copyright holder, funder] Hibiki AI Limited [copyright holder]","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai (Evaluate Async) — mirai","title":"mirai (Evaluate Async) — mirai","text":"Evaluate expression asynchronously new background R process persistent daemon (local remote). function return immediately 'mirai', resolve evaluated result complete.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mirai (Evaluate Async) — mirai","text":"","code":"mirai(.expr, ..., .args = list(), .timeout = NULL, .compute = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mirai (Evaluate Async) — mirai","text":".expr expression evaluate asynchronously (arbitrary length, wrapped { } necessary), else pre-constructed language object. ... (optional) either named arguments (name = value pairs) specifying objects referenced, defined, .expr, environment containing objects. See 'evaluation' section . .args (optional) either named list specifying objects referenced, defined, .expr, environment containing objects. objects remain local evaluation environment opposed supplied ... - see 'evaluation' section . .timeout integer value milliseconds, NULL timeout. mirai resolve 'errorValue' 5 (timed ) evaluation exceeds limit. .compute character value compute profile use (independent set daemons), NULL use 'default' profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mirai (Evaluate Async) — mirai","text":"'mirai' object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mirai (Evaluate Async) — mirai","text":"function return 'mirai' object immediately. value mirai may accessed time $data, yet resolve, 'unresolved' logical NA returned instead. mirai attribute id, monotonically increasing integer identifier session. unresolved() may used mirai, returning TRUE 'mirai' yet resolve FALSE otherwise. suitable use control flow statements . Alternatively, call (wait ) result, use call_mirai() returned 'mirai'. block result returned. Specify .compute send mirai using specific compute profile (previously created daemons()), otherwise leave \"default\".","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"evaluation","dir":"Reference","previous_headings":"","what":"Evaluation","title":"mirai (Evaluate Async) — mirai","text":"expression .expr evaluated separate R process clean environment (global environment), consisting objects supplied .args, objects passed ... assigned global environment process. evaluation occurs clean environment, undefined objects must supplied ... /.args, including self-defined functions. Functions package use namespaced calls mirai::mirai(), else package loaded beforehand part .expr. evaluation occur global environment, supply objects ... rather .args, e.g. non-local variables helper functions required functions, scoping rules may otherwise prevent found.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"timeouts","dir":"Reference","previous_headings":"","what":"Timeouts","title":"mirai (Evaluate Async) — mirai","text":"Specifying .timeout argument ensures mirai always resolves. using dispatcher, mirai cancelled times (stop_mirai() called). case, guarantee cancellation successful, code interrupted instance. using dispatcher, mirai task continue completion daemon process, even times host process.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"errors","dir":"Reference","previous_headings":"","what":"Errors","title":"mirai (Evaluate Async) — mirai","text":"error occurs evaluation, error message returned character string class 'miraiError' 'errorValue'. is_mirai_error() may used test . elements original condition accessible via $ error object. stack trace comprising list calls also available $stack.trace, original condition classes $condition.class. daemon crashes terminates unexpectedly evaluation, 'errorValue' 19 (Connection reset) returned. is_error_value() tests error conditions including 'mirai' errors, interrupts, timeouts.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"mirai (Evaluate Async) — mirai","text":"","code":"if (FALSE) { # interactive() # specifying objects via '...' n <- 3 m <- mirai(x + y + 2, x = 2, y = n) m m$data Sys.sleep(0.2) m$data  # passing the calling environment to '...' df1 <- data.frame(a = 1, b = 2) df2 <- data.frame(a = 3, b = 1) df_matrix <- function(x, y) {   mirai(as.matrix(rbind(x, y)), environment(), .timeout = 1000) } m <- df_matrix(df1, df2) m[]  # using unresolved() m <- mirai(   {     res <- rnorm(n)     res / rev(res)   },   n = 1e6 ) while (unresolved(m)) {   cat(\"unresolved\\n\")   Sys.sleep(0.1) } str(m$data)  # evaluating scripts using source() in '.expr' n <- 10L file <- tempfile() cat(\"r <- rnorm(n)\", file = file) m <- mirai({source(file); r}, file = file, n = n) call_mirai(m)$data unlink(file)  # use source(local = TRUE) when passing in local variables via '.args' n <- 10L file <- tempfile() cat(\"r <- rnorm(n)\", file = file) m <- mirai({source(file, local = TRUE); r}, .args = list(file = file, n = n)) call_mirai(m)$data unlink(file)  # passing a language object to '.expr' and a named list to '.args' expr <- quote(a + b + 2) args <- list(a = 2, b = 3) m <- mirai(.expr = expr, .args = args) collect_mirai(m) }"},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai Map — mirai_map","title":"mirai Map — mirai_map","text":"Asynchronous parallel map function list vector using mirai, optional promises integration. Performs multiple map rows dataframe matrix.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mirai Map — mirai_map","text":"","code":"mirai_map(.x, .f, ..., .args = list(), .promise = NULL, .compute = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mirai Map — mirai_map","text":".x list atomic vector. Also accepts matrix dataframe, case multiple map performed rows. .f function applied element .x, row .x case may . ... (optional) named arguments (name = value pairs) specifying objects referenced, defined, .f. .args (optional) constant arguments .f, provided list. .promise (optional) supplied, registers promise mirai. Either function, supplied onFulfilled argument promises::() list 2 functions, supplied respectively onFulfilled onRejected promises::(). Using argument requires promises package. .compute character value compute profile use (independent set daemons), NULL use 'default' profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mirai Map — mirai_map","text":"'mirai_map' (list 'mirai' objects).","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mirai Map — mirai_map","text":"Sends application function .f element .x (row .x) computation separate mirai() call. .x named, names preserved. simple transparent behaviour designed make full use mirai scheduling minimise overall execution time. Facilitates recovery partial failure returning 'miraiError' / 'errorValue' case may , thus allowing failures re-run. function requires daemons previously set, error otherwise.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"collection-options","dir":"Reference","previous_headings":"","what":"Collection Options","title":"mirai Map — mirai_map","text":"x[] collects results 'mirai_map' x returns list. wait asynchronous operations complete still progress, blocking user-interruptible. x[.flat] collects flattens map results vector, checking type avoid coercion. Note: errors 'errorValue' returned results differing type. x[.progress] collects map results whilst showing progress bar cli package, installed, completion percentage ETA, else simple text progress indicator. Note: map operation completes quickly progress bar may show . x[.stop] collects map results applying early stopping, stops first failure cancels remaining operations. options may combined manner : x[.stop, .progress] applies early stopping together progress indicator.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"multiple-map","dir":"Reference","previous_headings":"","what":"Multiple Map","title":"mirai Map — mirai_map","text":".x matrix dataframe (object 'dim' attributes), multiple map performed rows. Character row names preserved names output. allows map 2 arguments, .f accept least many arguments columns. dataframe names, matrix column dimnames, named arguments provided .f. map columns instead, first wrap dataframe .list(), transpose matrix using t().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"nested-maps","dir":"Reference","previous_headings":"","what":"Nested Maps","title":"mirai Map — mirai_map","text":"times way wish run maps within maps. , function provided outer map needs include call daemons() set daemons used inner map. guard inadvertently spawning excessive number daemons machine, attempting launch local daemons within map using daemons(n) error. legitimate use pattern however outer daemons launched remote machines, wish launch daemons locally machines. case, use following solution: instead single call daemons(n) make 2 separate calls daemons(url = local_url()); launch_local(n). equivalent, permitted within map.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/mirai_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"mirai Map — mirai_map","text":"","code":"if (FALSE) { # interactive() daemons(4)  # perform and collect mirai map mm <- mirai_map(c(a = 1, b = 2, c = 3), rnorm) mm mm[]  # map with constant args specified via '.args' mirai_map(1:3, rnorm, .args = list(n = 5, sd = 2))[]  # flatmap with helper function passed via '...' mirai_map(   10^(0:9),   function(x) rnorm(1L, valid(x)),   valid = function(x) min(max(x, 0L), 100L) )[.flat]  # unnamed matrix multiple map: arguments passed to function by position (mat <- matrix(1:4, nrow = 2L)) mirai_map(mat, function(x = 10, y = 0, z = 0) x + y + z)[.flat]  # named matrix multiple map: arguments passed to function by name (mat <- matrix(1:4, nrow = 2L, dimnames = list(c(\"a\", \"b\"), c(\"y\", \"z\")))) mirai_map(mat, function(x = 10, y = 0, z = 0) x + y + z)[.flat]  # dataframe multiple map: using a function taking '...' arguments df <- data.frame(a = c(\"Aa\", \"Bb\"), b = c(1L, 4L)) mirai_map(df, function(...) sprintf(\"%s: %d\", ...))[.flat]  # indexed map over a vector (using a dataframe) v <- c(\"egg\", \"got\", \"ten\", \"nap\", \"pie\") mirai_map(   data.frame(1:length(v), v),   sprintf,   .args = list(fmt = \"%d_%s\") )[.flat]  # return a 'mirai_map' object, check for resolution, collect later mp <- mirai_map(2:4, function(x) runif(1L, x, x + 1)) unresolved(mp) mp mp[.flat] unresolved(mp)  # progress indicator counts up from 0 to 4 seconds res <- mirai_map(1:4, Sys.sleep)[.progress]  # stops early when second element returns an error tryCatch(mirai_map(list(1, \"a\", 3), sum)[.stop], error = identity)  daemons(0) } if (FALSE) { # interactive() && requireNamespace(\"promises\", quietly = TRUE) # promises example that outputs the results, including errors, to the console daemons(1, dispatcher = FALSE) ml <- mirai_map(   1:30,   function(i) {Sys.sleep(0.1); if (i == 30) stop(i) else i},   .promise = list(     function(x) cat(paste(x, \"\")),     function(x) { cat(conditionMessage(x), \"\\n\"); daemons(0) }   ) ) }"},{"path":"https://mirai.r-lib.org/dev/reference/nextstream.html","id":null,"dir":"Reference","previous_headings":"","what":"Next >> Developer Interface — nextstream","title":"Next >> Developer Interface — nextstream","text":"nextstream retrieves currently stored L'Ecuyer-CMRG RNG stream specified compute profile advances next stream. nextget retrieves specified item specified compute profile. nextcode translates integer exit codes returned daemon().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/nextstream.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Next >> Developer Interface — nextstream","text":"","code":"nextstream(.compute = \"default\")  nextget(x, .compute = \"default\")  nextcode(xc)"},{"path":"https://mirai.r-lib.org/dev/reference/nextstream.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Next >> Developer Interface — nextstream","text":".compute character value compute profile use (independent set daemons), NULL use 'default' profile. x character value item retrieve. One \"n\" (number dispatcher daemons), \"dispatcher\" (URL dispatcher uses connect host) \"url\" (URL connect dispatcher daemons) \"tls\" (stored client TLS configuration use daemons). xc integer return value daemon().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/nextstream.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Next >> Developer Interface — nextstream","text":"nextstream: length 7 integer vector, given .Random.seed L'Ecuyer-CMRG RNG use (may passed directly rs argument daemon()), else NULL stream yet created. nextget: requested item, else NULL present. nextcode: character string.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/nextstream.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Next >> Developer Interface — nextstream","text":"functions exported use packages extending mirai alternative launchers daemon() processes. nextstream: function called return value required. function also side effect automatically advancing stream stored within compute profile. ensures next recursive stream returned function called .","code":""},{"path":"https://mirai.r-lib.org/dev/reference/nextstream.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Next >> Developer Interface — nextstream","text":"","code":"daemons(sync = TRUE) nextstream() #> [1]       10407   792815129 -1884879098 -1960710705   286126532 #> [6]  1328909813 -1274208718 nextstream() #> [1]       10407 -1925600861  -765594404 -1351620210 -1371409380 #> [6]   302119711 -1829637341  nextget(\"url\") #> [1] \"abstract://c6a48237a05c9253cd5aaa5a\"  daemons(0)  nextcode(0L) #> [1] \"0 | Daemon connection terminated\" nextcode(1L) #> [1] \"1 | Daemon idletime limit reached\""},{"path":"https://mirai.r-lib.org/dev/reference/on_daemon.html","id":null,"dir":"Reference","previous_headings":"","what":"On Daemon — on_daemon","title":"On Daemon — on_daemon","text":"Returns logical value, whether evaluation taking place within mirai call daemon.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/on_daemon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"On Daemon — on_daemon","text":"","code":"on_daemon()"},{"path":"https://mirai.r-lib.org/dev/reference/on_daemon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"On Daemon — on_daemon","text":"Logical TRUE FALSE.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/on_daemon.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"On Daemon — on_daemon","text":"","code":"if (FALSE) { # interactive() on_daemon() mirai(mirai::on_daemon())[] }"},{"path":"https://mirai.r-lib.org/dev/reference/race_mirai.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai (Race) — race_mirai","title":"mirai (Race) — race_mirai","text":"Accepts list 'mirai' objects, returned mirai_map(). Waits next 'mirai' resolve least one still progress, blocking user-interruptible. none objects supplied unresolved, function returns immediately.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/race_mirai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mirai (Race) — race_mirai","text":"","code":"race_mirai(x)"},{"path":"https://mirai.r-lib.org/dev/reference/race_mirai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mirai (Race) — race_mirai","text":"x 'mirai' object, list 'mirai' objects.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/race_mirai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mirai (Race) — race_mirai","text":"passed object (invisibly).","code":""},{"path":"https://mirai.r-lib.org/dev/reference/race_mirai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mirai (Race) — race_mirai","text":"'mirai' objects supplied must belong compute profile - currently-active one .e. 'default' unless within with_daemons() local_daemons() scope.","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/race_mirai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"mirai (Race) — race_mirai","text":"","code":"if (FALSE) { # interactive() daemons(2) m1 <- mirai(Sys.sleep(0.2)) m2 <- mirai(Sys.sleep(0.1)) start <- Sys.time() race_mirai(list(m1, m2)) Sys.time() - start race_mirai(list(m1, m2)) Sys.time() - start daemons(0) }"},{"path":"https://mirai.r-lib.org/dev/reference/register_serial.html","id":null,"dir":"Reference","previous_headings":"","what":"Register Serialization Configuration — register_serial","title":"Register Serialization Configuration — register_serial","text":"Registers serialization configuration, may set perform custom serialization unserialization normally non-exportable reference objects, allowing used seamlessly different R sessions. registered, functions apply daemons() calls serial argument NULL.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/register_serial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register Serialization Configuration — register_serial","text":"","code":"register_serial(class, sfunc, ufunc)"},{"path":"https://mirai.r-lib.org/dev/reference/register_serial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register Serialization Configuration — register_serial","text":"class character string (vector) class object custom serialization functions applied , e.g. 'ArrowTabular' c('torch_tensor', 'ArrowTabular'). sfunc function (list functions) accepts reference object inheriting class returns raw vector. ufunc function (list functions) accepts raw vector returns reference object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/register_serial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Register Serialization Configuration — register_serial","text":"Invisible NULL.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/remote_config.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic Remote Launch Configuration — remote_config","title":"Generic Remote Launch Configuration — remote_config","text":"Provides flexible generic framework generating shell commands deploy daemons remotely.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/remote_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic Remote Launch Configuration — remote_config","text":"","code":"remote_config(   command = NULL,   args = c(\"\", \".\"),   rscript = \"Rscript\",   quote = FALSE )"},{"path":"https://mirai.r-lib.org/dev/reference/remote_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic Remote Launch Configuration — remote_config","text":"command command used effect daemon launch remote machine character string (e.g. \"ssh\"). Defaults \"ssh\" ssh_config, although may substituted full path specific SSH application. default NULL remote_config carry launches, causes launch_remote() return shell commands manual deployment remote machines. args (optional) arguments passed command, character vector must include \".\" element, substituted daemon launch command. Alternatively, list character vectors effect multiple launches (one list element). rscript filename R executable. Use full path Rscript executable remote machine necessary. launching Windows, \"Rscript\" replaced \"Rscript.exe\". quote logical value whether quote daemon launch command (required Slurm \"srun\" example, required Slurm \"sbatch\" \"ssh\").","code":""},{"path":"https://mirai.r-lib.org/dev/reference/remote_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic Remote Launch Configuration — remote_config","text":"list required format supplied remote argument daemons() launch_remote().","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/remote_config.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generic Remote Launch Configuration — remote_config","text":"","code":"# Slurm srun example remote_config(   command = \"srun\",   args = c(\"--mem 512\", \"-n 1\", \".\"),   rscript = file.path(R.home(\"bin\"), \"Rscript\") ) #> $command #> [1] \"srun\" #>  #> $args #> [1] \"--mem 512\" \"-n 1\"      \".\"         #>  #> $rscript #> [1] \"/opt/R/4.5.2/lib/R/bin/Rscript\" #>  #> $quote #> [1] FALSE #>  #> $tunnel #> [1] FALSE #>   # SSH requires 'quote = TRUE' remote_config(   command = \"/usr/bin/ssh\",   args = c(\"-fTp 22 10.75.32.90\", \".\"),   quote = TRUE ) #> $command #> [1] \"/usr/bin/ssh\" #>  #> $args #> [1] \"-fTp 22 10.75.32.90\" \".\"                   #>  #> $rscript #> [1] \"Rscript\" #>  #> $quote #> [1] TRUE #>  #> $tunnel #> [1] FALSE #>   # can be used to start local daemons with special configurations remote_config(   command = \"Rscript\",   rscript = \"--default-packages=NULL --vanilla\" ) #> $command #> [1] \"Rscript\" #>  #> $args #> [1] \"\"  \".\" #>  #> $rscript #> [1] \"--default-packages=NULL --vanilla\" #>  #> $quote #> [1] FALSE #>  #> $tunnel #> [1] FALSE #>"},{"path":"https://mirai.r-lib.org/dev/reference/require_daemons.html","id":null,"dir":"Reference","previous_headings":"","what":"Require Daemons — require_daemons","title":"Require Daemons — require_daemons","text":"Returns TRUE invisibly daemons set, otherwise produces informative error user set daemons, clickable function link cli package available.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/require_daemons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Require Daemons — require_daemons","text":"","code":"require_daemons(.compute = NULL, call = environment())"},{"path":"https://mirai.r-lib.org/dev/reference/require_daemons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Require Daemons — require_daemons","text":".compute character value compute profile use (independent set daemons), NULL use 'default' profile. call (used cli package installed) execution environment currently running function, e.g. environment(). function mentioned error messages source error.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/require_daemons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Require Daemons — require_daemons","text":"Invisibly, logical TRUE, else errors.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/require_daemons.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Require Daemons — require_daemons","text":"","code":"daemons(sync = TRUE) (require_daemons()) #> [1] TRUE daemons(0)"},{"path":"https://mirai.r-lib.org/dev/reference/serial_config.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Serialization Configuration — serial_config","title":"Create Serialization Configuration — serial_config","text":"Returns serialization configuration, may set perform custom serialization unserialization normally non-exportable reference objects, allowing used seamlessly different R sessions. set passing serial argument daemons(), functions apply mirai requests compute profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/serial_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Serialization Configuration — serial_config","text":"","code":"serial_config(class, sfunc, ufunc)"},{"path":"https://mirai.r-lib.org/dev/reference/serial_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Serialization Configuration — serial_config","text":"class character string (vector) class object custom serialization functions applied , e.g. 'ArrowTabular' c('torch_tensor', 'ArrowTabular'). sfunc function (list functions) accepts reference object inheriting class returns raw vector. ufunc function (list functions) accepts raw vector returns reference object.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/serial_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Serialization Configuration — serial_config","text":"list comprising configuration. passed serial argument daemons().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/serial_config.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Serialization Configuration — serial_config","text":"feature utilises 'refhook' system R native serialization.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/serial_config.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Serialization Configuration — serial_config","text":"","code":"cfg <- serial_config(\"test_cls\", function(x) serialize(x, NULL), unserialize) cfg #> [[1]] #> [1] \"test_cls\" #>  #> [[2]] #> [[2]][[1]] #> function (x)  #> serialize(x, NULL) #> <environment: 0x55e3fc477f18> #>  #>  #> [[3]] #> [[3]][[1]] #> function (connection, refhook = NULL)  #> { #>     if (typeof(connection) != \"raw\" && !is.character(connection) &&  #>         !inherits(connection, \"connection\"))  #>         stop(\"'connection' must be a connection\") #>     .Internal(unserialize(connection, refhook)) #> } #> <bytecode: 0x55e3fc46a260> #> <environment: namespace:base> #>  #>   cfg2 <- serial_config(   c(\"class_one\", \"class_two\"),   list(function(x) serialize(x, NULL), function(x) serialize(x, NULL)),   list(unserialize, unserialize) ) cfg2 #> [[1]] #> [1] \"class_one\" \"class_two\" #>  #> [[2]] #> [[2]][[1]] #> function (x)  #> serialize(x, NULL) #> <environment: 0x55e3fc477f18> #>  #> [[2]][[2]] #> function (x)  #> serialize(x, NULL) #> <environment: 0x55e3fc477f18> #>  #>  #> [[3]] #> [[3]][[1]] #> function (connection, refhook = NULL)  #> { #>     if (typeof(connection) != \"raw\" && !is.character(connection) &&  #>         !inherits(connection, \"connection\"))  #>         stop(\"'connection' must be a connection\") #>     .Internal(unserialize(connection, refhook)) #> } #> <bytecode: 0x55e3fc46a260> #> <environment: namespace:base> #>  #> [[3]][[2]] #> function (connection, refhook = NULL)  #> { #>     if (typeof(connection) != \"raw\" && !is.character(connection) &&  #>         !inherits(connection, \"connection\"))  #>         stop(\"'connection' must be a connection\") #>     .Internal(unserialize(connection, refhook)) #> } #> <bytecode: 0x55e3fc46a260> #> <environment: namespace:base> #>  #>"},{"path":"https://mirai.r-lib.org/dev/reference/ssh_config.html","id":null,"dir":"Reference","previous_headings":"","what":"SSH Remote Launch Configuration — ssh_config","title":"SSH Remote Launch Configuration — ssh_config","text":"Generates remote configuration launching daemons SSH, option SSH tunnelling.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/ssh_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SSH Remote Launch Configuration — ssh_config","text":"","code":"ssh_config(   remotes,   tunnel = FALSE,   timeout = 10,   command = \"ssh\",   rscript = \"Rscript\" )"},{"path":"https://mirai.r-lib.org/dev/reference/ssh_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SSH Remote Launch Configuration — ssh_config","text":"remotes character URL vector URLs SSH , using 'ssh://' scheme including port open SSH connections (defaults 22 specified), e.g. 'ssh://10.75.32.90:22' 'ssh://nodename'. tunnel logical value, whether use SSH tunnelling. TRUE, requires daemons() url hostname '127.0.0.1'. See 'SSH Tunnelling' section details. timeout maximum time seconds allowed connection setup. command command used effect daemon launch remote machine character string (e.g. \"ssh\"). Defaults \"ssh\" ssh_config, although may substituted full path specific SSH application. default NULL remote_config carry launches, causes launch_remote() return shell commands manual deployment remote machines. rscript filename R executable. Use full path Rscript executable remote machine necessary. launching Windows, \"Rscript\" replaced \"Rscript.exe\".","code":""},{"path":"https://mirai.r-lib.org/dev/reference/ssh_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SSH Remote Launch Configuration — ssh_config","text":"list required format supplied remote argument daemons() launch_remote().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/ssh_config.html","id":"ssh-direct-connections","dir":"Reference","previous_headings":"","what":"SSH Direct Connections","title":"SSH Remote Launch Configuration — ssh_config","text":"simplest use SSH execute daemon launch command remote machine, dial back host / dispatcher URL. assumed SSH key-based authentication already place. relevant port host must also open inbound connections remote machine, hence suitable use within trusted networks.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/ssh_config.html","id":"ssh-tunnelling","dir":"Reference","previous_headings":"","what":"SSH Tunnelling","title":"SSH Remote Launch Configuration — ssh_config","text":"Use SSH tunnelling provides convenient way launch remote daemons without requiring remote machine able access host. Often firewall configurations security policies may prevent opening port accept outside connections. cases SSH tunnelling offers solution creating tunnel initial SSH connection made. simplicity, SSH tunnelling implementation uses port host daemon. SSH key-based authentication must already place, configuration required. use tunnelling, set hostname daemons() url argument '127.0.0.1'. Using local_url() tcp = TRUE also . Specifying specific port use optional, random ephemeral port assigned otherwise. example, specifying 'tcp://127.0.0.1:5555' uses local port '5555' create tunnel machine. host listens '127.0.0.1:5555' machine remotes dial '127.0.0.1:5555' respective machines. provides means launching daemons machine able access via SSH, local network cloud.","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/ssh_config.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SSH Remote Launch Configuration — ssh_config","text":"","code":"# direct SSH example ssh_config(c(\"ssh://10.75.32.90:222\", \"ssh://nodename\"), timeout = 5) #> $command #> [1] \"ssh\" #>  #> $args #> $args[[1]] #> [1] \"-o ConnectTimeout=5 -fTp 222\" \"10.75.32.90\"                  #> [3] \".\"                            #>  #> $args[[2]] #> [1] \"-o ConnectTimeout=5 -fTp 22\" \"nodename\"                    #> [3] \".\"                           #>  #>  #> $rscript #> [1] \"Rscript\" #>  #> $quote #> [1] TRUE #>  #> $tunnel #> [1] FALSE #>   # SSH tunnelling example ssh_config(c(\"ssh://10.75.32.90:222\", \"ssh://nodename\"), tunnel = TRUE) #> $command #> [1] \"ssh\" #>  #> $args #> $args[[1]] #> [1] \"-o ConnectTimeout=10 -fTp 222\" \"10.75.32.90\"                   #> [3] \".\"                             #>  #> $args[[2]] #> [1] \"-o ConnectTimeout=10 -fTp 22\" \"nodename\"                     #> [3] \".\"                            #>  #>  #> $rscript #> [1] \"Rscript\" #>  #> $quote #> [1] TRUE #>  #> $tunnel #> [1] TRUE #>   if (FALSE) { # \\dontrun{  # launch daemons on the remote machines 10.75.32.90 and 10.75.32.91 using # SSH, connecting back directly to the host URL over a TLS connection: daemons(   n = 1,   url = host_url(tls = TRUE),   remote = ssh_config(c(\"ssh://10.75.32.90:222\", \"ssh://10.75.32.91:222\")) )  # launch 2 daemons on the remote machine 10.75.32.90 using SSH tunnelling: daemons(   n = 2,   url = local_url(tcp = TRUE),   remote = ssh_config(\"ssh://10.75.32.90\", tunnel = TRUE) ) } # }"},{"path":"https://mirai.r-lib.org/dev/reference/status.html","id":null,"dir":"Reference","previous_headings":"","what":"Status Information — status","title":"Status Information — status","text":"Retrieve status information specified compute profile, comprising current connections daemons status.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/status.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Status Information — status","text":"","code":"status(.compute = NULL)"},{"path":"https://mirai.r-lib.org/dev/reference/status.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Status Information — status","text":".compute character value compute profile query, NULL query 'default' profile. 'miraiCluster' obtain status.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/status.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Status Information — status","text":"named list comprising: connections - integer number active daemon connections. daemons - character URL host / dispatcher listening, else 0L daemons yet set. mirai (present using dispatcher) - named integer vector comprising: awaiting - number tasks queued execution dispatcher, executing - number tasks sent daemon execution, completed - number tasks result received (either completed cancelled).","code":""},{"path":[]},{"path":"https://mirai.r-lib.org/dev/reference/status.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Status Information — status","text":"","code":"if (FALSE) { # interactive() status() daemons(url = \"tcp://[::1]:0\") status() daemons(0) }"},{"path":"https://mirai.r-lib.org/dev/reference/stop_mirai.html","id":null,"dir":"Reference","previous_headings":"","what":"mirai (Stop) — stop_mirai","title":"mirai (Stop) — stop_mirai","text":"Stops 'mirai' still progress, causing resolve immediately 'errorValue' 20 (Operation canceled).","code":""},{"path":"https://mirai.r-lib.org/dev/reference/stop_mirai.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mirai (Stop) — stop_mirai","text":"","code":"stop_mirai(x)"},{"path":"https://mirai.r-lib.org/dev/reference/stop_mirai.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mirai (Stop) — stop_mirai","text":"x 'mirai' object, list 'mirai' objects.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/stop_mirai.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mirai (Stop) — stop_mirai","text":"Logical TRUE cancellation request successful (awaiting execution execution), else FALSE (already completed previously cancelled). always return FALSE using dispatcher. vector logical values supplying list 'mirai', returned mirai_map().","code":""},{"path":"https://mirai.r-lib.org/dev/reference/stop_mirai.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mirai (Stop) — stop_mirai","text":"Using dispatcher allows cancellation 'mirai'. case 'mirai' awaiting execution, discarded queue never evaluated. case already execution, interrupt sent. successful cancellation request guarantee successful cancellation: task, portion , may already completed interrupt received. Even , compiled code always interruptible. noted, particularly code carries side effects execution, writing files, etc.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/stop_mirai.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"mirai (Stop) — stop_mirai","text":"","code":"if (FALSE) { # interactive() m <- mirai(Sys.sleep(n), n = 5) stop_mirai(m) m$data }"},{"path":"https://mirai.r-lib.org/dev/reference/unresolved.html","id":null,"dir":"Reference","previous_headings":"","what":"Query if a mirai is Unresolved — unresolved","title":"Query if a mirai is Unresolved — unresolved","text":"Query whether 'mirai', 'mirai' value list 'mirai' remains unresolved. Unlike call_mirai(), function wait completion.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/unresolved.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query if a mirai is Unresolved — unresolved","text":"","code":"unresolved(x)"},{"path":"https://mirai.r-lib.org/dev/reference/unresolved.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Query if a mirai is Unresolved — unresolved","text":"x 'mirai' object list 'mirai' objects, 'mirai' value stored $data.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/unresolved.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query if a mirai is Unresolved — unresolved","text":"Logical TRUE x unresolved 'mirai' 'mirai' value list contains least one unresolved 'mirai', FALSE otherwise.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/unresolved.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Query if a mirai is Unresolved — unresolved","text":"Suitable use control flow statements .","code":""},{"path":"https://mirai.r-lib.org/dev/reference/unresolved.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Query if a mirai is Unresolved — unresolved","text":"","code":"if (FALSE) { # interactive() m <- mirai(Sys.sleep(0.1)) unresolved(m) Sys.sleep(0.3) unresolved(m) }"},{"path":"https://mirai.r-lib.org/dev/reference/with.miraiDaemons.html","id":null,"dir":"Reference","previous_headings":"","what":"With Mirai Daemons — with.miraiDaemons","title":"With Mirai Daemons — with.miraiDaemons","text":"Evaluate expression daemons last duration expression. Ensure mirai within statement explicitly called (values collected) daemons reset completed.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with.miraiDaemons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"With Mirai Daemons — with.miraiDaemons","text":"","code":"# S3 method for class 'miraiDaemons' with(data, expr, ...)"},{"path":"https://mirai.r-lib.org/dev/reference/with.miraiDaemons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"With Mirai Daemons — with.miraiDaemons","text":"data call daemons(). expr expression evaluate. ... used.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with.miraiDaemons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"With Mirai Daemons — with.miraiDaemons","text":"return value expr.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with.miraiDaemons.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"With Mirai Daemons — with.miraiDaemons","text":"function S3 method generic () class 'miraiDaemons'.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with.miraiDaemons.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"With Mirai Daemons — with.miraiDaemons","text":"","code":"if (FALSE) { # interactive() with(   daemons(2, dispatcher = FALSE),   {     m1 <- mirai(Sys.getpid())     m2 <- mirai(Sys.getpid())     cat(m1[], m2[], \"\\n\")   } )  status() }"},{"path":"https://mirai.r-lib.org/dev/reference/with_daemons.html","id":null,"dir":"Reference","previous_headings":"","what":"With Daemons — with_daemons","title":"With Daemons — with_daemons","text":"Evaluate expression using specific compute profile.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with_daemons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"With Daemons — with_daemons","text":"","code":"with_daemons(.compute, expr)  local_daemons(.compute, frame = parent.frame())"},{"path":"https://mirai.r-lib.org/dev/reference/with_daemons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"With Daemons — with_daemons","text":".compute character value compute profile use (independent set daemons), NULL use 'default' profile. expr expression evaluate. frame frame (environment) daemons compute profile scoped.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with_daemons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"With Daemons — with_daemons","text":"with_daemons: return value expr.  local_daemons: invisible NULL.","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with_daemons.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"With Daemons — with_daemons","text":"error specified compute profile yet set .","code":""},{"path":"https://mirai.r-lib.org/dev/reference/with_daemons.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"With Daemons — with_daemons","text":"","code":"if (FALSE) { # interactive() daemons(1, dispatcher = FALSE, .compute = \"cpu\") daemons(1, dispatcher = FALSE, .compute = \"gpu\")  with_daemons(\"cpu\", {   s1 <- status()   m1 <- mirai(Sys.getpid()) })  with_daemons(\"gpu\", {   s2 <- status()   m2 <- mirai(Sys.getpid())   m3 <- mirai(Sys.getpid(), .compute = \"cpu\")   local_daemons(\"cpu\")   m4 <- mirai(Sys.getpid()) })  s1$daemons m1[]  s2$daemons m2[] # different to m1  m3[] # same as m1 m4[] # same as m1  with_daemons(\"cpu\", daemons(0)) with_daemons(\"gpu\", daemons(0)) }"},{"path":[]},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-development-version","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai (development version)","text":"OpenTelemetry: ‘daemon connect’ spans now recorded connection actually made (#511). Fixes bug caused mirai remain unresolved switching synchronous daemons dispatcher daemons session (#509). mirai_map() now returns invisibly, consistent mirai().","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-252","dir":"Changelog","previous_headings":"","what":"mirai 2.5.2","title":"mirai 2.5.2","text":"CRAN release: 2025-11-05","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-5-2","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.5.2","text":"Introduces 200ms grace period processes exit normally forceful termination. behavioural changes announced mirai 2.4.0 now enforced daemon types - eliminating bug previously caused applied ephemeral daemons. OpenTelemetry span names attributes upgraded informative better follow semantic conventions (#481). Function now returns invisibly intended. Using .compute first argument (produced warning) longer works. Requires nanonext >= 1.7.2.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-251","dir":"Changelog","previous_headings":"","what":"mirai 2.5.1","title":"mirai 2.5.1","text":"CRAN release: 2025-10-06","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-2-5-1","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 2.5.1","text":"Adds race_mirai(), accepts list mirai waits efficiently next mirai amongst resolve (@t-kalinowski, #448). New synchronous mode: daemons(sync = TRUE) causes mirai run synchronously within current process. facilitates testing debugging, e.g. via interactive browser() instances (#439, @kentqin-cve #442).","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-5-1","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.5.1","text":"everywhere() adds argument .min specify minimum number daemons evaluate expression (using dispatcher). creates synchronization point can useful launching remote daemons ensure expression run daemons connect (@louisaslett, #330). OpenTelemetry span names updated. Spans long-running daemons now split short spans created end - refer updated vignette details (#464, #471). nextget(\"pid\") longer supported option. Argument id removed daemon(). means status() longer reports daemon connection disconnection events. Removes deprecated argument tls daemon(), launch_local() launch_remote(). Removes deprecated dispatcher argument ‘none’ daemons(), deprecated mirai v2.1.0. Fixes phenomenon stop_mirai() mirai_map()[.stop] occasion cause (dispatcher) daemons interrupted exit subsequent runs (#459). Non-dispatcher daemons now synchronize upon timeout task-, ensuring exit safely data sent (#458). Requires nanonext >= 1.7.1.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-250","dir":"Changelog","previous_headings":"","what":"mirai 2.5.0","title":"mirai 2.5.0","text":"CRAN release: 2025-09-04","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"behavioural-changes-2-5-0","dir":"Changelog","previous_headings":"","what":"Behavioural Changes","title":"mirai 2.5.0","text":"Returns invisibly logical TRUE creating daemons FALSE resetting, simplicity consistency (#384). Creating new daemons resets existing daemons compute profile rather error. means explicit daemons(0) longer required applying new settings (thanks @eliocamp, #383). Calling without supplying arguments now errors rather return value status().","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-2-5-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 2.5.0","text":"Complete observability mirai requests emitting OpenTelemetry traces tracing enabled otelsdk package (#394). Adds info() alternative status() retrieving succinct information statistics, convenient programmatic use (thanks @wlandau, #410). Adds with_daemons() local_daemons() helper functions using particular compute profile. work daemons already set unlike existing .miraiDaemons() method, creates new scope tears finished (#360). mirai now attribute id, monotonically increasing integer identifier unique session.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-5-0","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.5.0","text":"stop_mirai() efficient responsive, especially ‘mirai_map’ objects (#417). original condition classes preserved $condition.class (thanks @sebffischer, #400). print method includes customary additional line break (thanks @sebffischer, #399). Fixes daemons(n) failing launch local daemons mirai installed custom user library set explicit .libPaths() call ‘.Rprofile’ (thanks @erydit @dpastoor, #390). Improved behaviour serial_config() custom serialization. serialization hook function errors otherwise fails return raw vector, error rather silently ignored (thanks @dipterix, #378). .promise() method mirai made robust high-throughput scenarios (#377). mirai_map() now supports Arrow Tables Polars DataFrames (#366). require_daemons() arguments swapped .compute comes call ease use. Previous usage work time , although deprecated defunct future version. Consecutive everywhere() calls permissible using dispatcher (behaviour update v2.4.1) (#354). longer effect RNG stream using reproducible seed value daemons() (#356). mirai() evaluated ephemeral daemon returns invisibly, consistent cases (#351). daemon() gains tlscert argument custom TLS certificates. change argument name lets passed making daemons() call (#344). tls argument daemon(), launch_local() launch_remote() deprecated. Requires nanonext >= 1.7.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-241","dir":"Changelog","previous_headings":"","what":"mirai 2.4.1","title":"mirai 2.4.1","text":"CRAN release: 2025-07-15","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-2-4-1","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 2.4.1","text":"default NULL uses L’Ecuyer-CMRG RNG streams advanced per daemon, base R’s parallel package, produces statistically-sound yet generally non-reproducible results. Setting integer seed now initializes L’Ecuyer-CMRG RNG stream compute profile, advanced mirai evaluation, provide reproducible results.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-4-1","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.4.1","text":"Returns mirai_map object easier handling (rather just list mirai). using dispatcher, longer potential fail sending large data (#326). dispatcher() function signature simplified rs, tls pass arguments removed (user-facing impact). Fixes bug using non-dispatcher daemons, unresolvedValue returned fulfilled value promise extremely rare cases (thanks @James-G-Hill @olivier7121, #243 #317). Fixes regression mirai 2.4.0 L’Ecuyer-CMRG seed passed correctly remote daemons (#333). Requires nanonext >= 1.6.2.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-240","dir":"Changelog","previous_headings":"","what":"mirai 2.4.0","title":"mirai 2.4.0","text":"CRAN release: 2025-06-25","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"behavioural-changes-2-4-0","dir":"Changelog","previous_headings":"","what":"Behavioural Changes","title":"mirai 2.4.0","text":"ephemeral daemon started mirai() without setting daemons now exits soon parent process rather finish task. Argument autoexit default TRUE now ensures daemons terminated along parent process. Set NA retain previous behaviour automatically exit completing -progress tasks. Argument dispatcher now defaults TRUE. Calling daemons() create local daemons now errors performed within mirai_map() call. guards excessive spawning local processes single machine.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-2-4-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 2.4.0","text":"Adds cluster_config() launch remote daemons via HPC resource managers Slurm, SGE, Torque, PBS LSF clusters. Adds require_daemons() developer function prompts user set daemons already set, clickable function link cli package available.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-4-0","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.4.0","text":"Simplifies launches using dispatcher - launch_remote() commands now irrespective number launches. daemons now retrieve next RNG stream dispatcher rather rs argument daemon(). Deprecated call_mirai_() now removed. Requires nanonext >= 1.6.1.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-230","dir":"Changelog","previous_headings":"","what":"mirai 2.3.0","title":"mirai 2.3.0","text":"CRAN release: 2025-05-22","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"behavioural-changes-2-3-0","dir":"Changelog","previous_headings":"","what":"Behavioural Changes","title":"mirai 2.3.0","text":"mirai() argument .timeout upgraded automatically cancel ongoing mirai upon timeout using dispatcher (thanks @-marc, @sebffischer #251). serial_config() now accepts vector arguments register multiple custom serialization configurations. Argument vec dropped internal optimizations mean option longer needs set.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-2-3-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 2.3.0","text":"host_url() upgraded return local IP addresses (named network interface), provides comprehensive solution just using hostname. Adds register_serial() register serialization configurations daemons() calls (may used package authors convenience). Adds on_daemon() returns logical value, whether evaluation taking place within mirai call daemon. Adds daemons_set() returns logical value, whether daemons set given compute profile. daemons() now supports initial synchronization exceeding 10s (host/dispatcher/daemons). particularly relevant HPC setups (thanks @sebffischer, #275).","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-3-0","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.3.0","text":"functions use .compute, argument new default NULL, continues use default profile (hence result change behaviour). Fixes stop_mirai() failing interrupt certain cases non-Windows platforms, robust interruption tools::SIGINT supplied passed autoexit argument daemon() (thanks @LennardLux, #240). daemons() dispatcher argument ‘process’, deprecated mirai v2.1.0, removed. Requires nanonext >= 1.6.0. Package re-licensed MIT license.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-220","dir":"Changelog","previous_headings":"","what":"mirai 2.2.0","title":"mirai 2.2.0","text":"CRAN release: 2025-03-20","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"behavioural-changes-2-2-0","dir":"Changelog","previous_headings":"","what":"Behavioural Changes","title":"mirai 2.2.0","text":"ssh_config() argument ‘port’ removed, tunnel port now inferred time launch, longer set configuration. local_url() adds logical argument ‘tcp’ easily constructing automatic local TCP URL setting daemons() SSH tunnelling.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-2-2-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 2.2.0","text":"Adds .promise() method ‘mirai_map’ objects. resolve upon completion entire map operation.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-2-0","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.2.0","text":"register_cluster() removed longer required. Directly use parallel::makeCluster(type = \"MIRAI\") create ‘miraiCluster’. call_mirai_() hence redundant now deprecated. () method daemons() now propagates “.compute” need specified functions mirai() within () clause. mirai() arguments ... .args now accept environments containing variables beginning dot . (#207). ‘miraiError’ stack traces longer sometimes contain additional (internal) call (#216). ‘miraiError’ condition $call objects now stripped ‘srcref’ attributes (thanks @lionel-, #218). mirai promise now rejects exactly way whether mirai already resolved time creation. avoids Shiny deep stack trace errors mirai already resolved (#229). daemons() calls error due remote launcher longer leave compute profile set (#237).","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-210","dir":"Changelog","previous_headings":"","what":"mirai 2.1.0","title":"mirai 2.1.0","text":"CRAN release: 2025-02-07","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"behavioural-changes-2-1-0","dir":"Changelog","previous_headings":"","what":"Behavioural Changes","title":"mirai 2.1.0","text":"daemons() now requires explicit reset providing revised settings compute profile, error otherwise. mirai_map() now errors daemons yet set (rather warn launch one local daemon). saisei() now removed longer required. daemons() dispatcher argument “thread” removed. daemons() dispatcher arguments “process” “none” formally deprecated removed future version.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-1-0","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.1.0","text":"‘miraiError’ evaluation errors now return call stack $stack.trace list calls (srcrefs removed) without deparsing character strings. Multiple map dataframe matrix now correctly preserves row names input names output. Fixes language objects evaluated map function applied (#194). Fixes classes objects dataframe dropped multiple map (#196). Better cli errors collecting ‘mirai_map’. Fixes daemons(NULL) causing daemons started autoexit = FALSE quit, regression introduced mirai v2.0.0. Requires nanonext >= 1.5.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-201","dir":"Changelog","previous_headings":"","what":"mirai 2.0.1","title":"mirai 2.0.1","text":"CRAN release: 2025-01-16","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-0-1","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.0.1","text":"cli package used, installed, richer progress bars error messages. [.progress_cli] longer separate option. [.stop] now reports index number errored. collect_mirai() replaces ‘…’ ‘options’ argument, collection options supplied character vector. avoids non-standard evaluation function. daemon() now returns integer exit code indicate reason termination. Adds nextcode() provide human-readable translation exit codes returned daemon(). everywhere() now returns list least one mirai regardless number actual connections.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-200","dir":"Changelog","previous_headings":"","what":"mirai 2.0.0","title":"mirai 2.0.0","text":"CRAN release: 2025-01-08","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-architecture-2-0-0","dir":"Changelog","previous_headings":"","what":"New Architecture","title":"mirai 2.0.0","text":"Allows efficient tcp:// tls+tcp:// connection cases. number connected daemons may upscaled downscaled time without limit.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-2-0-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 2.0.0","text":"daemons(dispatcher = TRUE) provides new efficient architecture dispatcher. argument reverts logical value, although ‘process’ still accepted retains previous behaviour v1 dispatcher. daemons() gains argument ‘serial’ register serialization configurations using dispatcher. automatically apply daemons connect. stop_mirai() now able cancel remote mirai tasks (using dispatcher), returning logical value indicating whether cancellation successful. ‘miraiError’ now preserves original condition object. means rlang::abort() custom metadata may now accessed using $ ‘miraiError’ (thanks @James-G-Hill #173).","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-2-0-0","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 2.0.0","text":"status() using new dispatcher updated provide concise insightful information. Enhanced return list mirai, may waited inspected (thanks @dgkf, #164). Drops argument ‘.serial’ serialization configurations now registered via argument daemons(). Gains new argument ‘dispatcher’, set TRUE connecting dispatcher FALSE connecting directly host. Gains argument ‘id’ accepts integer value allows status() track connection disconnection events. ‘…’ moved prevent partial matching optional arguments. ‘cleanup’ argument simplified TRUE/FALSE value. ‘timerstart’ argument removed. Enhanced now launch daemons originally-supplied arguments default. Simplified take argument ‘n’ instead ‘url’ many daemons launch. launch_local() now returns number daemons launched rather invisible NULL. collect_mirai() now interruptible takes ‘…’ argument accepting collection options provided ‘mirai_map’ [] method, .flat etc. ssh_config() simplified take argument ‘port’ instead ‘host’. SSH tunnelling, port used, hostname now required ‘127.0.0.1’ (longer accepting ‘localhost’). host_url() argument ‘ws’ removed TCP URL now always recommended (although websocket URLs still supported). saisei() defunct longer required, still available use old v1 dispatcher. daemons(dispatcher = \"thread\") (experimental threaded dispatcher) retired - based old dispatcher architecture future development focus current design. Specifying ‘dispatcher = thread’ defunct, point ‘dispatcher = process’ time . Requires nanonext >= 1.4.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-131","dir":"Changelog","previous_headings":"","what":"mirai 1.3.1","title":"mirai 1.3.1","text":"CRAN release: 2024-11-15","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-1-3-1","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 1.3.1","text":"Cleanup packages detaches search path attempt unload , always safe . Fixes daemon crashes using packages data.table (thanks @D3SL, #166). serialization() deprecated mirai 1.2.0 now removed.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-130","dir":"Changelog","previous_headings":"","what":"mirai 1.3.0","title":"mirai 1.3.0","text":"CRAN release: 2024-10-09","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"new-features-1-3-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"mirai 1.3.0","text":"daemons(dispatcher = \"thread\") implements threaded dispatcher (experimental), faster efficient alternative running dispatcher separate process. mirai_map() adds [.progress_cli] alternative progress indicator, using cli package show % complete ETA. daemons() gains argument ‘force’ control whether calls reset previous settings compute profile. daemon() gains argument ‘asyncdial’ allow control connection behaviour independently happens daemon exits.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"behavioural-changes-1-3-0","dir":"Changelog","previous_headings":"","what":"Behavioural Changes","title":"mirai 1.3.0","text":"Argument ‘dispatcher’ now takes character options ‘process’, ‘thread’ ‘none’. Previous values TRUE/FALSE continue accepted (thanks @hadley #157). Return value now always integer - either number daemons set using dispatcher, number daemons launched locally (zero using remote launcher). Invalid type ... arguments now dropped instead throwing error. allows ... containing unused arguments easily passed functions. Now performs multiple map rows matrices dataframes (thanks @andrewGhazi, #147). Combining collection options now easier, fashion : x[.stop, .progress]. Collection options now work even mirai search path e.g. mirai::mirai_map(1:4, Sys.sleep)[.progress]. dispatcher() drops argument ‘asyncdial’ rarely useful set . everywhere() now errors specified compute profile yet set , rather fail silently. launch_local() launch_remote() now strictly require daemons set, error otherwise. serial_config() now validates arguments provided returns list. means saved configurations previous package versions must re-generated.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"updates-1-3-0","dir":"Changelog","previous_headings":"","what":"Updates","title":"mirai 1.3.0","text":"Fixes daemons() correctly handle vector URLs passed ‘url’ . Fixes flatmap mirai_map()[.flat] assigning variable ‘typ’ calling environment. Performance enhancements mirai(), mirai_map() promises method. Requires nanonext >= 1.3.0. package shiny new hex logo.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-120","dir":"Changelog","previous_headings":"","what":"mirai 1.2.0","title":"mirai 1.2.0","text":"CRAN release: 2024-08-18 everywhere() adds argument ‘.serial’ accept serialization configurations created serial_config(). allow normally non-exportable reference objects Arrow Tables torch tensors used seamlessly across parallel processes without additional marshalling steps. Configurations apply per compute profile basis. serialization() now deprecated favour usage everywhere(), removed future version. mirai_map() enhanced perform multiple map 2D lists/vectors, allowing advanced patterns mapping rows dataframe matrix. ‘mirai_map’ [] method gains option [.flat] collect flatten results, avoiding coercion. Collecting ‘mirai_map’ longer spuriously introduces empty names none present originally. Faster local daemons(dispatcher = FALSE) make_cluster() using asynchronous launches (thanks @mtmorgan #123). Local dispatcher daemons now synchronize host, non-dispatcher daemons (prevents use connected). Fixes rare cases everywhere() reaching daemons using dispatcher. efficient dispatcher startup loading base package, addition reading startup configurations (thanks @krlmlr). Removes hard dependency stats utils base packages. Requires nanonext >= 1.2.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-111","dir":"Changelog","previous_headings":"","what":"mirai 1.1.1","title":"mirai 1.1.1","text":"CRAN release: 2024-07-01 serialization() function signature return value slightly modified clarity. Successful registration / cancellation messages longer printed console. dispatcher() argument ‘retry’ now defaults FALSE consistency non-dispatcher behaviour. remote_config() gains argument ‘quote’ control whether quote daemon launch command, now works Slurm (thanks @michaelmayer2 #119). Ephemeral daemons now exit soon permissible, eliminating 2s linger period. Requires nanonext >= 1.1.1.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-110","dir":"Changelog","previous_headings":"","what":"mirai 1.1.0","title":"mirai 1.1.0","text":"CRAN release: 2024-06-06 x[] collects results mirai_map x, waiting asynchronous operations complete. x[.progress] collects results whilst showing text progress bar. x[.stop] collects results applying early-stopping, stops first error, aborts remaining -progress operations. Adds ‘mirai’ method x[] efficient equivalent interruptible call_mirai_(x)$data. Adds collect_mirai() efficient equivalent non-interruptible call_mirai(x)$data. unresolved(), call_mirai(), collect_mirai() stop_mirai() now accept list ‘mirai’ returned mirai_map(). Improved mirai print method indicates whether mirai resolved. Calling daemons() new settings compute profile already set now implicitly resets daemons applying new settings instead silently nothing. Argument ‘resilience’ retired daemons() automatic re-tries longer performed non-dispatcher daemons. New argument ‘retry’ dispatcher() governs whether auto-retry dispatcher case. Fixes promises method potential crashes launching improbably short-lived mirai. Fixes bug cause hang crash launching additional non-dispatcher daemons. Requires nanonext >= 1.1.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-100","dir":"Changelog","previous_headings":"","what":"mirai 1.0.0","title":"mirai 1.0.0","text":"CRAN release: 2024-05-03 innovation allows higher responsiveness massive scalability ‘mirai’ promises. (breaking change) longer permits unnamed list supplied ‘.args’. allows environment e.g. environment() supplied ‘.args’ element ‘…’. allows evaluation symbol ‘mirai’ environment, e.g. mirai(x, x = 1). new argument ‘host’ allows specifying localhost URL port create standalone configuration object. order arguments ‘tunnel’ ‘timeout’ reversed. stop_mirai() now resolves ‘errorValue’ 20 (operation canceled) case asynchronous task still ongoing (thanks @jcheng5 #110). Rejected promises now show complete error code message case ‘errorValue’. ‘miraiError’ reverts including trailing line break (prior mirai 0.13.2). Non-dispatcher local daemons now synchronize host cases (prevents use connected). [ method ‘miraiCluster’ longer produces ‘miraiCluster’ object (thanks @HenrikBengtsson #83). Faster startup time parallel package now loaded first used. Requires nanonext >= 1.0.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0132","dir":"Changelog","previous_headings":"","what":"mirai 0.13.2","title":"mirai 0.13.2","text":"CRAN release: 2024-04-11 mirai() everywhere() behaviour changed ‘…’ args now assigned global environment daemon process. Adds () method mirai daemons, allowing example: (daemons(4), {expr}), daemons last duration ‘expr’. Adds register_cluster() registering ‘miraiCluster’ parallel Cluster type (requires R >= 4.4). Adds .promising() method ‘mirai’ promises package. ‘miraiError’ now includes full call stack, may accessed $stack.trace, includes trailing line break consistency ‘.character.error()’. mirai promises now preserve deep stacks ‘miraiError’ occurs within Shiny app (thanks @jcheng5 #104). Simplified registration ‘parallel’ ‘promises’ methods (thanks @jcheng5 #103). Fixes promises error handling Shiny vignette (thanks @jcheng5 #98 #99). Requires R >= 3.6.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0131","dir":"Changelog","previous_headings":"","what":"mirai 0.13.1","title":"mirai 0.13.1","text":"Fixes regression mirai 0.12.1, introduced potential unintentional low level errors emerge querying dispatcher (thanks @dsweber2 reporting downstream {targets}).","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0130","dir":"Changelog","previous_headings":"","what":"mirai 0.13.0","title":"mirai 0.13.0","text":"serialization adds arguments ‘class’ ‘vec’ custom serialisation reference object types. Requires nanonext >= 0.13.3.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0121","dir":"Changelog","previous_headings":"","what":"mirai 0.12.1","title":"mirai 0.12.1","text":"CRAN release: 2024-02-02 Dispatcher initial sync timeout widened 10s allow launching large numbers daemons. Default ssh_config() argument ‘timeout’ widened 10 (seconds). Fixes daemons() specifying ‘output = FALSE’ registering TRUE instead. Fixes use everywhere() specifying ‘.args’ unnamed list ‘.expr’ language object. Ensures compatibility nanonext >= 0.13.0. Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0120","dir":"Changelog","previous_headings":"","what":"mirai 0.12.0","title":"mirai 0.12.0","text":"CRAN release: 2024-01-12 minimal print methods ‘mirai’ ‘miraiCluster’. Adds local_url() helper construct random inter-process communications URL local daemons (thanks @noamross #90). daemon() argument ‘autoexit’ now accepts signal value tools::SIGINT order raise upon exit. daemon() now records state initial global environment objects (e.g. created .Rprofile) cleanup purposes (thanks @noamross #91). Slightly optimal .promise() method ‘mirai’. Eliminates potential memory leaks along certain error paths. Requires nanonext >= 0.12.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0113","dir":"Changelog","previous_headings":"","what":"mirai 0.11.3","title":"mirai 0.11.3","text":"CRAN release: 2023-12-07 Implements serialization() registering custom serialization unserialization functions using daemons. Introduces call_mirai_(), user-interruptible version call_mirai() suitable interactive use. ‘.args’ now coerce list object list supplied, rather error. ‘.signal’ argument removed - now ‘mirai’ signal daemons set . everywhere() now returns invisible NULL case specified compute profile set , rather error. mirai() specifying timeout daemons() set - timeout begins immediately rather ephemeral daemon connected - please factor small amount time daemon launch. make_cluster() now prints daemon launch commands ‘url’ specified without ‘remote’ whether interactive. Cluster node failures load balanced operations now rely ‘parallel’ mechanism error longer fail early automatically stop cluster. Fixes regression since 0.11.0 prevented dispatcher exiting timely manner tasks backlogged (thanks @wlandau #86). Improved memory efficiency stability dispatcher. longer loads ‘promises’ package already loaded (makes ‘mirai’ method available via hook function). Requires nanonext >= 0.11.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0112","dir":"Changelog","previous_headings":"","what":"mirai 0.11.2","title":"mirai 0.11.2","text":"CRAN release: 2023-11-15 make_cluster() specifying ‘url’ now succeeds implied ‘n’ one. Fixes mirai() specifying language object name ‘.expr’ R versions 4.0 earlier. Fixes regression 0.11.1 prevented correct random seed set using dispatcher. Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0111","dir":"Changelog","previous_headings":"","what":"mirai 0.11.1","title":"mirai 0.11.1","text":"CRAN release: 2023-11-04 Adds ‘mirai’ method ‘.promise()’ {promises} package (available). functionality merged package {mirai.promises}, allowing use promise pipe %...>% ‘mirai’. Parallel clusters (alternative communications backend R) now work existing R versions, longer requiring R >= 4.4. everywhere() evaluates expression ‘everywhere’ connected daemons compute profile. Resulting changes global environment, loaded pacakges options persisted regardless ‘cleanup’ setting (request @krlmlr #80). host_url() implemented helper function automatically construct host URL using computer’s hostname. daemon() adds argument ‘autoexit’, replaces ‘asyncdial’, govern persistence settings daemon. daemon can now survive host session re-connect another one (request @krlmlr #81). daemons(NULL) implemented variant daemons(0) also sends exit signals connected persistent daemons. dispatcher() argument ‘lock’ removed now applied cases prevent one daemon dialling dispatcher URL one time. daemon() argument ‘cleanup’ simplified logical argument, granular control offered existing integer bitmask (thanks @krlmlr #79). Daemons connecting TLS now perform synchronous dials default (documented). Fixes supplying ssh_config() specifying tunnelling ‘remote’ argument daemons(). Fixes print method subset ‘miraiCluster’ (thanks @HenrikBengtsson #83). Removes deprecated deferred evaluation pipe %>>%. Requires nanonext >= 0.10.4.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0110","dir":"Changelog","previous_headings":"","what":"mirai 0.11.0","title":"mirai 0.11.0","text":"CRAN release: 2023-10-06 Fulfils request R Core R Project Sprint 2023, requires R >= 4.4 (currently R-devel). make_cluster() creates ‘miraiCluster’, compatible existing functions taking ‘cluster’ object, example ‘parallel’ ‘doParallel’ / ‘foreach’ packages. status() can now take ‘miraiCluster’ argument query connection status. Simplified interface single ‘remote’ argument taking remote configuration launch daemons. Returned shell commands now custom print method means may directly copy/pasted remote machine. Can now take ‘miraiCluster’ ‘miraiNode’ return shell commands deployment remote nodes. Adds argument ‘remote’ launching remote daemons directly without recourse separate call launch_remote(). Adds argument ‘resilience’ control behaviour, using dispatcher, whether retry failed tasks daemons. remote_config() added generate configurations directly launching remote daemons, can supplied directly ‘remote’ argument. ssh_config() added convenience method generate launch configurations using SSH, including SSH tunnelling. mirai() adds logical argument ‘.signal’ whether signal condition variable within compute profile upon resolution ‘mirai’. daemon() argument ‘exitlinger’ retired daemons now synchronise host/dispatcher exit soon possible (although default ‘exitlinger’ period still applies ephemeral daemons). Optimises scheduling dispatcher: tasks longer assigned daemon exiting due specified time/task-outs. ‘errorValue’ 19 ‘Connection reset’ now returned ‘mirai’ connection either dispatcher ephemeral daemon drops, example crashed, rather remaining unresolved. Invalid type ‘…’ arguments specified daemons() dispatcher() now raise error early rather attempting launch daemons fail. Eliminates potential crash host process querying status() longer connection dispatcher. Reverts trailing line break added end ‘miraiError’ character string. Moves ‘…’ argument daemons(), dispatcher() daemon() clearly delineate core vs peripheral options. Deprecates Deferred Evaluation Pipe %>>% favour recommendation use package mirai.promises performing side effects upon ‘mirai’ resolution. Deprecated use alias server() daemon() retired. Adds ‘reference’ vignette, incorporating information readme. Requires nanonext >= 0.10.2.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-0100","dir":"Changelog","previous_headings":"","what":"mirai 0.10.0","title":"mirai 0.10.0","text":"CRAN release: 2023-09-16 daemons() gains new argument ‘seed’ set random seed generating streams. daemon() dispatcher() gain argument ‘rs’ takes L’Ecuyer-CMRG random seed. New developer functions nextstream() nextget(), opening interfaces packages extend mirai. Runs R session --vanilla flags efficiency, avoiding lengthy startup configurations (thanks @alexpiper). Straight pass without serialization/unserialization allows higher performance lower memory utilisation. Fixes edge cases status() occasionally failing communicate dispatcher. Fixes edge cases ending session unresolved mirai resulting crash rather clean exit. specifying argument ‘force’ TRUE now immediately regenerates socket returns ongoing mirai ‘errorValue’. allows tasks consistently hang crash cancelled rather repeated new daemon connects. argument ‘’ now required longer defaults 1L. daemons status matrix adds column ‘’ ease use functions saisei() launch_local(). ‘instance’ column now always cumulative - regenerating URL saisei() longer resets counter instead turns negative new daemon connects. Improves shell quoting daemon launch commands, making easier deploy manually via launch_remote(). daemons() dispatcher() gain argument ‘pass’ support password-protected private keys supplying TLS credentials (thanks @wlandau #76). Cryptographic errors using dispatcher TLS now reported user (thanks @wlandau #76). Passing filename ‘tls’ argument daemons(), launch_local() launch_remote() now works correctly documented. Extends clarifies documentation surrounding use certificate authority signed TLS certificates. Certain error messages accurate informative. Increases performance lower resource utilisation due updates nanonext 0.10.0. Requires nanonext >= 0.10.0 R >= 3.5.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-091","dir":"Changelog","previous_headings":"","what":"mirai 0.9.1","title":"mirai 0.9.1","text":"CRAN release: 2023-07-19 Zero-configuration experience - simply specify tls+tcp:// wss:// URL daemons(). Single-use keys certificates automatically generated. Alternatively, custom certificates may passed ‘tls’ argument daemons() daemon(), generated via Ceritficate Signing Request (CSR) Certificate Authority (CA). Example using SSH: launch_remote(\"ws://192.168.0.1:5555\", command = \"ssh\", args = c(\"-p 22 192.168.0.2\", .). Documentation updated refer consistently host daemons (rather client server) clarity. daemon() replaces server(), deprecated (although currently retained alias). launch_local() replaces launch_server() now accepts vector argument ‘url’ well numeric values select relevant dispatcher host URL, returning invisible NULL instead integer value. status() now retrieves connections daemons status, replacing call daemons() arguments (deprecated). return value $daemons now always host URL using dispatcher. Redirection stdout stderr local daemons host process now possible (running without dispatcher) specifying output=TRUE daemons() launch_local(). daemon() accepts new ‘output’ argument. saisei() argument validation now happens prior sending request dispatcher rather dispatcher. ‘miraiError’ now includes trailing line break end character vector. Requires nanonext >= 0.9.1, R requirement relaxed back >= 2.12.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-090","dir":"Changelog","previous_headings":"","what":"mirai 0.9.0","title":"mirai 0.9.0","text":"CRAN release: 2023-06-24 mirai 0.9.0 major release focusing stability improvements. Ensures first URL retains format saisei(= 1L) called. Optimal scheduling tasks submitted prior servers coming online. Fixes rare occasions dispatcher running single server instance get stuck task. daemons() status requests rendered robust. Ensures saisei() always returns NULL ‘tcp://’ URLs used support tokens. Daemons status matrix ‘assigned’ ‘complete’ now cumulative statistics, reset upon new instances. Requires nanonext >= 0.9.0 R >= 3.5.0. Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-087","dir":"Changelog","previous_headings":"","what":"mirai 0.8.7","title":"mirai 0.8.7","text":"CRAN release: 2023-05-11 server() dispatcher() argument ‘asyncdial’ now FALSE default, causing functions exit connection immediately available. means distributed computing purposes, daemons() called server() launched remote resources, else server(asyncdial = TRUE) allows servers wait connection. launch_server() now parses passed URL correctness attempting launch server, producing error valid.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-084","dir":"Changelog","previous_headings":"","what":"mirai 0.8.4","title":"mirai 0.8.4","text":"CRAN release: 2023-05-09 .() implemented wrap piped expression, ensuring return either ‘unresolvedExpr’ ‘resolvedExpr’. expressions may tested using unresolved() way ‘mirai’. allows general use contexts, including within functions. Improved error messages top level evaluation errors ‘mirai’. Requires nanonext >= 0.8.3. Internal stability performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-083","dir":"Changelog","previous_headings":"","what":"mirai 0.8.3","title":"mirai 0.8.3","text":"CRAN release: 2023-04-17 accepts language expression object passed ‘.expr’ evaluation. accepts list ‘name = value’ pairs passed ‘.args’ well existing ‘…’. objects specified via ‘…’ now take precedence ‘.args’ named object appears. token appending unique token URL dispatcher listens . lock locking sockets prevent one server connecting unique URL. saisei() implemented regenerate token used given dispatcher socket. launch_server() replaces launch() launching local instances, simpler interface directly mapping server(). Automatically-launched local daemons revised use unique tokens URLs. Daemons status matrix headers updated ‘online’, ‘instance’, ‘assigned’, ‘complete’. Fixes potential issue attempting use mirai() timeouts connection server. Requires nanonext >= 0.8.2. Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-082","dir":"Changelog","previous_headings":"","what":"mirai 0.8.2","title":"mirai 0.8.2","text":"CRAN release: 2023-04-03 Arguments ‘pollfreqh’ ‘pollfreql’ removed longer applicable. Server dispatcher processes exit automatically connection client dropped. significantly reduces likelihood orphaned processes. launch() exported utility easily re-launching daemons timed , instance. Correct passthrough ... variables daemons() call. Requires nanonext >= 0.8.1. Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-081","dir":"Changelog","previous_headings":"","what":"mirai 0.8.1","title":"mirai 0.8.1","text":"CRAN release: 2023-03-17 Fixes issue daemon processes may launch certain setups (affecting binary package builds).","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-080","dir":"Changelog","previous_headings":"","what":"mirai 0.8.0","title":"mirai 0.8.0","text":"CRAN release: 2023-03-15 mirai 0.8.0 major feature release. Special thanks @wlandau suggestions, discussion testing many new capabilities. daemons() can create new profiles connect different resources e.g. servers GPU, accelerators etc. mirai() tasks can sent using specific compute profile. Supplying client URL zero port number :0 automatically assign free ephemeral port, actual port number subsequently reported daemons(). Calling arguments now provides improved view current number connections / daemons (URL, online busy status, tasks assigned completed, instance), replacing previous daemons(\"view\") functionality. dispatcher() implemented new function dispatcher. asyncdial specify server dials client. maxtasks specifying maximum number tasks exiting. idletime specifying idle time, since completion last task exiting. walltime specifying soft walltime exiting. timerstart specifying minimum number task completions starting timers. Invalid URLs provided daemons() server() now error return immediately instead potentially causing hang. eval_mirai() removed alias mirai(). ‘mirai’ processes longer launched Rscript sessions --vanilla argument enable site / user profile environment files read. Requires nanonext >= 0.8.0. Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-072","dir":"Changelog","previous_headings":"","what":"mirai 0.7.2","title":"mirai 0.7.2","text":"CRAN release: 2023-01-17 Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-071","dir":"Changelog","previous_headings":"","what":"mirai 0.7.1","title":"mirai 0.7.1","text":"CRAN release: 2022-11-15 Allow user interrupts call_mirai() (regression 0.7.0), now returning ‘miraiInterrupt’. Adds auxiliary function is_mirai_interrupt() test object ‘miraiInterrupt’. Requires nanonext >= 0.7.0: returned ‘errorValues’ e.g. mirai timeouts longer accompanied warnings. Internal performance enhancements.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-070","dir":"Changelog","previous_headings":"","what":"mirai 0.7.0","title":"mirai 0.7.0","text":"CRAN release: 2022-10-19 daemons() now takes ‘n’ ‘.url’ arguments. ‘.url’ optional client URL allowing mirai tasks distributed across network. Compatibility existing interface retained. server function server() exported creating daemon / ephemeral processes network resources. Mirai errors formatted better now print stdout rather stderr. Improvements performance stability requiring nanonext >= 0.6.0. Internal enhancements error handling mirai / daemon process.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-060","dir":"Changelog","previous_headings":"","what":"mirai 0.6.0","title":"mirai 0.6.0","text":"CRAN release: 2022-09-16 Notice: older package versions longer supported ‘nanonext’ >= 0.6.0. Please ensure using latest version ‘mirai’ else refrain upgrading ‘nanonext’. Internal enhancements daemons() %>>% deferred evaluation pipe.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-053","dir":"Changelog","previous_headings":"","what":"mirai 0.5.3","title":"mirai 0.5.3","text":"CRAN release: 2022-08-16 mirai() gains ‘.args’ argument passing list objects already calling environment, allowing example mirai(func(x, y, z), .args = list(x, y, z)) rather specify mirai(func(x, y, z), x = x, y = y, z = z). Errors inside mirai now return error message character string class ‘miraiError’ ‘errorValue’, rather just nul byte. Utility function is_mirai_error() used place is_nul_byte(), longer re-exported. is_error_value() can used test errors, including timeouts ‘.timeout’ argument used. re-exports ‘nanonext’ brought -package better documentation.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-052","dir":"Changelog","previous_headings":"","what":"mirai 0.5.2","title":"mirai 0.5.2","text":"CRAN release: 2022-07-21 Internal optimisations requiring nanonext >= 0.5.2.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-050","dir":"Changelog","previous_headings":"","what":"mirai 0.5.0","title":"mirai 0.5.0","text":"CRAN release: 2022-06-21 Implements %>>% deferred evaluation pipe. Adds ‘.timeout’ argument mirai() ensure mirai always resolves even child process crashes etc.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-041","dir":"Changelog","previous_headings":"","what":"mirai 0.4.1","title":"mirai 0.4.1","text":"CRAN release: 2022-04-21 Exits cleanly daemons explicitly zeroed prior ending R session. Fixes possible hang Windows shutting daemons.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-040","dir":"Changelog","previous_headings":"","what":"mirai 0.4.0","title":"mirai 0.4.0","text":"CRAN release: 2022-04-14 Back pure R implementation thanks enhanced internal design nanonext. Adds auxiliary function is_mirai() test object mirai. Versioning system synchronise nanonext e.g. v0.4.x requires nanonext >= 0.4.0.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-020","dir":"Changelog","previous_headings":"","what":"mirai 0.2.0","title":"mirai 0.2.0","text":"CRAN release: 2022-03-28 value mirai now stored $data optimally align underlying implementation. Package now contains C code (requires compilation), using weak references simpler management resources. Switch abstract sockets Linux.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-011","dir":"Changelog","previous_headings":"","what":"mirai 0.1.1","title":"mirai 0.1.1","text":"CRAN release: 2022-03-15 mirai() added alias eval_mirai(); supports evaluating arbitrary length expressions wrapped {}. mirai now resolves automatically without requiring call_mirai(). Access $value directly ‘unresolved’ logical NA returned async operation yet complete. stop_mirai() added function stop evaluation ongoing async operation. Auxiliary functions is_nul_byte() unresolved() re-exported {nanonext} test evaluation errors resolution ‘mirai’ respectively. New daemons() interface set manage persistent background processes receiving ‘mirai’ requests.","code":""},{"path":"https://mirai.r-lib.org/dev/news/index.html","id":"mirai-010","dir":"Changelog","previous_headings":"","what":"mirai 0.1.0","title":"mirai 0.1.0","text":"CRAN release: 2022-02-16 Initial release.","code":""}]
