<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>mirai - Minimalist Async Evaluation Framework for R • mirai</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="mirai - Minimalist Async Evaluation Framework for R">
<meta name="robots" content="noindex">
<script defer data-domain="mirai.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirai</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/mirai.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/mirai-map.html">Mirai Map</a></li>
    <li><a class="dropdown-item" href="../articles/mirai-promises.html">Promises - Shiny and Plumber</a></li>
    <li><a class="dropdown-item" href="../articles/mirai-serialization.html">Serialization - Arrow, ADBC, polars, torch</a></li>
    <li><a class="dropdown-item" href="../articles/mirai-xparallel.html">Communications Backend for R</a></li>
    <li><a class="dropdown-item" href="../articles/packages.html">For Package Authors</a></li>
    <li><a class="dropdown-item" href="../articles/questions.html">Community FAQs</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/mirai/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>mirai - Minimalist Async Evaluation Framework for R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/mirai/blob/main/vignettes/mirai.Rmd" class="external-link"><code>vignettes/mirai.Rmd</code></a></small>
      <div class="d-none name"><code>mirai.Rmd</code></div>
    </div>

    
    
<p>This is a reference vignette of the package’s core functionality.
Other package vignettes cover additional features.</p>
<div class="section level3">
<h3 id="the-mirai-concept">1. The mirai Concept<a class="anchor" aria-label="anchor" href="#the-mirai-concept"></a>
</h3>
<p>mirai (Japanese for ‘future’) implements the concept of
<em>futures</em> in R.</p>
<p>Futures are an abstraction that represent the result of code
evaluation that will be available at some point in the future. The
actual code evaluation is sent to and performed in a separate R process
(<em>daemon</em>), and the result is sent back to the main
(<em>host</em>) process when it completes.</p>
<p>The package has one main function: <code><a href="../reference/mirai.html">mirai()</a></code> to create a
mirai object.</p>
<p>This function returns almost immediately, and is never blocking. This
is the essence of async: whilst the mirai evaluation is ongoing on the
daemon, the host R process is free to continue with other things.</p>
<p>As the mirai expression is sent to another process, it must be
self-contained. This means that any functions and variables used in it
must be available in that process as well. This requires that:</p>
<ul>
<li>Package functions be namespaced using <code>::</code>, or
<code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> calls be made within the expression.</li>
<li>Other functions/data/objects required by the expression should be
passed via <code>...</code> or <code>.args</code> to be sent along to
the daemon.</li>
</ul>
<p>A mirai is either <em>unresolved</em> if the result has yet to be
received, or <em>resolved</em> if it has. <code><a href="../reference/unresolved.html">unresolved()</a></code> is a
helper function to check the state of a mirai.</p>
<p>For a mirai <code>m</code>, the result is available at
<code>m$data</code> once it has resolved. Normally this will be the
return value of the evaluated expression. If the expression errored,
caused the process to crash, or timed out then this will be an
‘errorValue’ instead. See the section <a href="#errors-in-a-mirai">Errors in a mirai</a> below.</p>
<p>Rather than repeatedly checking <code>unresolved(m)</code>, it is
more efficient to wait for and collect its value by using
<code>m[]</code>.</p>
<p>When a developer or code author writes a <code><a href="../reference/mirai.html">mirai()</a></code> call,
they should not be concerned about where or how execution of that code
actually happens. It is simply meant to be executed on the resources
that are available to it at the time it is run.</p>
<p>Instead, it is for the end-user running the code to declare the
resources available for evaluating mirai calls. This is done using the
package’s other main function: <code><a href="../reference/daemons.html">daemons()</a></code>.</p>
<p>If daemons have not been set, each <code><a href="../reference/mirai.html">mirai()</a></code> call will by
default create a new local background process (<em>ephemeral
daemon</em>) on which to perform its evaluation.</p>
<p>Instead, <code><a href="../reference/daemons.html">daemons()</a></code> sets up persistent daemons on which
to evaluate mirai expressions.</p>
<ul>
<li>Using persistent daemons eliminates the time and overhead of
starting new processes for each evaluation, and limits the number of
processes used at any one time.</li>
<li>Even re-using the same daemon, cleanup steps performed between
evaluations ensure that each mirai continues to be self-contained and
unaffected by past evaluations.</li>
</ul>
<p>How to set up and launch daemons is covered in sections below,
starting with <a href="#local-daemons">local daemons</a>.</p>
</div>
<div class="section level3">
<h3 id="example-use-cases">2. Example Use Cases<a class="anchor" aria-label="anchor" href="#example-use-cases"></a>
</h3>
<div class="section level4">
<h4 id="parallelize-compute-intensive-tasks">Parallelize compute-intensive tasks<a class="anchor" aria-label="anchor" href="#parallelize-compute-intensive-tasks"></a>
</h4>
<p>Multiple long computes (model fits etc.) can be performed in parallel
on available computing cores.</p>
<p>The following mimics an expensive calculation that eventually returns
a random value.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mirai.r-lib.org">mirai</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">2L</span>, mean <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  time <span class="op">=</span> <span class="va">args</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  mean <span class="op">=</span> <span class="va">args</span><span class="op">$</span><span class="va">mean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span></span>
<span><span class="co">#&gt; &lt; mirai [] &gt;</span></span>
<span><span class="va">m</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; 'unresolved' logi NA</span></span>
<span><span class="fu"><a href="../reference/unresolved.html">unresolved</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Do other stuff</span></span>
<span></span>
<span><span class="fu"><a href="../reference/collect_mirai.html">collect_mirai</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.171449 2.518936 5.100663 4.802009 4.847599</span></span>
<span><span class="va">m</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 3.171449 2.518936 5.100663 4.802009 4.847599</span></span></code></pre></div>
<p>For easy programmatic use of <code><a href="../reference/mirai.html">mirai()</a></code>, ‘.expr’ accepts a
pre-constructed language object, and also a list of named arguments
passed via ‘.args’. So, the following would be equivalent to the
above:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="va">mean</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">2L</span>, mean <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span>.expr <span class="op">=</span> <span class="va">expr</span>, .args <span class="op">=</span> <span class="va">args</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span>.expr <span class="op">=</span> <span class="va">expr</span>, .args <span class="op">=</span> <span class="va">args</span><span class="op">)</span></span>
<span><span class="va">m1</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 3.045729 2.936203 4.315945 3.302699 6.096261</span></span>
<span><span class="va">m2</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 3.848957 4.245206 4.324884 4.337941 5.008054</span></span></code></pre></div>
<p>By running the above two calculations in parallel, they take roughly
half the time as running sequentially (minus a relatively
inconsequential parallelization overhead).</p>
</div>
<div class="section level4">
<h4 id="unblock-io-bound-operations">Unblock I/O-bound Operations<a class="anchor" aria-label="anchor" href="#unblock-io-bound-operations"></a>
</h4>
<p>Problem: high-frequency real-time data cannot be written to
file/database synchronously without disrupting the execution flow of
ingesting the data.</p>
<p>Solution: cache data in memory and use <code><a href="../reference/mirai.html">mirai()</a></code> to
perform periodic write operations asynchronously from a separate
process.</p>
<p>Below, ‘.args’ is used to pass <code><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment()</a></code>, which is
the calling environment. This provides a convenient method of passing in
existing objects, as as the <code>x</code> and <code>file</code>
arguments to the <code>write.cv.async()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mirai.r-lib.org">mirai</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">write.cv.async</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">file</span><span class="op">)</span>, .args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">write.cv.async</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="../reference/unresolved.html">unresolved</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Writing file...\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Writing file...</span></span>
<span><span class="co">#&gt; Writing file...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Write complete:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Write complete: TRUE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="resilient-pipelines">Resilient Pipelines<a class="anchor" aria-label="anchor" href="#resilient-pipelines"></a>
</h4>
<p>Code that can potentially fail is isolated in a separate process to
ensure continued uptime.</p>
<p>As part of a data science / machine learning pipeline, iterations of
model training may periodically fail for stochastic reasons
(e.g. problematic graphics cards memory management).</p>
<p>Running each iteration in a mirai isolates this potentially
problematic code such that it doesn’t bring down the entire pipeline,
even if it fails.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mirai.r-lib.org">mirai</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">run_iteration</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># simulates a stochastic error rate</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"random error\n"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"iteration %d successful\n"</span>, <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu">run_iteration</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="../reference/is_mirai_error.html">is_error_value</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span>    <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu">run_iteration</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; iteration 1 successful</span></span>
<span><span class="co">#&gt; iteration 2 successful</span></span>
<span><span class="co">#&gt; iteration 3 successful</span></span>
<span><span class="co">#&gt; iteration 4 successful</span></span>
<span><span class="co">#&gt; iteration 5 successful</span></span>
<span><span class="co">#&gt; iteration 6 successful</span></span>
<span><span class="co">#&gt; iteration 7 successful</span></span>
<span><span class="co">#&gt; iteration 8 successful</span></span>
<span><span class="co">#&gt; iteration 9 successful</span></span>
<span><span class="co">#&gt; iteration 10 successful</span></span></code></pre></div>
<p>By testing the return value of each mirai for errors, error-handling
code is able to automate recovery and re-attempts, as above. The result
is a resilient and fault-tolerant pipeline that minimizes downtime by
eliminating interruptions of long computes.</p>
</div>
</div>
<div class="section level3">
<h3 id="errors-in-a-mirai">3. Errors in a mirai<a class="anchor" aria-label="anchor" href="#errors-in-a-mirai"></a>
</h3>
<p>If execution in a mirai fails, the error message is returned as a
character string of class ‘miraiError’ and ‘errorValue’ to facilitate
debugging.</p>
<p><code><a href="../reference/is_mirai_error.html">is_mirai_error()</a></code> may be used to test for mirai execution
errors.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"occurred with a custom message"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m1</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; 'miraiError' chr Error: occurred with a custom message</span></span>
<span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu">mirai</span><span class="fu">::</span><span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m2</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; 'miraiError' chr Error in mirai::mirai(): missing expression, perhaps wrap in {}?</span></span>
<span></span>
<span><span class="fu"><a href="../reference/is_mirai_error.html">is_mirai_error</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/is_mirai_error.html">is_error_value</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>A full stack trace of evaluation within the mirai is recorded and
accessible at <code>$stack.trace</code> on the error object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"positive"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="op">{</span><span class="fu">f</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>; <span class="fu">f</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>, f <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span><span class="va">m3</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; 'miraiError' chr Error in f(1): positive</span></span>
<span></span>
<span><span class="va">m3</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">stack.trace</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; stop("positive")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; f(1)</span></span></code></pre></div>
<p>Elements of the original error condition are also accessible via
<code>$</code> on the error object. For example, additional metadata
recorded by <code><a href="https://rlang.r-lib.org/reference/abort.html" class="external-link">rlang::abort()</a></code> is preserved:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"positive"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/abort.html" class="external-link">abort</a></span><span class="op">(</span><span class="st">"aborted"</span>, meta_uid <span class="op">=</span> <span class="st">"UID001"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m4</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; 'miraiError' chr Error: aborted</span></span>
<span></span>
<span><span class="va">m4</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">meta_uid</span></span>
<span><span class="co">#&gt; [1] "UID001"</span></span></code></pre></div>
<p>If a daemon instance is sent a user interrupt, the mirai will resolve
to an object of class ‘miraiInterrupt’ and ‘errorValue’.</p>
<p><code><a href="../reference/is_mirai_error.html">is_mirai_interrupt()</a></code> may be used to test for such
interrupts.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/interrupt.html" class="external-link">interrupt</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># simulates a user interrupt</span></span>
<span><span class="fu"><a href="../reference/is_mirai_error.html">is_mirai_interrupt</a></span><span class="op">(</span><span class="va">m4</span><span class="op">[</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>If execution of a mirai surpasses the timeout set via the ‘.timeout’
argument, the mirai will resolve to an ‘errorValue’ of 5L (timed out).
This can, amongst other things, guard against mirai processes that have
the potential to hang and never return.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu">nanonext</span><span class="fu">::</span><span class="fu"><a href="https://nanonext.r-lib.org/reference/msleep.html" class="external-link">msleep</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, .timeout <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">m5</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; 'errorValue' int 5 | Timed out</span></span>
<span></span>
<span><span class="fu"><a href="../reference/is_mirai_error.html">is_mirai_error</a></span><span class="op">(</span><span class="va">m5</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/is_mirai_error.html">is_mirai_interrupt</a></span><span class="op">(</span><span class="va">m5</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/is_mirai_error.html">is_error_value</a></span><span class="op">(</span><span class="va">m5</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><code><a href="../reference/is_mirai_error.html">is_error_value()</a></code> tests for all mirai execution errors,
user interrupts and timeouts.</p>
</div>
<div class="section level3">
<h3 id="local-daemons">4. Local Daemons<a class="anchor" aria-label="anchor" href="#local-daemons"></a>
</h3>
<p>Daemons, or persistent background processes, may be set to receive
‘mirai’ requests.</p>
<blockquote>
<p>Daemons inherit the default system configuration and read in the
relevant ‘.Renviron’ and ‘.Rprofile’ etc. on startup. They also load the
default packages. To instead only load the <code>base</code> package
(which cuts out more than half of R’s startup time), the environment
variable <code>R_SCRIPT_DEFAULT_PACKAGES=NULL</code> may be set prior to
launching daemons.</p>
</blockquote>
<div class="section level4">
<h4 id="with-dispatcher-default">With Dispatcher (default)<a class="anchor" aria-label="anchor" href="#with-dispatcher-default"></a>
</h4>
<p>Call <code><a href="../reference/daemons.html">daemons()</a></code> specifying the number of daemons to
launch.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>The default <code>dispatcher = TRUE</code> creates a
<code><a href="../reference/dispatcher.html">dispatcher()</a></code> background process that connects to individual
daemon processes on the local machine. This ensures that tasks are
dispatched efficiently on a first-in first-out (FIFO) basis to daemons
for processing. Tasks are queued at dispatcher and sent to a daemon as
soon as it can accept the task for immediate execution. Dispatcher
employs an event-driven approach that is efficient both in terms of
consuming no resources while waiting, whilst also being fully
synchronized with events.</p>
<p>To view the current status, <code><a href="../reference/status.html">status()</a></code> provides:</p>
<ol style="list-style-type: decimal">
<li>The number of active connections,</li>
<li>The URL daemons connect to, and</li>
<li>A task summary:</li>
</ol>
<ul>
<li>
<code>waiting</code> number of tasks queued for execution at
dispatcher</li>
<li>
<code>assigned</code> number of tasks sent to a daemon for
execution</li>
<li>
<code>complete</code> number of tasks for which the result has been
received (either completed or cancelled)</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $connections</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $daemons</span></span>
<span><span class="co">#&gt; [1] "ipc:///tmp/9692d9ac2f065c50bb16e481"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mirai</span></span>
<span><span class="co">#&gt;  awaiting executing completed </span></span>
<span><span class="co">#&gt;         0         0         0</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Set the number of daemons to zero to reset. This reverts to the
default of creating a new background process for each ‘mirai’
request.</p>
</div>
<div class="section level4">
<h4 id="without-dispatcher">Without Dispatcher<a class="anchor" aria-label="anchor" href="#without-dispatcher"></a>
</h4>
<p>Alternatively, specifying <code>dispatcher = FALSE</code>, the
background daemons connect directly to the host process.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">6</span>, dispatcher <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>This means that tasks are sent immediately in a round-robin fashion,
which ensures that they are evenly-distributed amongst daemons. This
does not however guarantee optimal scheduling, as the duration of tasks
cannot be known <em>a priori</em>. As an example, tasks could be queued
at a daemon behind a long-running task, whilst other daemons are idle
having already completed their tasks.</p>
<p>The advantage of this approach is that it is resource-light and does
not require an additional dispatcher process. It is suited to working
with similar-length tasks, or where concurrent tasks typically do not
exceed available daemons.</p>
<p>Requesting the status now shows 6 connections, along with the host
URL:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $connections</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $daemons</span></span>
<span><span class="co">#&gt; [1] "ipc:///tmp/cb135b871d004dfd18dd5ee6"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="everywhere">Everywhere<a class="anchor" aria-label="anchor" href="#everywhere"></a>
</h4>
<p><code><a href="../reference/everywhere.html">everywhere()</a></code> may be used to evaluate an expression on
all connected daemons and persist the resultant state, regardless of a
daemon’s ‘cleanup’ setting.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/everywhere.html">everywhere</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The above keeps the <a href="https://dbi.r-dbi.org/" class="external-link"><code>DBI</code></a> package loaded for
all evaluations. Other types of setup task may also be performed,
including making a common resource available, such as a database
connection:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/everywhere.html">everywhere</a></span><span class="op">(</span><span class="va">con</span> <span class="op">&lt;&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">SQLite</span><span class="op">(</span><span class="op">)</span>, <span class="va">file</span><span class="op">)</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>By super-assignment, the conenction ‘con’ will be available in the
global environment of all daemon instances. Subsequent mirai calls may
then make use of ‘con’.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mirai.html">mirai</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"con"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Disconnect from the database everywhere:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/everywhere.html">everywhere</a></span><span class="op">(</span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">con</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Sometimes it may be necessary to evaluate an expression in the global
environment of each daemon. As mirai evaluation does not occur in the
global environment itself, but one inheriting from it, an explicit call
to <code>evalq(envir = .GlobalEnv)</code> achieves this. An example use
case is <code>box::use()</code> to import a module or package:</p>
</blockquote>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/everywhere.html">everywhere</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">evalq</a></span><span class="op">(</span></span>
<span>    <span class="fu">box</span><span class="fu">::</span><span class="fu">use</span><span class="op">(</span><span class="va">dplyr</span><span class="op">[</span><span class="va">select</span><span class="op">]</span>, <span class="va">mirai</span><span class="op">[</span><span class="va">...</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    envir <span class="op">=</span> <span class="va">.GlobalEnv</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="with-method">With Method<a class="anchor" aria-label="anchor" href="#with-method"></a>
</h4>
<p><code><a href="../reference/daemons.html">daemons()</a></code> has a <code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code> method, which
evaluates an expression with daemons created for the duration of the
expression and automatically torn down upon completion.</p>
<p>It was originally designed for running a Shiny app with the desired
number of daemons, as in the example below:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Note: it is assumed the app is already created. Wrapping a call to
<code><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shiny::shinyApp()</a></code> would not work as <code><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp()</a></code>
is implicitly called when the app is printed, however printing occurs
only after <code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code> has returned, hence the app would run
outside of the scope of the <code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code> statement.</p>
</blockquote>
<p>In the case of a Shiny app, all mirai calls will be executed before
the app returns as the app itself is blocking. In the case of other
expressions, be sure to call the results (or collect the values) of all
mirai within the expression to ensure that they all complete before the
daemons are torn down.</p>
<p>If specifying a <a href="#compute-profiles">compute profile</a> for
the <code><a href="../reference/daemons.html">daemons()</a></code> call, all calls with
<code>.compute = NULL</code> within the <code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code> clause will
default to this compute profile.</p>
</div>
</div>
<div class="section level3">
<h3 id="remote-daemons">5. Remote Daemons<a class="anchor" aria-label="anchor" href="#remote-daemons"></a>
</h3>
<p>The daemons interface may also be used to send tasks for computation
to remote daemon processes on the network.</p>
<p>Call <code><a href="../reference/daemons.html">daemons()</a></code> specifying ‘url’ as a character string
such as: ‘tcp://10.75.32.70:5555’ at which daemon processes should
connect. Alternatively, use <code><a href="../reference/host_url.html">host_url()</a></code> to automatically
construct a valid URL. The host (or dispatcher) listens at this address,
utilising a single port.</p>
<blockquote>
<p>IPv6 addresses are also supported and must be enclosed in square
brackets <code>[]</code> to avoid confusion with the final colon
separating the port. For example, port 5555 on the IPv6 address
<code>::ffff:a6f:50d</code> would be specified as
<code>tcp://[::ffff:a6f:50d]:5555</code>.</p>
</blockquote>
<p>For options on actually launching the daemons, please see the next
section.</p>
<p>Below, calling <code><a href="../reference/host_url.html">host_url()</a></code> without a port value uses the
default of ‘0’. This is a wildcard value that will automatically assigns
a free ephemeral port:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span>url <span class="op">=</span> <span class="fu"><a href="../reference/host_url.html">host_url</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>The actual assigned port may be queried at any time via
<code><a href="../reference/status.html">status()</a></code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $connections</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $daemons</span></span>
<span><span class="co">#&gt; [1] "tcp://10.37.58.114:50816"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mirai</span></span>
<span><span class="co">#&gt;  awaiting executing completed </span></span>
<span><span class="co">#&gt;         0         0         0</span></span></code></pre></div>
<p>The number of daemons connected at any time may be dynamically scaled
up or down, according to requirements.</p>
<p>To reset all connections and revert to default behaviour:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Closing the connection causes all connected daemons to exit
automatically. If using dispatcher, it will cause dispatcher to exit,
and in turn all connected daemons when their respective connections with
the dispatcher are terminated.</p>
</div>
<div class="section level3">
<h3 id="launching-remote-daemons">6. Launching Remote Daemons<a class="anchor" aria-label="anchor" href="#launching-remote-daemons"></a>
</h3>
<p>The launcher analogy is appropriate, as they are ways to execute a
daemon on the machine of your choice, very much like launching a
satellite. Once deployed, the daemon connects back to your host process
through it’s own communications (TCP or TLS over TCP).</p>
<p>The local launcher simply runs an <code>Rscript</code> instance via a
local shell. The remote launcher uses a method to run this
<code>Rscript</code> command on a remote machine.</p>
<p>To launch remote daemons, supply a remote launch configuration to the
‘remote’ argument of <code><a href="../reference/daemons.html">daemons()</a></code>, or
<code><a href="../reference/launch_local.html">launch_remote()</a></code> at any time thereafter.</p>
<p>There are currently 3 options for generating remote launch
configurations:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/ssh_config.html">ssh_config()</a></code> where there is SSH access to the remote
machine.</li>
<li>
<code><a href="../reference/cluster_config.html">cluster_config()</a></code> to use HPC cluster resource managers
such as Slurm, SGE, Torque/PBS and LSF.</li>
<li>
<code><a href="../reference/remote_config.html">remote_config()</a></code> for a generic, flexible method that
caters for other custom launchers.</li>
</ol>
<p>The return value of all of these functions is a simple list. This
means that they may be pre-constructed, saved and re-used whenever the
same configuration is required.</p>
<div class="section level4">
<h4 id="i--ssh-direct-connection">i. SSH Direct Connection<a class="anchor" aria-label="anchor" href="#i--ssh-direct-connection"></a>
</h4>
<p>This method is appropriate for internal networks and in trusted,
properly-configured environments where it is safe for your machine to
accept incoming connections on certain ports. In the examples below, the
remote daemons connect back directly to port 5555 on the local
machine.</p>
<p>In these cases, using TLS is often desirable to provide additional
security to the connections.</p>
<p>The first example below launches 4 daemons on the machine 10.75.32.90
(using the default SSH port of 22 as this was not specified), connecting
back to the host URL:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  url <span class="op">=</span> <span class="fu"><a href="../reference/host_url.html">host_url</a></span><span class="op">(</span>tls <span class="op">=</span> <span class="cn">TRUE</span>, port <span class="op">=</span> <span class="fl">5555</span><span class="op">)</span>,</span>
<span>  remote <span class="op">=</span> <span class="fu"><a href="../reference/ssh_config.html">ssh_config</a></span><span class="op">(</span><span class="st">"ssh://10.75.32.90"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The second example below launches one daemon on each of 10.75.32.90
and 10.75.32.91 using the custom SSH port of 222:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  url <span class="op">=</span> <span class="fu"><a href="../reference/host_url.html">host_url</a></span><span class="op">(</span>tls <span class="op">=</span> <span class="cn">TRUE</span>, port <span class="op">=</span> <span class="fl">5555</span><span class="op">)</span>,</span>
<span>  remote <span class="op">=</span> <span class="fu"><a href="../reference/ssh_config.html">ssh_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ssh://10.75.32.90:222"</span>, <span class="st">"ssh://10.75.32.91:222"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ii--ssh-tunnelling">ii. SSH Tunnelling<a class="anchor" aria-label="anchor" href="#ii--ssh-tunnelling"></a>
</h4>
<p>Use SSH tunnelling to launch daemons on any machine you are able to
access via SSH, whether on the local network or the cloud. SSH key-based
authentication must already be in place, but no other configuration is
required.</p>
<p>This provides a convenient way to launch remote daemons without them
needing to directly access the host. Firewall configurations or security
policies often prevent opening a port to accept outside connections. In
these cases, SSH tunnelling creates a tunnel once the initial SSH
connection is made. For simplicity, the implementation in mirai uses the
same tunnel port on both the host and daemon.</p>
<p>To use tunnelling, supply a URL with hostname of ‘127.0.0.1’ to ‘url’
for the <code><a href="../reference/daemons.html">daemons()</a></code> call.</p>
<ul>
<li>
<code>local_url(tcp = TRUE)</code> does this for you.</li>
<li>The default uses the wildcard port of ‘0’, which assigns a free
ephemeral port.</li>
<li>Whilst convenient, there is a small possibility that this port may
not be available on all daemons.</li>
<li>It is hence preferable to specify a specific port that has been
whitelisted for use, where possible.</li>
</ul>
<p>For example, if <code>local_url(tcp = TRUE, port = 5555)</code> is
specified, the tunnel is created using port 5555 on each machine. The
host listens to <code>127.0.0.1:5555</code> on its side, and the daemons
each dial into <code>127.0.0.1:5555</code> on their own respective
machines.</p>
<p>The below example launches 2 daemons on the remote machine
10.75.32.90 using SSH tunnelling:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  url <span class="op">=</span> <span class="fu"><a href="../reference/host_url.html">local_url</a></span><span class="op">(</span>tcp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  remote <span class="op">=</span> <span class="fu"><a href="../reference/ssh_config.html">ssh_config</a></span><span class="op">(</span><span class="st">"ssh://10.75.32.90"</span>, tunnel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="iii--hpc-cluster-resource-managers">iii. HPC Cluster Resource Managers<a class="anchor" aria-label="anchor" href="#iii--hpc-cluster-resource-managers"></a>
</h4>
<p><code><a href="../reference/cluster_config.html">cluster_config()</a></code> may be used to deploy daemons using a
cluster resource manager / scheduler.</p>
<ol style="list-style-type: decimal">
<li>The first argument is <code>command</code>. This should be:</li>
</ol>
<ul>
<li>
<code>"sbatch"</code> if using Slurm</li>
<li>
<code>"qsub"</code> if using SGE / Torque / PBS</li>
<li>
<code>"bsub"</code> if using LSF.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>The second argument <code>options</code> are any options that you
would normally supply in a shell script to pass to the scheduler. These
are script lines typically preceded by a <code>#</code>.</li>
</ol>
<pre><code><span>  <span class="va">Slurm</span><span class="op">:</span> <span class="st">"#SBATCH --job-name=mirai</span></span>
<span><span class="st">          #SBATCH --mem=10G</span></span>
<span><span class="st">          #SBATCH --output=job.out"</span></span>
<span>  <span class="va">SGE</span><span class="op">:</span> <span class="st">"#$ -N mirai</span></span>
<span><span class="st">        #$ -l mem_free=10G</span></span>
<span><span class="st">        #$ -o job.out"</span></span>
<span>  <span class="va">Torque</span><span class="op">/</span><span class="va">PBS</span><span class="op">:</span> <span class="st">"#PBS -N mirai</span></span>
<span><span class="st">               #PBS -l mem=10gb</span></span>
<span><span class="st">               #PBS -o job.out"</span></span>
<span>  <span class="va">LSF</span><span class="op">:</span> <span class="st">"#BSUB -J mirai</span></span>
<span><span class="st">        #BSUB -M 10000</span></span>
<span><span class="st">        #BSUB -o job.out"</span></span></code></pre>
<ul>
<li>As per the above, it is fine to pass this as a character string with
the options each on a new line (whitespace is automatically handled), or
else by explicitly using <code>\n</code> to denote a newline.</li>
<li>It is also permissible to include other shell commands, for example
to change working directory.</li>
<li>For the avoidance of doubt, the initial shebang line of a script
such as <code>#!/bin/bash</code> is not required.</li>
<li>For certain HPC setups, a final line which loads environment modules
may be needed. This would usually be of the form:</li>
</ul>
<pre><code>module load R</code></pre>
<p>or for a specific R version:</p>
<pre><code>module load R/4.5.0</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>The third argument <code>rscript</code> defaults to
<code>"Rscript"</code>, which assumes that R is on the file search path.
This may be substituted for the full path to a specific R executable,
such as that returned by
<code>file.path(R.home("bin"), "Rscript")</code>.</li>
</ol>
</div>
<div class="section level4">
<h4 id="iv--generic-remote-configuration">iv. Generic Remote Configuration<a class="anchor" aria-label="anchor" href="#iv--generic-remote-configuration"></a>
</h4>
<p><code><a href="../reference/remote_config.html">remote_config()</a></code> provides a generic, flexible framework
for running any shell command that may be used to deploy daemons.</p>
<p>Conceptually, this function takes an <code>args</code> argument,
which must contain “.”. The correctly-configured call to
<code><a href="../reference/daemon.html">daemon()</a></code> is substituted in for this “.”, so that
<code>command</code> is run with this as one of its arguments.</p>
<p>This can provide an alternative for cluster resource managers in
certain cases, although <code><a href="../reference/cluster_config.html">cluster_config()</a></code> provides an easier
and more complete interface. Using Slurm as an example, the following
uses <code>sbatch</code> to launch a daemon on the cluster, with some
additional Slurm options passed via command line arguments to
<code>sbatch</code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  url <span class="op">=</span> <span class="fu"><a href="../reference/host_url.html">host_url</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  remote <span class="op">=</span> <span class="fu"><a href="../reference/remote_config.html">remote_config</a></span><span class="op">(</span></span>
<span>    command <span class="op">=</span> <span class="st">"sbatch"</span>,</span>
<span>    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"--mem 512"</span>, <span class="st">"-n 1"</span>, <span class="st">"--wrap"</span>, <span class="st">"."</span><span class="op">)</span>,</span>
<span>    rscript <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Rhome.html" class="external-link">R.home</a></span><span class="op">(</span><span class="st">"bin"</span><span class="op">)</span>, <span class="st">"Rscript"</span><span class="op">)</span>,</span>
<span>    quote <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="v--manual-deployment">v. Manual Deployment<a class="anchor" aria-label="anchor" href="#v--manual-deployment"></a>
</h4>
<p>As an alternative to automated launches, calling
<code><a href="../reference/launch_local.html">launch_remote()</a></code> without specifying ‘remote’ may be used to
return the shell commands for deploying daemons manually.</p>
<p>The printed return values may then be copy / pasted directly to a
remote machine e.g. via a terminal session.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span>url <span class="op">=</span> <span class="fu"><a href="../reference/host_url.html">host_url</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="../reference/launch_local.html">launch_remote</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]</span></span>
<span><span class="co">#&gt; Rscript -e 'mirai::daemon("tcp://10.37.58.114:50820")'</span></span>
<span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="tls-secure-connections">7. TLS Secure Connections<a class="anchor" aria-label="anchor" href="#tls-secure-connections"></a>
</h3>
<p>TLS provides a robust solution for securing communications from the
local machine to remote daemons.</p>
<div class="section level4">
<h4 id="automatic-zero-configuration-default">Automatic Zero-configuration Default<a class="anchor" aria-label="anchor" href="#automatic-zero-configuration-default"></a>
</h4>
<p>Simply specify a secure URL using the scheme <code>tls+tcp://</code>
when setting daemons, or use <code>host_url(tls = TRUE)</code>, for
example:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span>url <span class="op">=</span> <span class="fu"><a href="../reference/host_url.html">host_url</a></span><span class="op">(</span>tls <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Single-use keys and certificates are automatically generated and
configured, without requiring any further intervention. The private key
is always retained on the host machine and never transmitted.</p>
<p>The generated self-signed certificate is available via
<code><a href="../reference/launch_local.html">launch_remote()</a></code>, where it is included as part of the shell
command for manually launching a daemon on a remote machine.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/launch_local.html">launch_remote</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]</span></span>
<span><span class="co">#&gt; Rscript -e 'mirai::daemon("tls+tcp://10.37.58.114:50824",tls=c("-----BEGIN CERTIFICATE-----</span></span>
<span><span class="co">#&gt; MIIFPzCCAyegAwIBAgIBATANBgkqhkiG9w0BAQsFADA3MRUwEwYDVQQDDAwxMC4z</span></span>
<span><span class="co">#&gt; Ny41OC4xMTQxETAPBgNVBAoMCE5hbm9uZXh0MQswCQYDVQQGEwJKUDAeFw0wMTAx</span></span>
<span><span class="co">#&gt; MDEwMDAwMDBaFw0zMDEyMzEyMzU5NTlaMDcxFTATBgNVBAMMDDEwLjM3LjU4LjEx</span></span>
<span><span class="co">#&gt; NDERMA8GA1UECgwITmFub25leHQxCzAJBgNVBAYTAkpQMIICIjANBgkqhkiG9w0B</span></span>
<span><span class="co">#&gt; AQEFAAOCAg8AMIICCgKCAgEAswpXuhaKrn95sz8K4TbwfjgLhOLCCx2zM/oVPld/</span></span>
<span><span class="co">#&gt; k+rXhJG9+Pu85GGcsbgFuyx7iPcRoDb4oeSo6PGFEFIXyDODkxo6h9OPllDBq+cd</span></span>
<span><span class="co">#&gt; Q5KjihwxANgVR1MLiCA6DsLvRhznCid9wSoAFttLRFstZOZHFcRIuIUB9hZzd7U4</span></span>
<span><span class="co">#&gt; F8v3IxA/vxCYWKPgV7IXyke8zD9rTDUrCQngq9jGr3Hq+pCqqzofbxm09DPvzx1l</span></span>
<span><span class="co">#&gt; clelJV7Q3UzMogIFH3WYBizBM7QVQSMOl4F1KiXl4g/86Kw4lP1LVJJe+gVcf4Wd</span></span>
<span><span class="co">#&gt; cJI/P63SlURmiO54OsXoMPeGYo1DQPZX8/V7uIfspUPYvlMiOu5S/Wb07N430D3L</span></span>
<span><span class="co">#&gt; GIoJY+UYJmOFCH8rSVI8HUd+W3LVVc2Qj6bcrClhIAzw9+uvUunZMDwTb8mpnywG</span></span>
<span><span class="co">#&gt; MCJNl2NBeKYAjhBQA1cgEgzyjByg8jBbBxdJ7AYE3tRO91zjd+t5xSYa4M3ddvvg</span></span>
<span><span class="co">#&gt; dX318tAmZBAgvpdOnzBXnxn7uWR3uy4N11wYMbMa1+sVGF+/njSiH5bCnGIhsFbx</span></span>
<span><span class="co">#&gt; EVdhdsp+DPF8Pe8qnphSbGxDhdneqM91yrB2uzoFAqStiUAe9L1y5wpQ3YwzeL+y</span></span>
<span><span class="co">#&gt; Ea5ZoWEWvo2uayh/ufiy9qBT3Vw4VF3Uir8uW5L3zZDx2EARpZzERY74KMF3SoVl</span></span>
<span><span class="co">#&gt; gBMCAwEAAaNWMFQwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQU08pRkVxK</span></span>
<span><span class="co">#&gt; qt9Kq3gV88ndTZwjM2AwHwYDVR0jBBgwFoAU08pRkVxKqt9Kq3gV88ndTZwjM2Aw</span></span>
<span><span class="co">#&gt; DQYJKoZIhvcNAQELBQADggIBAA/ILAiOP0ncsQP2h8WGohDxjB1jH5D8xyk3dyQi</span></span>
<span><span class="co">#&gt; dqsyDtRGbX//6EtHsuYPH4DX12iVyhCe8Ho62m7yvYVm0GeHzC4uqwqDZBFqYc/H</span></span>
<span><span class="co">#&gt; V8hhaU+p39HbK8QU+GxkYfaGCcnMHSyNxEiC+lRDiKfc7QyC+Ui0xn3weqEcPcY4</span></span>
<span><span class="co">#&gt; P2Ej92r4/tvFYttU7+JJb2Fj8yiO8z/YVJKr0PXp//Prc/3hSGRd7DAhYisjHkJI</span></span>
<span><span class="co">#&gt; TzXhJGF+12uut2nQ+RqVjGtbuibhPQfklLvyZjOxrFtZW31wj/vAZ9IJLq01mFak</span></span>
<span><span class="co">#&gt; u8TA+BpNux7auoPw1Nce2Uuw5ybpU86Vs3n6jYFWhUzeLqLcGtVr29gcyYJitWjf</span></span>
<span><span class="co">#&gt; W23eBzN6zoMPVUJss/K7vPPQc9jY7zUtslOgjqJ0GY704XGBLXJJPVfryPwMXTIE</span></span>
<span><span class="co">#&gt; iI/3MI8mNcFTV+1P+YJSlBqqpv9BO9Log4vPehCaFdpqJfPqppZYX+rApUBotC9V</span></span>
<span><span class="co">#&gt; asizsjNgQ3YSNu0PhQCgmdl8a7rlr3dhf7z6yRzQkZ0WUW7ey7xQZ4wokEl7XnBO</span></span>
<span><span class="co">#&gt; WI0x8GryXEGB9n6tnY3vgji5xMUJB0BWMe66RxFhM4NkeilfXOxMGihxC8Pbo/6H</span></span>
<span><span class="co">#&gt; WHcedqb4nTbn/coz79gD45dhtiAZGz/LLlojQlAcE6hvMoHR/oZV1NyVU2VthjSK</span></span>
<span><span class="co">#&gt; 3QMt</span></span>
<span><span class="co">#&gt; -----END CERTIFICATE-----</span></span>
<span><span class="co">#&gt; ",""))'</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/daemons.html">daemons</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ca-signed-certificates">CA Signed Certificates<a class="anchor" aria-label="anchor" href="#ca-signed-certificates"></a>
</h4>
<p>As an alternative to the zero-configuration default, a certificate
may also be generated via a Certificate Signing Request (CSR) to a
Certificate Authority (CA). The CA may be a public CA or internal to an
organisation.</p>
<ol style="list-style-type: decimal">
<li>Generate a private key and CSR. The following resources describe how
to do so:</li>
</ol>
<ul>
<li>using Mbed TLS: <a href="https://mbed-tls.readthedocs.io/en/latest/kb/how-to/generate-a-certificate-request-csr/" class="external-link uri">https://mbed-tls.readthedocs.io/en/latest/kb/how-to/generate-a-certificate-request-csr/</a>
</li>
<li>using OpenSSL: <a href="https://www.feistyduck.com/library/openssl-cookbook/online/" class="external-link uri">https://www.feistyduck.com/library/openssl-cookbook/online/</a>
(Chapter 1.2 Key and Certificate Management)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Provide the generated CSR to the CA for it to sign a new TLS
certificate.</li>
</ol>
<ul>
<li>The common name (CN) of the certificate must be identical to the
hostname or IP address actually used for the connection. As this is
verified, it will fail if not the same.</li>
<li>The received certificate should comprise a block of cipher text
between the markers <code>-----BEGIN CERTIFICATE-----</code> and
<code>-----END CERTIFICATE-----</code>. Make sure to request the
certificate in the PEM format. If only available in other formats, the
TLS library used should usually provide conversion utilities.</li>
<li>Check also that the private key is a block of cipher text between
the markers <code>-----BEGIN PRIVATE KEY-----</code> and
<code>-----END PRIVATE KEY-----</code>.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>When setting daemons, the TLS certificate and private key should be
provided to the ‘tls’ argument of <code><a href="../reference/daemons.html">daemons()</a></code>.</li>
</ol>
<ul>
<li>If the certificate and private key have been imported as character
strings <code>cert</code> and <code>key</code> respectively, then the
‘tls’ argument may be specified as the character vector
<code>c(cert, key)</code>.</li>
<li>Alternatively, the certificate may be copied to a new text file,
with the private key appended, in which case the path/filename of this
file may be provided to the ‘tls’ argument.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>When launching daemons, the certificate chain to the CA should be
supplied to the ‘tls’ argument of <code><a href="../reference/daemon.html">daemon()</a></code> or
<code><a href="../reference/launch_local.html">launch_remote()</a></code>.</li>
</ol>
<ul>
<li>The certificate chain should comprise multiple certificates, each
between <code>-----BEGIN CERTIFICATE-----</code> and
<code>-----END CERTIFICATE-----</code> markers. The first one should be
the newly-generated TLS certificate, the same supplied to
<code><a href="../reference/daemons.html">daemons()</a></code>, and the final one should be a CA root
certificate.</li>
<li>These are the only certificates required if the certificate was
signed directly by a CA. If not, then the intermediate certificates
should be included in a certificate chain that starts with the TLS
certificate and ends with the certificate of the CA.</li>
<li>If these are concatenated together as a single character string
<code>certchain</code>, then the character vector comprising this and an
empty character string <code>c(certchain, "")</code> may be supplied to
the relevant ‘tls’ argument.</li>
<li>Alternatively, if these are written to a file (and the file
replicated on the remote machines), then the ‘tls’ argument may also be
specified as a path/filename (assuming these are the same on each
machine).</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="compute-profiles">8. Compute Profiles<a class="anchor" aria-label="anchor" href="#compute-profiles"></a>
</h3>
<p><code><a href="../reference/daemons.html">daemons()</a></code> has a <code>.compute</code> argument to
specify separate sets of daemons (<em>compute profiles</em>) that
operate totally independently. This is useful for managing tasks with
heterogeneous compute requirements:</p>
<ul>
<li>send tasks to different daemons or clusters of daemons with the
appropriate specifications (in terms of CPUs / memory / GPU /
accelerators etc.)</li>
<li>split tasks between local and remote computation</li>
</ul>
<p>Simply pass a character string to <code>.compute</code> to use as the
profile name (which, if <code>NULL</code>, is ‘default’). The daemons
settings are saved under the named profile.</p>
<p>To create a ‘mirai’ task using a specific compute profile, specify
the <code>.compute</code> argument to <code><a href="../reference/mirai.html">mirai()</a></code>, which uses
the ‘default’ compute profile if this is <code>NULL</code>.</p>
<p>Similarly, functions such as <code><a href="../reference/status.html">status()</a></code>,
<code><a href="../reference/launch_local.html">launch_local()</a></code> or <code><a href="../reference/launch_local.html">launch_remote()</a></code> should be
specified with the desired <code>.compute</code> argument.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Charlie Gao, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
