<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Daemon Instance — daemon • mirai</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Daemon Instance — daemon"><meta name="description" content="Starts up an execution daemon to receive mirai() requests. Awaits data,
evaluates an expression in an environment containing the supplied data,
and returns the value to the host caller. Daemon settings may be controlled
by daemons() and this function should not need to be invoked directly,
unless deploying manually on remote resources."><meta property="og:description" content="Starts up an execution daemon to receive mirai() requests. Awaits data,
evaluates an expression in an environment containing the supplied data,
and returns the value to the host caller. Daemon settings may be controlled
by daemons() and this function should not need to be invoked directly,
unless deploying manually on remote resources."><meta property="og:image" content="https://mirai.r-lib.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="mirai.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirai</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.3.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mirai.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v1-daemons.html">1. Daemons</a></li>
    <li><a class="dropdown-item" href="../articles/v2-map.html">2. Async Parallel Map</a></li>
    <li><a class="dropdown-item" href="../articles/v3-promises.html">3. Promises - Shiny and Plumber</a></li>
    <li><a class="dropdown-item" href="../articles/v4-serialization.html">4. Serialization - Arrow, ADBC, polars, torch</a></li>
    <li><a class="dropdown-item" href="../articles/v5-parallel.html">5. Mirai Clusters - Base R</a></li>
    <li><a class="dropdown-item" href="../articles/v6-packages.html">6. Guidance for Package Authors</a></li>
    <li><a class="dropdown-item" href="../articles/v7-community.html">7. Community FAQs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/mirai/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Daemon Instance</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/mirai/blob/main/R/daemon.R" class="external-link"><code>R/daemon.R</code></a></small>
      <div class="d-none name"><code>daemon.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Starts up an execution daemon to receive <code><a href="mirai.html">mirai()</a></code> requests. Awaits data,
evaluates an expression in an environment containing the supplied data,
and returns the value to the host caller. Daemon settings may be controlled
by <code><a href="daemons.html">daemons()</a></code> and this function should not need to be invoked directly,
unless deploying manually on remote resources.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">daemon</span><span class="op">(</span></span>
<span>  <span class="va">url</span>,</span>
<span>  dispatcher <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  asyncdial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  autoexit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cleanup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  idletime <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  walltime <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  maxtasks <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tls <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rs <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-url">url<a class="anchor" aria-label="anchor" href="#arg-url"></a></dt>
<dd><p>the character host or dispatcher URL to dial into, including the
port to connect to, e.g. 'tcp://hostname:5555' or
'tls+tcp://10.75.32.70:5555'.</p></dd>


<dt id="arg-dispatcher">dispatcher<a class="anchor" aria-label="anchor" href="#arg-dispatcher"></a></dt>
<dd><p>[default TRUE] logical value, which should be set to
TRUE if using dispatcher and FALSE otherwise.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>reserved but not currently used.</p></dd>


<dt id="arg-asyncdial">asyncdial<a class="anchor" aria-label="anchor" href="#arg-asyncdial"></a></dt>
<dd><p>[default FALSE] whether to perform dials asynchronously.
The default FALSE will error if a connection is not immediately possible
(for instance if <code><a href="daemons.html">daemons()</a></code> has yet to be called on the host, or the
specified port is not open etc.). Specifying TRUE continues retrying
(indefinitely) if not immediately successful, which is more resilient but
can mask potential connection issues.</p></dd>


<dt id="arg-autoexit">autoexit<a class="anchor" aria-label="anchor" href="#arg-autoexit"></a></dt>
<dd><p>[default TRUE] logical value, whether the daemon should
exit automatically when its socket connection ends. If a signal from the
<span class="pkg">tools</span> package, such as <code><a href="https://rdrr.io/r/tools/pskill.html" class="external-link">tools::SIGINT</a></code>, or an equivalent integer
value is supplied, this signal is additionally raised on exit (see
'Persistence' section below).</p></dd>


<dt id="arg-cleanup">cleanup<a class="anchor" aria-label="anchor" href="#arg-cleanup"></a></dt>
<dd><p>[default TRUE] logical value, whether to perform cleanup of
the global environment and restore attached packages and options to an
initial state after each evaluation.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>[default FALSE] logical value, to output generated stdout /
stderr if TRUE, or else discard if FALSE. Specify as TRUE in the <code>...</code>
argument to <code><a href="daemons.html">daemons()</a></code> or <code><a href="launch_local.html">launch_local()</a></code> to provide redirection of
output to the host process (applicable only for local daemons).</p></dd>


<dt id="arg-idletime">idletime<a class="anchor" aria-label="anchor" href="#arg-idletime"></a></dt>
<dd><p>[default Inf] integer milliseconds maximum time to wait for
a task (idle time) before exiting.</p></dd>


<dt id="arg-walltime">walltime<a class="anchor" aria-label="anchor" href="#arg-walltime"></a></dt>
<dd><p>[default Inf] integer milliseconds soft walltime (time
limit) i.e. the minimum amount of real time elapsed before exiting.</p></dd>


<dt id="arg-maxtasks">maxtasks<a class="anchor" aria-label="anchor" href="#arg-maxtasks"></a></dt>
<dd><p>[default Inf] integer maximum number of tasks to execute
(task limit) before exiting.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>[default NULL] (optional) integer daemon ID provided to
dispatcher to track connection status. Causes <code><a href="status.html">status()</a></code> to report this ID
under <code>$events</code> when the daemon connects and disconnects.</p></dd>


<dt id="arg-tls">tls<a class="anchor" aria-label="anchor" href="#arg-tls"></a></dt>
<dd><p>[default NULL] required for secure TLS connections over
'tls+tcp://'. <strong>Either</strong> the character path to a file containing X.509
certificate(s) in PEM format, comprising the certificate authority
certificate chain starting with the TLS certificate and ending with the CA
certificate, <strong>or</strong> a length 2 character vector comprising [i] the
certificate authority certificate chain and [ii] the empty string <code>""</code>.</p></dd>


<dt id="arg-rs">rs<a class="anchor" aria-label="anchor" href="#arg-rs"></a></dt>
<dd><p>[default NULL] the initial value of .Random.seed. This is set
automatically using L'Ecuyer-CMRG RNG streams generated by the host process
if applicable, and should not be independently supplied.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly, an integer exit code: 0L for normal termination, and a
positive value if a self-imposed limit was reached: 1L (idletime), 2L
(walltime), 3L (maxtasks).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The network topology is such that daemons dial into the host or dispatcher,
which listens at the <code>url</code> address. In this way, network resources may be
added or removed dynamically and the host or dispatcher automatically
distributes tasks to all available daemons.</p>
    </div>
    <div class="section level2">
    <h2 id="persistence">Persistence<a class="anchor" aria-label="anchor" href="#persistence"></a></h2>



<p>The <code>autoexit</code> argument governs persistence settings for the daemon. The
default TRUE ensures that it will exit cleanly once its socket connection
has ended.</p>
<p>Instead of TRUE, supplying a signal from the <span class="pkg">tools</span> package, such as
<code><a href="https://rdrr.io/r/tools/pskill.html" class="external-link">tools::SIGINT</a></code>, or an equivalent integer value, sets this signal to be
raised when the socket connection ends. For instance, supplying SIGINT allows
a potentially more immediate exit by interrupting any ongoing evaluation
rather than letting it complete.</p>
<p>Setting to FALSE allows the daemon to persist indefinitely even when there is
no longer a socket connection. This allows a host session to end and a new
session to connect at the URL where the daemon is dialled in. Daemons must be
terminated with <code>daemons(NULL)</code> in this case, which sends explicit exit
signals to all connected daemons.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Charlie Gao, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

